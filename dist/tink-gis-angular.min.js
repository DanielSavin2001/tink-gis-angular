/*! tink-gis-angular v1.0.0 */
"use strict";function str_md4(s){return binl2str(core_md4(str2binl(s),s.length*chrsz))}function core_md4(x,len){x[len>>5]|=128<<len%32,x[(len+64>>>9<<4)+14]=len;for(var a=1732584193,b=-271733879,c=-1732584194,d=271733878,i=0;i<x.length;i+=16){var olda=a,oldb=b,oldc=c,oldd=d;a=md4_ff(a,b,c,d,x[i+0],3),d=md4_ff(d,a,b,c,x[i+1],7),c=md4_ff(c,d,a,b,x[i+2],11),b=md4_ff(b,c,d,a,x[i+3],19),a=md4_ff(a,b,c,d,x[i+4],3),d=md4_ff(d,a,b,c,x[i+5],7),c=md4_ff(c,d,a,b,x[i+6],11),b=md4_ff(b,c,d,a,x[i+7],19),a=md4_ff(a,b,c,d,x[i+8],3),d=md4_ff(d,a,b,c,x[i+9],7),c=md4_ff(c,d,a,b,x[i+10],11),b=md4_ff(b,c,d,a,x[i+11],19),a=md4_ff(a,b,c,d,x[i+12],3),d=md4_ff(d,a,b,c,x[i+13],7),c=md4_ff(c,d,a,b,x[i+14],11),b=md4_ff(b,c,d,a,x[i+15],19),a=md4_gg(a,b,c,d,x[i+0],3),d=md4_gg(d,a,b,c,x[i+4],5),c=md4_gg(c,d,a,b,x[i+8],9),b=md4_gg(b,c,d,a,x[i+12],13),a=md4_gg(a,b,c,d,x[i+1],3),d=md4_gg(d,a,b,c,x[i+5],5),c=md4_gg(c,d,a,b,x[i+9],9),b=md4_gg(b,c,d,a,x[i+13],13),a=md4_gg(a,b,c,d,x[i+2],3),d=md4_gg(d,a,b,c,x[i+6],5),c=md4_gg(c,d,a,b,x[i+10],9),b=md4_gg(b,c,d,a,x[i+14],13),a=md4_gg(a,b,c,d,x[i+3],3),d=md4_gg(d,a,b,c,x[i+7],5),c=md4_gg(c,d,a,b,x[i+11],9),b=md4_gg(b,c,d,a,x[i+15],13),a=md4_hh(a,b,c,d,x[i+0],3),d=md4_hh(d,a,b,c,x[i+8],9),c=md4_hh(c,d,a,b,x[i+4],11),b=md4_hh(b,c,d,a,x[i+12],15),a=md4_hh(a,b,c,d,x[i+2],3),d=md4_hh(d,a,b,c,x[i+10],9),c=md4_hh(c,d,a,b,x[i+6],11),b=md4_hh(b,c,d,a,x[i+14],15),a=md4_hh(a,b,c,d,x[i+1],3),d=md4_hh(d,a,b,c,x[i+9],9),c=md4_hh(c,d,a,b,x[i+5],11),b=md4_hh(b,c,d,a,x[i+13],15),a=md4_hh(a,b,c,d,x[i+3],3),d=md4_hh(d,a,b,c,x[i+11],9),c=md4_hh(c,d,a,b,x[i+7],11),b=md4_hh(b,c,d,a,x[i+15],15),a=safe_add(a,olda),b=safe_add(b,oldb),c=safe_add(c,oldc),d=safe_add(d,oldd)}return Array(a,b,c,d)}function md4_cmn(q,a,b,x,s,t){return safe_add(rol(safe_add(safe_add(a,q),safe_add(x,t)),s),b)}function md4_ff(a,b,c,d,x,s){return md4_cmn(b&c|~b&d,a,0,x,s,0)}function md4_gg(a,b,c,d,x,s){return md4_cmn(b&c|b&d|c&d,a,0,x,s,1518500249)}function md4_hh(a,b,c,d,x,s){return md4_cmn(b^c^d,a,0,x,s,1859775393)}function safe_add(x,y){var lsw=(65535&x)+(65535&y),msw=(x>>16)+(y>>16)+(lsw>>16);return msw<<16|65535&lsw}function rol(num,cnt){return num<<cnt|num>>>32-cnt}function str2binl(str){for(var bin=Array(),mask=(1<<chrsz)-1,i=0;i<str.length*chrsz;i+=chrsz)bin[i>>5]|=(str.charCodeAt(i/chrsz)&mask)<<i%32;return bin}function binl2str(bin){for(var str="",mask=(1<<chrsz)-1,i=0;i<32*bin.length;i+=chrsz)str+=String.fromCharCode(bin[i>>5]>>>i%32&mask);return str}function des(key,message,encrypt,mode,iv,padding){var i,j,temp,right1,right2,left,right,looping,cbcleft,cbcleft2,cbcright,cbcright2,endloop,loopinc,spfunction1=new Array(16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756),spfunction2=new Array((-2146402272),(-2147450880),32768,1081376,1048576,32,(-2146435040),(-2147450848),(-2147483616),(-2146402272),(-2146402304),(-2147483648),(-2147450880),1048576,32,(-2146435040),1081344,1048608,(-2147450848),0,(-2147483648),32768,1081376,(-2146435072),1048608,(-2147483616),0,1081344,32800,(-2146402304),(-2146435072),32800,0,1081376,(-2146435040),1048576,(-2147450848),(-2146435072),(-2146402304),32768,(-2146435072),(-2147450880),32,(-2146402272),1081376,32,32768,(-2147483648),32800,(-2146402304),1048576,(-2147483616),1048608,(-2147450848),(-2147483616),1048608,1081344,0,(-2147450880),32800,(-2147483648),(-2146435040),(-2146402272),1081344),spfunction3=new Array(520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584),spfunction4=new Array(8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928),spfunction5=new Array(256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080),spfunction6=new Array(536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312),spfunction7=new Array(2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154),spfunction8=new Array(268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696),keys=des_createKeys(key),m=0,len=message.length,chunk=0,iterations=32==keys.length?3:9;for(looping=3==iterations?encrypt?new Array(0,32,2):new Array(30,(-2),(-2)):encrypt?new Array(0,32,2,62,30,(-2),64,96,2):new Array(94,62,(-2),32,64,2,30,(-2),(-2)),2==padding?message+="        ":1==padding?(temp=8-len%8,message+=String.fromCharCode(temp,temp,temp,temp,temp,temp,temp,temp),8==temp&&(len+=8)):padding||(message+="\0\0\0\0\0\0\0\0"),result="",tempresult="",1==mode&&(cbcleft=iv.charCodeAt(m++)<<24|iv.charCodeAt(m++)<<16|iv.charCodeAt(m++)<<8|iv.charCodeAt(m++),cbcright=iv.charCodeAt(m++)<<24|iv.charCodeAt(m++)<<16|iv.charCodeAt(m++)<<8|iv.charCodeAt(m++),m=0);m<len;){for(left=message.charCodeAt(m++)<<24|message.charCodeAt(m++)<<16|message.charCodeAt(m++)<<8|message.charCodeAt(m++),right=message.charCodeAt(m++)<<24|message.charCodeAt(m++)<<16|message.charCodeAt(m++)<<8|message.charCodeAt(m++),1==mode&&(encrypt?(left^=cbcleft,right^=cbcright):(cbcleft2=cbcleft,cbcright2=cbcright,cbcleft=left,cbcright=right)),temp=252645135&(left>>>4^right),right^=temp,left^=temp<<4,temp=65535&(left>>>16^right),right^=temp,left^=temp<<16,temp=858993459&(right>>>2^left),left^=temp,right^=temp<<2,temp=16711935&(right>>>8^left),left^=temp,right^=temp<<8,temp=1431655765&(left>>>1^right),right^=temp,left^=temp<<1,left=left<<1|left>>>31,right=right<<1|right>>>31,j=0;j<iterations;j+=3){for(endloop=looping[j+1],loopinc=looping[j+2],i=looping[j];i!=endloop;i+=loopinc)right1=right^keys[i],right2=(right>>>4|right<<28)^keys[i+1],temp=left,left=right,right=temp^(spfunction2[right1>>>24&63]|spfunction4[right1>>>16&63]|spfunction6[right1>>>8&63]|spfunction8[63&right1]|spfunction1[right2>>>24&63]|spfunction3[right2>>>16&63]|spfunction5[right2>>>8&63]|spfunction7[63&right2]);temp=left,left=right,right=temp}left=left>>>1|left<<31,right=right>>>1|right<<31,temp=1431655765&(left>>>1^right),right^=temp,left^=temp<<1,temp=16711935&(right>>>8^left),left^=temp,right^=temp<<8,temp=858993459&(right>>>2^left),left^=temp,right^=temp<<2,temp=65535&(left>>>16^right),right^=temp,left^=temp<<16,temp=252645135&(left>>>4^right),right^=temp,left^=temp<<4,1==mode&&(encrypt?(cbcleft=left,cbcright=right):(left^=cbcleft2,right^=cbcright2)),tempresult+=String.fromCharCode(left>>>24,left>>>16&255,left>>>8&255,255&left,right>>>24,right>>>16&255,right>>>8&255,255&right),chunk+=8,512==chunk&&(result+=tempresult,tempresult="",chunk=0)}return result+tempresult}function des_createKeys(key){pc2bytes0=new Array(0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964),pc2bytes1=new Array(0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697),pc2bytes2=new Array(0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272),pc2bytes3=new Array(0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144),pc2bytes4=new Array(0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256),pc2bytes5=new Array(0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488),pc2bytes6=new Array(0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746),pc2bytes7=new Array(0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568),pc2bytes8=new Array(0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578),pc2bytes9=new Array(0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488),pc2bytes10=new Array(0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800),pc2bytes11=new Array(0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744),pc2bytes12=new Array(0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128),pc2bytes13=new Array(0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261);for(var lefttemp,righttemp,temp,iterations=key.length>8?3:1,keys=new Array(32*iterations),shifts=new Array(0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0),m=0,n=0,j=0;j<iterations;j++){left=key.charCodeAt(m++)<<24|key.charCodeAt(m++)<<16|key.charCodeAt(m++)<<8|key.charCodeAt(m++),right=key.charCodeAt(m++)<<24|key.charCodeAt(m++)<<16|key.charCodeAt(m++)<<8|key.charCodeAt(m++),temp=252645135&(left>>>4^right),right^=temp,left^=temp<<4,temp=65535&(right>>>-16^left),left^=temp,right^=temp<<-16,temp=858993459&(left>>>2^right),right^=temp,left^=temp<<2,temp=65535&(right>>>-16^left),left^=temp,right^=temp<<-16,temp=1431655765&(left>>>1^right),right^=temp,left^=temp<<1,temp=16711935&(right>>>8^left),left^=temp,right^=temp<<8,temp=1431655765&(left>>>1^right),right^=temp,left^=temp<<1,temp=left<<8|right>>>20&240,left=right<<24|right<<8&16711680|right>>>8&65280|right>>>24&240,right=temp;for(var i=0;i<shifts.length;i++)shifts[i]?(left=left<<2|left>>>26,right=right<<2|right>>>26):(left=left<<1|left>>>27,right=right<<1|right>>>27),left&=-15,right&=-15,lefttemp=pc2bytes0[left>>>28]|pc2bytes1[left>>>24&15]|pc2bytes2[left>>>20&15]|pc2bytes3[left>>>16&15]|pc2bytes4[left>>>12&15]|pc2bytes5[left>>>8&15]|pc2bytes6[left>>>4&15],righttemp=pc2bytes7[right>>>28]|pc2bytes8[right>>>24&15]|pc2bytes9[right>>>20&15]|pc2bytes10[right>>>16&15]|pc2bytes11[right>>>12&15]|pc2bytes12[right>>>8&15]|pc2bytes13[right>>>4&15],temp=65535&(righttemp>>>16^lefttemp),keys[n++]=lefttemp^temp,keys[n++]=righttemp^temp<<16}return keys}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}!function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.navigation","tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter","tink.pagination","tink.tooltip","ngAnimate","rzModule"])}JXON.config({attrPrefix:"",autoDate:!1});var mapObject=(function(){L.AwesomeMarkers.Icon.prototype.options.prefix="fa"}(),function(){var crsLambert=new L.Proj.CRS("EPSG:31370","+proj=lcc +lat_1=51.16666723333334 +lat_2=49.83333389999999 +lat_0=90 +lon_0=4.367486666666666 +x_0=150000.013 +y_0=5400088.438 +ellps=intl +towgs84=-99.1,53.3,-112.5,0.419,-0.83,1.885,-1.0 +units=m +no_defs",{origin:[-35872700,41422700],resolutions:[66.1459656252646,52.91677250021167,39.687579375158755,26.458386250105836,13.229193125052918,6.614596562526459,5.291677250021167,3.9687579375158752,3.3072982812632294,2.6458386250105836,1.9843789687579376,1.3229193125052918,.6614596562526459,.5291677250021167,.39687579375158755,.33072982812632296,.26458386250105836,.19843789687579377,.13229193125052918,.06614596562526459,.026458386250105836]}),map=L.map("map",{minZoom:0,maxZoom:20,crs:crsLambert,zoomControl:!1,drawControl:!1,attributionControl:!1}).setView([51.2192159,4.4028818],5);return L.control.scale({imperial:!1}).addTo(map),map.doubleClickZoom.disable(),map.featureGroup=L.featureGroup().addTo(map),map.extendFeatureGroup=L.featureGroup().addTo(map),map.on("draw:created",function(event){}),map.on("draw:drawstart",function(event){console.log("draw started")}),map.addToDrawings=function(layer){map.featureGroup.addLayer(layer)},map.clearDrawings=function(){map.featureGroup.clearLayers(),map.extendFeatureGroup.clearLayers()},map});module.factory("map",mapObject),module.directive("preventDefaultMap",function(map){return{link:function(scope,element,attrs){L.DomEvent.disableClickPropagation(element.get(0)),element.on("dblclick",function(event){event.stopPropagation()}),element.on("mousemove",function(event){event.stopPropagation()})}}}),module.directive("preventDefault",function(map){return{link:function(scope,element,attrs){element.on("click",function(event){event.preventDefault(),event.stopPropagation()}),element.on("dblclick",function(event){event.stopPropagation()}),element.on("mousemove",function(event){event.stopPropagation()})}}}),module.directive("autoFocus",function($timeout){return{restrict:"AC",link:function(_scope,_element){$timeout(function(){_element[0].focus()},0)}}});var origOpen=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(method,url){url.toLowerCase().includes("p_sik")&&(this.withCredentials=!0),origOpen.apply(this,arguments)}}();var Msg=function(data){this.data=[],data&&(0==data.indexOf("NTLM ")&&(data=data.substr(5)),atob(data).split("").map(function(c){this.push(c.charCodeAt(0))},this.data))};Msg.prototype.addByte=function(b){this.data.push(b)},Msg.prototype.addShort=function(s){this.data.push(255&s),this.data.push(s>>8&255)},Msg.prototype.addString=function(str,utf16){utf16&&(str=str.split("").map(function(c){return c+"\0"}).join(""));for(var i=0;i<str.length;i++)this.data.push(str.charCodeAt(i))},Msg.prototype.getString=function(offset,length){for(var result="",i=0;i<length;i++){if(offset+i>=this.data.length)return"";result+=String.fromCharCode(this.data[offset+i])}return result},Msg.prototype.getByte=function(offset){return this.data[offset]},Msg.prototype.toBase64=function(){var str=String.fromCharCode.apply(null,this.data);return btoa(str).replace(/.{76}(?=.)/g,"$&")};var Ntlm={};Ntlm.domain=null,Ntlm.username=null,Ntlm.lmHashedPassword=null,Ntlm.ntHashedPassword=null,Ntlm.error=function(msg){console.error(msg)},Ntlm.message=function(msg){console.log(msg)},Ntlm.createMessage1=function(hostname){var msg1=new Msg;return msg1.addString("NTLMSSP\0"),msg1.addByte(1),msg1.addString("\0\0\0"),msg1.addShort(45571),msg1.addString("\0\0"),msg1.addShort(Ntlm.domain.length),msg1.addShort(Ntlm.domain.length),msg1.addShort(32+hostname.length),msg1.addString("\0\0"),msg1.addShort(hostname.length),msg1.addShort(hostname.length),msg1.addShort(32),msg1.addString("\0\0"),msg1.addString(hostname.toUpperCase()),msg1.addString(Ntlm.domain.toUpperCase()),msg1},Ntlm.getChallenge=function(data){var msg2=new Msg(data);if("NTLMSSP\0"!=msg2.getString(0,8))return Ntlm.error("Invalid NTLM response header."),"";if(2!=msg2.getByte(8))return Ntlm.error("Invalid NTLM response type."),"";var challenge=msg2.getString(24,8);return challenge},Ntlm.createMessage3=function(challenge,hostname){var lmResponse=Ntlm.buildResponse(Ntlm.lmHashedPassword,challenge),ntResponse=Ntlm.buildResponse(Ntlm.ntHashedPassword,challenge),username=Ntlm.username,domain=Ntlm.domain,msg3=new Msg;return msg3.addString("NTLMSSP\0"),msg3.addByte(3),msg3.addString("\0\0\0"),msg3.addShort(24),msg3.addShort(24),msg3.addShort(64+2*(domain.length+username.length+hostname.length)),msg3.addString("\0\0"),msg3.addShort(24),msg3.addShort(24),msg3.addShort(88+2*(domain.length+username.length+hostname.length)),msg3.addString("\0\0"),msg3.addShort(2*domain.length),msg3.addShort(2*domain.length),msg3.addShort(64),msg3.addString("\0\0"),msg3.addShort(2*username.length),msg3.addShort(2*username.length),msg3.addShort(64+2*domain.length),msg3.addShort("\0\0"),msg3.addShort(2*hostname.length),msg3.addShort(2*hostname.length),msg3.addShort(64+2*(domain.length+username.length)),msg3.addString("\0\0"),msg3.addString("\0\0\0\0"),msg3.addShort(112+2*(domain.length+username.length+hostname.length)),msg3.addString("\0\0"),msg3.addShort(33281),msg3.addString("\0\0"),msg3.addString(domain.toUpperCase(),!0),msg3.addString(username,!0),msg3.addString(hostname.toUpperCase(),!0),msg3.addString(lmResponse),msg3.addString(ntResponse),msg3},Ntlm.createKey=function(str){for(var key56=[];str.length<7;)str+="\0";str=str.substr(0,7),str.split("").map(function(c){this.push(c.charCodeAt(0))},key56);var key=[0,0,0,0,0,0,0,0];key[0]=key56[0],key[1]=key56[0]<<7&255|key56[1]>>1,key[2]=key56[1]<<6&255|key56[2]>>2,key[3]=key56[2]<<5&255|key56[3]>>3,key[4]=key56[3]<<4&255|key56[4]>>4,key[5]=key56[4]<<3&255|key56[5]>>5,key[6]=key56[5]<<2&255|key56[6]>>6,key[7]=key56[6]<<1&255;for(var i=0;i<key.length;i++){for(var bit=0,k=0;k<7;k++)t=key[i]>>k,bit=1&(t^bit);key[i]=254&key[i]|bit}var result="";return key.map(function(i){result+=String.fromCharCode(i)}),result},Ntlm.buildResponse=function(key,text){for(;key.length<21;)key+="\0";var key1=Ntlm.createKey(key.substr(0,7)),key2=Ntlm.createKey(key.substr(7,7)),key3=Ntlm.createKey(key.substr(14,7));return des(key1,text,1,0)+des(key2,text,1,0)+des(key3,text,1,0)},Ntlm.getLocation=function(url){var l=document.createElement("a");return l.href=url,l},Ntlm.setCredentials=function(domain,username,password){for(var magic="KGS!@#$%",lmPassword=password.toUpperCase().substr(0,14);lmPassword.length<14;)lmPassword+="\0";for(var key1=Ntlm.createKey(lmPassword),key2=Ntlm.createKey(lmPassword.substr(7)),lmHashedPassword=des(key1,magic,1,0)+des(key2,magic,1,0),ntPassword="",i=0;i<password.length;i++)ntPassword+=password.charAt(i)+"\0";var ntHashedPassword=str_md4(ntPassword);Ntlm.domain=domain,Ntlm.username=username,Ntlm.lmHashedPassword=lmHashedPassword,Ntlm.ntHashedPassword=ntHashedPassword},Ntlm.isChallenge=function(xhr){if(!xhr)return!1;if(401!=xhr.status)return!1;var header=xhr.getResponseHeader("WWW-Authenticate");return header&&header.indexOf("NTLM")!=-1},Ntlm.authenticate=function(url){if(!(Ntlm.domain&&Ntlm.username&&Ntlm.lmHashedPassword&&Ntlm.ntHashedPassword))return Ntlm.error("No NTLM credentials specified. Use Ntlm.setCredentials(...) before making calls."),!1;var hostname=Ntlm.getLocation(url).hostname,msg1=Ntlm.createMessage1(hostname),request=new XMLHttpRequest;request.open("GET",url,!1),request.setRequestHeader("Authorization","NTLM "+msg1.toBase64()),request.send(null);var response=request.getResponseHeader("WWW-Authenticate"),challenge=Ntlm.getChallenge(response),msg3=Ntlm.createMessage3(challenge,hostname);return request.open("GET",url,!1),request.setRequestHeader("Authorization","NTLM "+msg3.toBase64()),request.send(null),200==request.status};var chrsz=8,ThemeStatus={UNMODIFIED:0,NEW:1,UPDATED:2,DELETED:3},LayerType={LAYER:0,GROUP:1},ActiveInteractieButton={GEEN:"geen",IDENTIFY:"identify",SELECT:"select",METEN:"meten",WATISHIER:"watishier"},Gis={Arcgissql:"",BaseUrl:"https://geoint.antwerpen.be/",PublicBaseUrl:"https://geodata.antwerpen.be/",LocatieUrl:"https://geoint-a.antwerpen.be/arcgissql/rest/services/A_DA/Locaties/MapServer",GeometryUrl:"https://geoint.antwerpen.be/arcgissql/rest/services/Utilities/Geometry/GeometryServer/buffer"};Gis.Arcgissql=Gis.BaseUrl+"arcgissql/rest/";var Solr={BaseUrl:"https://esb-app1-o.antwerpen.be/v1/"},DrawingOption={GEEN:"geen",NIETS:"",AFSTAND:"afstand",OPPERVLAKTE:"oppervlakte",LIJN:"lijn",VIERKANT:"vierkant",POLYGON:"polygon"},Global={Mobile:!1},ThemeType={ESRI:"esri",WMS:"wms"},Style={DEFAULT:{fillOpacity:0,color:"blue",weight:4},ADD:{fillOpacity:0,color:"green",weight:5},REMOVE:{fillOpacity:0,color:"red",weight:5},HIGHLIGHT:{weight:7,color:"red",fillOpacity:.5},COREBUFFER:{weight:7,color:"lightgreen",fillOpacity:.5},BUFFER:{fillColor:"#00cc00",color:"#00cc00",weight:1,opacity:.9,fillOpacity:.3}},Scales=[25e4,2e5,15e4,1e5,5e4,25e3,2e4,15e3,12500,1e4,7500,5e3,2500,2e3,1500,1250,1e3,750,500,250,100];!function(module){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tinµk.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("geoPuntController",["$scope","ThemeCreater","$q","MapService","MapData","GISService","LayerManagementService","WMSService","$window","$http","GeopuntService","PopupService",function($scope,ThemeCreater,$q,MapService,MapData,GISService,LayerManagementService,WMSService,$window,$http,GeopuntService,PopupService){$scope.loading=!1,$scope.themeloading=!1,$scope.currentPage=1,$scope.pagingCount=null,$scope.numberofrecordsmatched=0,LayerManagementService.EnabledThemes.length=0,LayerManagementService.AvailableThemes.length=0,LayerManagementService.EnabledThemes=angular.copy(MapData.Themes),$scope.availableThemes=[];(function(){$scope.searchTerm=""})();L.Browser.mobile||$scope.$on("searchChanged",function(event,searchTerm){$scope.searchTerm=searchTerm,$scope.searchTerm.length>2?($scope.clearPreview(),$scope.searchIsUrl=!1,$scope.$parent.geopuntLoading=!0,$scope.QueryGeoPunt($scope.searchTerm,1)):($scope.availableThemes.length=0,$scope.numberofrecordsmatched=0,$scope.$parent.geopuntCount=null,$scope.loading=!1,$scope.$parent.geopuntLoading=!1)}),$scope.QueryGeoPunt=function(searchTerm,page){$scope.loading=!0,$scope.clearPreview();var prom=GeopuntService.getMetaData(searchTerm,5*(page-1)+1,5);prom.then(function(metadata){0==$scope.currentPage&&($scope.currentPage=1),$scope.loading=!1,$scope.$parent.geopuntLoading=!1,$scope.availableThemes=metadata.results,$scope.currentrecord=metadata.currentrecord,$scope.nextrecord=metadata.nextrecord,$scope.numberofrecordsmatched=metadata.numberofrecordsmatched,$scope.$parent.geopuntCount=metadata.numberofrecordsmatched},function(reason){console.log(reason)})},$scope.pageChanged=function(page,recordsAPage){$scope.QueryGeoPunt($scope.searchTerm,page)},$scope.geopuntThemeChanged=function(theme){var questionmarkPos=theme.Url.trim().indexOf("?"),url=theme.Url.trim();questionmarkPos!=-1&&(url=theme.Url.trim().substring(0,questionmarkPos)),createWMS(url)};var createWMS=function(url){$scope.clearPreview();var wms=MapData.Themes.find(function(x){return x.cleanUrl==url});if(void 0==wms){var getwms=WMSService.GetThemeData(url);$scope.themeloading=!0,getwms.success(function(data,status,headers,config){if($scope.themeloading=!1,data){var wmstheme=ThemeCreater.createWMSThemeFromJSON(data,url);$scope.previewTheme(wmstheme)}else PopupService.Error("Fout bij het laden van de WMS","Er is een fout opgetreden bij opvragen van de wms met de url: "+url),$scope.error="Fout bij het laden van WMS."}).error(function(data,status,headers,config){$scope.error="Fout bij het laden van WMS.",$scope.themeloading=!1})}else $scope.previewTheme(wms)};$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.previewTheme=function(theme){$scope.selectedTheme=theme,$scope.copySelectedTheme=angular.copy(theme)},$scope.clearPreview=function(){$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.error=null},$scope.AddOrUpdateTheme=function(){PopupService.Success("Data is bijgewerkt.",null,null,{timeOut:1e3}),LayerManagementService.AddOrUpdateTheme($scope.selectedTheme,$scope.copySelectedTheme),$scope.clearPreview()}}])}(),function(module){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("LayerManagerController",["$scope","$modalInstance","LayerManagementService",function($scope,$modalInstance,LayerManagementService){$scope.active="solr",$scope.searchTerm="",$scope.solrLoading=!1,$scope.solrCount=null,$scope.geopuntLoading=!1,$scope.geopuntCount=null,$scope.mobile=L.Browser.mobile,$scope.ok=function(){$modalInstance.$close()},$scope.cancel=function(){$modalInstance.$dismiss("cancel is pressed")},$scope.enterPressed=function(){""==$scope.searchTerm&&$scope.$broadcast("searchChanged","*")},$scope.searchChanged=function(){null!=$scope.searchTerm&&""!=$scope.searchTerm&&$scope.$broadcast("searchChanged",$scope.searchTerm)}}])}(),function(module){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("layersManagementController",["$scope","MapData","ThemeService","LayerManagementService","PopupService",function($scope,MapData,ThemeService,LayerManagementService,PopupService){$scope.pagingCount=null,$scope.numberofrecordsmatched=0,$scope.availableThemes=MapData.Themes,$scope.allThemes=[],$scope.searchChanged=function(){},$scope.pageChanged=function(page,recordsAPage){var startItem=(page-1)*recordsAPage;$scope.availableThemes=$scope.allThemes.slice(startItem,startItem+recordsAPage)},$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.previewTheme=function(theme){console.log("themeChanged"),console.log(theme);var alreadyExistingTheme=MapData.Themes.find(function(x){return x.cleanUrl===theme.cleanUrl});alreadyExistingTheme&&(theme=alreadyExistingTheme),$scope.selectedTheme=theme,$scope.copySelectedTheme=angular.copy(theme)},$scope.clearPreview=function(){$scope.selectedTheme=null,$scope.copySelectedTheme=null},$scope.ThemeChanged=function(theme){$scope.previewTheme(theme),$scope.selected=theme,$scope.isActive=function(theme){return $scope.selected===theme}},$scope.AddOrUpdateTheme=function(){PopupService.Success("Data is bijgewerkt.",null,null,{timeOut:1e3}),LayerManagementService.AddOrUpdateTheme($scope.selectedTheme,$scope.copySelectedTheme),$scope.clearPreview()},$scope.delTheme=function(theme){$scope.selectedTheme==theme&&$scope.clearPreview(),ThemeService.DeleteTheme(theme)};(function(){$scope.searchTerm="",!$scope.selected&&$scope.availableThemes[0]&&$scope.ThemeChanged($scope.availableThemes[0])})()}])}(),function(module){var module=angular.module("tink.gis"),theController=module.controller("managementLayerController",function($scope){var vm=this;vm.layer=$scope.layer,$scope.showLayer=!1});theController.$inject=[]}(),function(module){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("previewLayerController",["$scope",function($scope){console.log($scope.theme),0!=$scope.theme.Added||$scope.theme.AllLayers.some(function(x){return x.enabled})||($scope.theme.enabled=!1),$scope.delTheme=function(){$scope.theme.AllLayers.forEach(function(lay){lay.enabled=!1}),$scope.addorupdatefunc()}}])}(),function(module){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("solrGISController",["$scope","ThemeCreater","$q","MapService","MapData","GISService","LayerManagementService","WMSService","$window","$http","GeopuntService","ThemeService","PopupService",function($scope,ThemeCreater,$q,MapService,MapData,GISService,LayerManagementService,WMSService,$window,$http,GeopuntService,ThemeService,PopupService){$scope.pagingCount=null,$scope.numberofrecordsmatched=0,LayerManagementService.AvailableThemes.length=0,$scope.availableThemes=[],$scope.allThemes=[],$scope.loading=!1,$scope.error=null;(function(){$scope.searchTerm=""})();$scope.$on("searchChanged",function(event,searchTerm){$scope.searchTerm=searchTerm,$scope.searchTerm.length>2?null!=$scope.searchTerm&&""!=$scope.searchTerm&&($scope.$parent.solrLoading=!0,$scope.QueryGISSOLR($scope.searchTerm,1)):"*"==$scope.searchTerm?($scope.searchTerm="arcgis",$scope.$parent.solrLoading=!0,$scope.QueryGISSOLR("arcgis",1)):($scope.availableThemes.length=0,$scope.numberofrecordsmatched=0,$scope.$parent.solrCount=null,$scope.loading=!1,$scope.$parent.solrLoading=!1)});$scope.QueryGISSOLR=function(searchterm,page){$scope.loading=!0;var prom=GISService.QuerySOLRGIS(searchterm,5*(page-1)+1,5);prom.then(function(data){$scope.loading=!1,$scope.$parent.solrLoading=!1,$scope.currentPage=1;var itemsMetData=(data.facet_counts.facet_fields.parent,data.grouped.parent.groups);$scope.$parent.solrCount=itemsMetData.length;var themes=[];itemsMetData.forEach(function(itemMetData){switch(itemMetData.doclist.docs[0].type){case"Feature":var afterservicespart=itemMetData.groupValue.split("/services/")[1].split("/"),url=itemMetData.groupValue.split("/").splice(0,itemMetData.groupValue.split("/").length-1).join("/")+"/Mapserver",themeName=afterservicespart[1],layerId=afterservicespart[2],layerName=itemMetData.doclist.docs[0].parentname,theme=themes.find(function(x){
return x.name==themeName});if(!theme){var theme={layers:[],layersCount:0,name:themeName,cleanUrl:url,url:url};themes.push(theme)}var layer=theme.layers.find(function(x){return x.id==layerId});layer?layer.featuresCount=itemMetData.doclist.numFound:(layer={naam:layerName,id:layerId,features:[],featuresCount:itemMetData.doclist.numFound,isMatch:!1},theme.layers.push(layer)),itemMetData.doclist.docs.slice(0,5).forEach(function(item){var feature=item.titel.join(" ");layer.features.push(feature)});break;case"Layer":var afterservicespart=itemMetData.groupValue.split("/services/")[1].split("/"),themeName=afterservicespart[1],url=(itemMetData.groupValue.split("/")[0],itemMetData.groupValue+"/Mapserver"),theme=themes.find(function(x){return x.name==themeName});theme?theme.layersCount=itemMetData.doclist.numFound:(theme={layers:[],layersCount:itemMetData.doclist.numFound,name:themeName,cleanUrl:url,url:url},themes.push(theme)),itemMetData.doclist.docs.forEach(function(item){if(item.titel[0].toLowerCase().includes(searchterm.toLowerCase())){var layer=theme.layers.find(function(x){return x.id==item.key});layer?layer.isMatch=!0:(layer={naam:item.titel[0],id:item.key,isMatch:!0,featuresCount:0,features:[]},theme.layers.push(layer))}});break;default:console.log("UNKOWN TYPE:",item)}}),$scope.availableThemes=themes.slice(0,5),$scope.allThemes=themes,$scope.numberofrecordsmatched=themes.length,console.log(data)},function(reason){console.log(reason)})},$scope.pageChanged=function(page,recordsAPage){var startItem=(page-1)*recordsAPage;$scope.availableThemes=$scope.allThemes.slice(startItem,startItem+recordsAPage)},$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.previewTheme=function(theme,layername){var alreadyExistingTheme=MapData.Themes.find(function(x){return x.cleanUrl===theme.cleanUrl});if(alreadyExistingTheme&&(theme=alreadyExistingTheme),layername){var layer=theme.AllLayers.find(function(x){return x.name==layername});layer&&(theme.enabled=!0,layer.enabled=!0,layer.AllLayers.forEach(function(x){return x.enabled=!0}),layer.parent&&(layer.parent.enabled=!0))}$scope.selectedTheme=theme,$scope.copySelectedTheme=angular.copy(theme)},$scope.clearPreview=function(){$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.error=null},$scope.solrThemeChanged=function(theme,layername){$scope.clearPreview(),$scope.themeloading=!0,GISService.GetThemeData(theme.cleanUrl).then(function(data,status,functie,getdata){if(data)if(data.error)PopupService.ErrorFromHTTP(data.error,status,theme.cleanUrl),$scope.error="Fout bij het laden van de mapservice.";else{var convertedTheme=ThemeCreater.createARCGISThemeFromJson(data,theme);$scope.previewTheme(convertedTheme,layername)}else{var callback=function(){var win=window.open("https://um.antwerpen.be/main.aspx","_blank");win.focus()},options={};options.timeOut=1e4,PopupService.Warning("U hebt geen rechten om het thema "+theme.name+" te raadplegen.","Klik hier om toegang aan te vragen.",callback,options)}$scope.themeloading=!1},function(data,status,functie,getdata){$scope.error="Fout bij het laden van de mapservice.",$scope.themeloading=!1}),$scope.selected=theme,$scope.isActive=function(theme){return $scope.selected===theme}},$scope.AddOrUpdateTheme=function(){PopupService.Success("Data is bijgewerkt.",null,null,{timeOut:1e3}),LayerManagementService.AddOrUpdateTheme($scope.selectedTheme,$scope.copySelectedTheme),$scope.clearPreview()},$scope.ok=function(){$modalInstance.$close()},$scope.cancel=function(){$modalInstance.$dismiss("cancel is pressed")}}])}(),function(module){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("wmsUrlController",["$scope","ThemeCreater","$q","MapService","MapData","GISService","LayerManagementService","WMSService","$window","$http","GeopuntService","PopupService",function($scope,ThemeCreater,$q,MapService,MapData,GISService,LayerManagementService,WMSService,$window,$http,GeopuntService,PopupService){$scope.urlIsValid=!1,$scope.themeloading=!1,$scope.urlChanged=function(){$scope.clearPreview(),null!=$scope.url&&$scope.url.startsWith("http")?$scope.urlIsValid=!0:$scope.urlIsValid=!1},$scope.laadUrl=function(){$scope.url=$scope.url.trim().replace("?",""),createWMS($scope.url)};var createWMS=function(url){$scope.clearPreview();var wms=MapData.Themes.find(function(x){return x.cleanUrl==url});if(void 0==wms){var getwms=WMSService.GetThemeData(url);$scope.themeloading=!0,getwms.success(function(data,status,headers,config){if($scope.themeloading=!1,data){var wmstheme=ThemeCreater.createWMSThemeFromJSON(data,url);$scope.previewTheme(wmstheme)}else $scope.error="Fout bij het laden van WMS.",PopupService.Error("Ongeldige WMS","De opgegeven url is geen geldige WMS url. ("+url+")")}).error(function(data,status,headers,config){$scope.error="Fout bij het laden van WMS.",$scope.themeloading=!1})}else $scope.previewTheme(wms)};$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.previewTheme=function(theme){$scope.selectedTheme=theme,$scope.copySelectedTheme=angular.copy(theme)},$scope.clearPreview=function(){$scope.selectedTheme=null,$scope.copySelectedTheme=null,$scope.error=null},$scope.AddOrUpdateTheme=function(){PopupService.Success("Data is bijgewerkt.",null,null,{timeOut:1e3}),LayerManagementService.AddOrUpdateTheme($scope.selectedTheme,$scope.copySelectedTheme),$scope.clearPreview()}}])}(),function(module){module=angular.module("tink.gis"),module.directive("geoPunt",function(){return{replace:!0,scope:{layer:"="},templateUrl:"templates/layermanagement/geoPuntTemplate.html",controller:"geoPuntController",controllerAs:"geoPuntctrl"}})}(),function(module){module=angular.module("tink.gis"),module.directive("tinkManagementlayer",["RecursionHelper",function(RecursionHelper){return{replace:!1,scope:{layer:"="},templateUrl:"templates/layermanagement/managementLayerTemplate.html",controller:"managementLayerController",controllerAs:"lyrctrl",compile:function(element){return RecursionHelper.compile(element)}}}])}(),function(module){module=angular.module("tink.gis"),module.directive("layersManagement",function(){return{replace:!0,templateUrl:"templates/layermanagement/layersManagementTemplate.html",controller:"layersManagementController",controllerAs:"layersManagementctrl"}})}(),function(module){module=angular.module("tink.gis"),module.directive("previewLayer",function(){return{replace:!0,scope:{theme:"=",addorupdatefunc:"&"},templateUrl:"templates/layermanagement/previewLayerTemplate.html",controller:"previewLayerController",controllerAs:"previewctrl"}})}(),function(module){module=angular.module("tink.gis"),module.directive("solrGis",function(){return{replace:!0,scope:{layer:"="},templateUrl:"templates/layermanagement/solrGISTemplate.html",controller:"solrGISController",controllerAs:"solrGISctrl"}})}(),function(module){module=angular.module("tink.gis"),module.directive("wmsUrl",function(){return{replace:!0,scope:{layer:"="},templateUrl:"templates/layermanagement/wmsUrlTemplate.html",controller:"wmsUrlController",controllerAs:"wmsUrlctrl"}})}(),function(){var module=angular.module("tink.gis"),service=function($http,map,MapData,$rootScope,$q,helperService,PopupService){var _service={};_service.getMetaData=function(){var searchterm=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"water",startpos=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,recordsAPage=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,url="https://metadata.geopunt.be/zoekdienst/srv/dut/csw?service=CSW&version=2.0.2&SortBy=title&request=GetRecords&namespace=xmlns%28csw=http://www.opengis.net/cat/csw%29&resultType=results&outputSchema=http://www.opengis.net/cat/csw/2.0.2&outputFormat=application/xml&startPosition="+startpos+"&maxRecords="+recordsAPage+"&typeNames=csw:Record&elementSetName=full&constraintLanguage=CQL_TEXT&constraint_language_version=1.1.0&constraint=AnyText+LIKE+%27%25"+searchterm+"%25%27AND%20Type%20=%20%27service%27%20AND%20Servicetype%20=%27view%27%20AND%20MetadataPointOfContact%20=%27AIV%27",prom=$q.defer(),proxiedurl=helperService.CreateProxyUrl(url);return $http.get(proxiedurl).success(function(data,status,headers,config){if(data){data=helperService.UnwrapProxiedData(data);var returnjson=JXON.stringToJs(data),getResults=returnjson["csw:getrecordsresponse"]["csw:searchresults"],returnObject={};if(returnObject.searchTerm=searchterm,returnObject.currentrecord=startpos,returnObject.recordsAPage=recordsAPage,returnObject.nextrecord=getResults.nextrecord,returnObject.numberofrecordsmatched=getResults.numberofrecordsmatched,returnObject.numberofrecordsreturned=getResults.numberofrecordsreturned,returnObject.results=[],0!=returnObject.numberofrecordsmatched){var themeArr=[];getResults["csw:record"].constructor===Array?themeArr=getResults["csw:record"]:themeArr.push(getResults["csw:record"]),themeArr.forEach(function(record){var processedTheme=procesTheme(record);returnObject.results.push(processedTheme)})}prom.resolve(returnObject)}else prom.reject(null),console.log("EMPTY RESULT")}).error(function(data,status,headers,config){prom.reject(null),PopupService.ErrorFromHttp(data,status,url)}),prom.promise};var procesTheme=function(record){if(record["dc:uri"]instanceof Array==0){var tmpdata=record["dc:uri"];record["dc:uri"]=[],record["dc:uri"].push(tmpdata)}var tmptheme={};tmptheme.Added=!1,tmptheme.Naam=record["dc:title"];var wmsinfo=record["dc:uri"].find(function(x){return"WMS"==x.protocol||"OGC:WMS"==x.protocol});return wmsinfo?(tmptheme.Url=wmsinfo.keyValue,tmptheme.Type=ThemeType.WMS):tmptheme.Type="DONTKNOW",tmptheme.TMPMETADATA=record,tmptheme};return _service};module.factory("GeopuntService",["$http","map","MapData","$rootScope","$q","GisHelperService","PopupService",service])}(),function(){var module=angular.module("tink.gis"),service=function(MapData,$http,$q,GISService,ThemeCreater,ThemeService){var _service={};return _service.EnabledThemes=[],_service.AvailableThemes=[],_service.AddOrUpdateTheme=function(selectedTheme,copySelectedTheme){console.log("AddOrUpdateTheme");for(var allChecked=!0,noneChecked=!0,hasAChange=!1,x=0;x<copySelectedTheme.AllLayers.length;x++){var copyLayer=copySelectedTheme.AllLayers[x],realLayer=selectedTheme.AllLayers[x];realLayer.enabled!=copyLayer.enabled&&(hasAChange=!0),realLayer.enabled=copyLayer.enabled,copyLayer.enabled===!1?allChecked=!1:noneChecked=!1}var alreadyAdded=void 0!=MapData.Themes.find(function(x){return x.cleanUrl===selectedTheme.cleanUrl});alreadyAdded?(hasAChange?selectedTheme.status=ThemeStatus.UPDATED:selectedTheme.status=ThemeStatus.UNMODIFIED,noneChecked&&(selectedTheme.status=ThemeStatus.DELETED)):selectedTheme.status=ThemeStatus.NEW,allChecked&&selectedTheme!=ThemeStatus.DELETED&&(selectedTheme.Added=!0),allChecked||noneChecked||selectedTheme==ThemeStatus.DELETED||(selectedTheme.Added=null),selectedTheme==ThemeStatus.DELETED&&(selectedTheme.Added=!1),ThemeService.AddAndUpdateThemes([selectedTheme])},_service};module.$inject=["MapData","$http","$q","GISService","ThemeCreater","ThemeService"],module.factory("LayerManagementService",service)}(),function(module){try{var module=angular.module("tink.gis")}catch(e){var module=angular.module("tink.gis",["tink.accordion","tink.tinkApi"])}module.controller("layerController",function($scope){var vm=this;vm.layer=$scope.layer,console.log(vm.layer)})}(),function(module){module=angular.module("tink.gis");var theController=module.controller("layersController",function($scope,MapData,map,ThemeService,$modal,FeatureService){var vm=this;vm.themes=MapData.Themes,vm.selectedLayers=[],vm.sortableOptions={stop:function(e,ui){MapData.SetZIndexes()}},vm.asidetoggle=function(){if(L.Browser.mobile){var html=$("html");html.hasClass("nav-left-open")&&html.removeClass("nav-left-open")}},vm.deleteLayerButtonIsEnabled=FeatureService.deleteLayerButtonIsEnabled,$scope.$watch(function(){return FeatureService.deleteLayerButtonIsEnabled},function(newValue,oldValue){vm.deleteLayerButtonIsEnabled=newValue}),vm.layerManagementButtonIsEnabled=FeatureService.layerManagementButtonIsEnabled,$scope.$watch(function(){return FeatureService.layerManagementButtonIsEnabled},function(newValue,oldValue){vm.layerManagementButtonIsEnabled=newValue}),$scope.$watch(function(){return MapData.Themes},function(newVal,oldVal){MapData.SetZIndexes(newVal)}),vm.updatethemevisibility=function(theme){ThemeService.UpdateThemeVisibleLayers(theme)},vm.Lagenbeheer=function(){var addLayerInstance=$modal.open({templateUrl:"templates/layermanagement/layerManagerTemplate.html",controller:"LayerManagerController",resolve:{backdrop:!1,keyboard:!0}});addLayerInstance.result.then(function(){},function(obj){console.log("Modal dismissed at: "+new Date)})}});theController.$inject=["MapData","map","ThemeService","$modal","FeatureService"]}(),function(module){module=angular.module("tink.gis");var theController=module.controller("mapController",function($scope,ExternService,BaseLayersService,MapService,MapData,map,MapEvents,DrawService,GisHelperService,GISService,PopupService,$interval,TypeAheadService,UIService,tinkApi,FeatureService){var vm=this;(function(){if(console.log("Tink-Gis-Angular component init!!!!!!!!!"),window.location.href.startsWith("http://localhost:9000/")){var externproj=JSON.parse('{"themes":[{"Naam":"Planon","cleanUrl":"https://geoint.antwerpen.be/arcgissql/rest/services/P_Planon/planon/MapServer","type":"esri","visible":true,"layers":[{"visible":true,"name":"PLANON_DOSSIER","id":1},{"visible":true,"name":"perceel","id":4}]},{"Naam":"Patrimonium","cleanUrl":"https://geoint.antwerpen.be/arcgis/rest/services/P_Sik/Patrimonium/MapServer","type":"esri","visible":true,"layers":[{"visible":true,"name":"KAVIA","id":17}]}],"extent":{"_southWest":{"lat":51.20536146014249,"lng":4.409578736245564},"_northEast":{"lat":51.206417795952646,"lng":4.411724381984817}},"isKaart":true}');ExternService.Import(externproj),PopupService.Success("Dev autoload","Velo en fietspad loaded because you are in DEV.",function(){alert("onclicktestje")})}TypeAheadService.init()})();vm.mobile=L.Browser.mobile,vm.ZoekenOpLocatie=!0,vm.activeInteractieKnop=MapData.ActiveInteractieKnop,$scope.$watch(function(){return MapData.ActiveInteractieKnop},function(data){vm.activeInteractieKnop=data},!0),vm.drawingType=MapData.DrawingType,$scope.$watch(function(){return MapData.DrawingType},function(data){vm.drawingType=data},!0),vm.SelectableLayers=function(){return MapData.VisibleLayers},vm.selectedLayer=MapData.SelectedLayer,$scope.$watch(function(){return MapData.SelectedLayer},function(newval,oldval){vm.selectedLayer=newval}),vm.selectedFindLayer=MapData.SelectedFindLayer,$scope.$watch(function(){return MapData.SelectedFindLayer},function(newval,oldval){vm.selectedFindLayer=newval}),$scope.$watch(function(){return MapData.ShowMetenControls},function(data){vm.showMetenControls=data},!0),vm.showMetenControls=MapData.ShowMetenControls,$scope.$watch(function(){return MapData.ShowDrawControls},function(data){vm.showDrawControls=data},!0),vm.showDrawControls=MapData.ShowDrawControls,vm.zoekLoc="",vm.addCursorAuto=function(){$(".leaflet-container").hasClass("cursor-auto")||$(".leaflet-container").addClass("cursor-auto")},vm.resetButtonBar=function(){MapData.ActiveInteractieKnop=ActiveInteractieButton.NIETS,vm.activeInteractieKnop=ActiveInteractieButton.NIETS,MapData.DrawingType=DrawingOption.NIETS,MapData.ExtendedType=null,MapData.ShowMetenControls=!1,MapData.ShowDrawControls=!1},vm.interactieButtonChanged=function(ActiveButton){if(vm.activeInteractieKnop!=ActiveButton)switch(MapData.ActiveInteractieKnop=ActiveButton,vm.activeInteractieKnop=ActiveButton,MapData.ShowMetenControls=!1,MapData.ShowDrawControls=!1,ActiveButton){case ActiveInteractieButton.IDENTIFY:case ActiveInteractieButton.WATISHIER:MapData.ExtendedType=null,vm.addCursorAuto();break;case ActiveInteractieButton.SELECT:MapData.ShowDrawControls=!0,MapData.DrawingType=DrawingOption.GEEN,vm.selectpunt();break;case ActiveInteractieButton.METEN:MapData.ExtendedType=null,MapData.ShowMetenControls=!0,MapData.DrawingType=DrawingOption.GEEN}else vm.resetButtonBar()},vm.zoekLaag=function(search){MapData.CleanMap(),MapService.Find(search),UIService.OpenLeftSide()};var setViewAndPutDot=function(loc){MapData.PanToPoint(loc),MapData.CreateDot(loc)};vm.zoekXY=function(search){search=search.trim();var WGS84Check=GisHelperService.getWGS84CordsFromString(search);if(WGS84Check.hasCordinates)setViewAndPutDot(WGS84Check);else{var lambertCheck=GisHelperService.getLambartCordsFromString(search);if(lambertCheck.hasCordinates){var xyWGS84=GisHelperService.ConvertLambert72ToWSG84({x:lambertCheck.x,y:lambertCheck.y});setViewAndPutDot(xyWGS84)}else console.log("NIET GEVONDEN")}},vm.drawingButtonChanged=function(drawOption){null==MapData.ExtendedType&&(drawOption!=DrawingOption.LIJN&&drawOption!=DrawingOption.POLYGON&&drawOption!=DrawingOption.NIETS&&drawOption!=DrawingOption.VIERKANT||(MapData.CleanMap(),MapData.CleanSearch()),drawOption==DrawingOption.AFSTAND||drawOption==DrawingOption.OPPERVLAKTE),MapData.DrawingType=drawOption,vm.drawingType=drawOption,DrawService.StartDraw(drawOption)},vm.Loading=0,vm.MaxLoading=0,vm.selectpunt=function(){MapData.DrawingType=DrawingOption.NIETS,vm.drawingType=DrawingOption.NIETS,null==MapData.ExtendedType&&(MapData.CleanMap(),MapData.CleanSearch()),vm.addCursorAuto()},vm.layerChange=function(){MapData.SelectedLayer=vm.selectedLayer},vm.findLayerChange=function(){MapData.SelectedFindLayer=vm.selectedFindLayer},vm.zoomIn=function(){map.zoomIn()},vm.zoomOut=function(){map.zoomOut()},vm.fullExtent=function(){map.setView(new L.LatLng(51.2192159,4.4028818),16)},vm.IsBaseMap1=!0,vm.toonBaseMap1=function(){vm.IsBaseMap1=!0,map.removeLayer(BaseLayersService.basemap2),map.addLayer(BaseLayersService.basemap1)},vm.toonBaseMap2=function(){vm.IsBaseMap1=!1,map.removeLayer(BaseLayersService.basemap1),map.addLayer(BaseLayersService.basemap2)},vm.baseMap1Naam=function(){return BaseLayersService.basemap1Naam},vm.baseMap2Naam=function(){return BaseLayersService.basemap2Naam},vm.cancelPrint=function(){var html=$("html");html.hasClass("print")&&html.removeClass("print"),vm.portrait(),tinkApi.sideNavToggle.recalculate("asideNavRight"),tinkApi.sideNavToggle.recalculate("asideNavLeft")},vm.print=function(){window.print()},vm.printStyle="portrait";var cssPagedMedia=function(){var style=document.createElement("style");return document.head.appendChild(style),function(rule){style.id="tempstyle",style.innerHTML=rule}}();cssPagedMedia.size=function(oriantation){cssPagedMedia("@page {size: A4 "+oriantation+"}")},vm.setPrintStyle=function(oriantation){vm.printStyle=oriantation,cssPagedMedia.size(oriantation)},vm.setPrintStyle("portrait"),vm.printLegendPreview=!1,vm.previewMap=function(){var html=$("html");vm.printLegendPreview=!1,html.hasClass("preview-legend")&&html.removeClass("preview-legend")},vm.previewLegend=function(){var html=$("html");vm.printLegendPreview=!0,html.hasClass("preview-legend")||html.addClass("preview-legend")},vm.portrait=function(){var html=$("html");vm.setPrintStyle("portrait"),html.hasClass("landscape")&&html.removeClass("landscape"),map.invalidateSize(!1)},vm.landscape=function(){var html=$("html");vm.setPrintStyle("landscape"),html.hasClass("landscape")||html.addClass("landscape"),map.invalidateSize(!1)},vm.ZoekenInLagen=function(){vm.ZoekenOpLocatie=!1,$(".twitter-typeahead").addClass("hide-element")},vm.fnZoekenOpLocatie=function(){return vm.ZoekenOpLocatie=!0,$(".twitter-typeahead").hasClass("hide-element")?void $(".twitter-typeahead").removeClass("hide-element"):vm.ZoekenOpLocatie},vm.gpstracking=!1;var gpstracktimer=null,gpsmarker=null;vm.zoomToGps=function(){vm.gpstracking=!vm.gpstracking,0==vm.gpstracking?($interval.cancel(gpstracktimer),MapEvents.ClearGPS()):(map.locate({setView:!0,maxZoom:16}),gpstracktimer=$interval(function(){map.locate({setView:!1}),console.log("gps refresh")},5e3))},map.on("locationfound",function(e){MapEvents.ClearGPS();var gpsicon=L.divIcon({className:"fa fa-crosshairs fa-2x blue",style:"color: blue"});gpsmarker=L.marker(e.latlng,{icon:gpsicon}).addTo(map)}),map.on("locationerror",function(e){vm.gpstracking=!1,$interval.cancel(gpstracktimer),MapEvents.ClearGPS(),PopupService.Warning("Browser heeft geen toegang tot locatiegegevens")})});theController.$inject=["BaseLayersService","ExternService","MapService","MapData","map","MapEvents","DrawService","GisHelperService","GISService","PopupService","$interval","UIService","tinkApi","FeatureService"]}(),function(module){module=angular.module("tink.gis"),module.controller("themeController",["$scope","MapService","ThemeService",function($scope,MapService,ThemeService){var vm=this;console.log("Theme geladen"),vm.theme=$scope.theme,vm.hidedelete=$scope.hidedelete,vm.chkChanged=function(){ThemeService.UpdateThemeVisibleLayers(vm.theme)},vm.deleteTheme=function(){swal({title:"Verwijderen?",text:"U staat op het punt om "+vm.theme.Naam+" te verwijderen.",type:"warning",showCancelButton:!0,cancelButtonText:"Annuleer",confirmButtonColor:"#DD6B55",confirmButtonText:"Verwijder",closeOnConfirm:!0},function(){ThemeService.DeleteTheme(vm.theme),$scope.$applyAsync()}),console.log(vm.theme)},vm.transpSlider={value:100*vm.theme.Opacity,options:{hideLimitLabels:!0,hidePointerLabels:!0,floor:0,ceil:100,onEnd:function(){console.log(vm.transpSlider.value/100),vm.theme.SetOpacity(vm.transpSlider.value/100)}}}}])}(),function(module){angular.module("tink.gis").directive("indeterminateCheckbox",[function(){return{scope:!0,require:"?ngModel",link:function(scope,element,attrs,modelCtrl){function watchChildrenListWithProperty(){return thelist.map(function(x){return x[property]})}var childList=attrs.childList,property=attrs.property;element.bind("change",function(){scope.$applyAsync(function(){var isChecked=element.prop("checked");angular.forEach(scope.$eval(childList),function(child){child[property]=isChecked})})});var thelist=scope.$eval(childList);thelist&&scope.$watch(watchChildrenListWithProperty,function(newValue,oldValue){if(newValue!==oldValue){var hasChecked=!1,hasUnchecked=!1;angular.forEach(newValue,function(child){child?hasChecked=!0:hasUnchecked=!0}),hasChecked&&hasUnchecked?(element.prop("checked",!0),element.prop("indeterminate",!0),modelCtrl&&modelCtrl.$setViewValue(!0)):(element.prop("checked",hasChecked),element.prop("indeterminate",!1),modelCtrl&&modelCtrl.$setViewValue(hasChecked))}},!0)}}}])}(),function(module){module=angular.module("tink.gis"),module.directive("tinkLayer",["RecursionHelper",function(RecursionHelper){return{replace:!1,scope:{layer:"=",layercheckboxchange:"&"},templateUrl:"templates/other/layerTemplate.html",controller:"layerController",controllerAs:"lyrctrl",compile:function(element){return RecursionHelper.compile(element)}}}])}(),function(module){module=angular.module("tink.gis"),module.directive("tinkLayers",function(){return{replace:!0,templateUrl:"templates/other/layersTemplate.html",controller:"layersController",controllerAs:"lyrsctrl"}})}(),function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter","tink.pagination"])}module.directive("tinkMap",function(){return{replace:!0,templateUrl:"templates/other/mapTemplate.html",controller:"mapController",controllerAs:"mapctrl"}})}(),function(module){module=angular.module("tink.gis"),module.directive("tinkTheme",function(){return{replace:!0,scope:{theme:"=",layercheckboxchange:"&",hidedelete:"="},templateUrl:"templates/other/themeTemplate.html",controller:"themeController",controllerAs:"thmctrl"}})}(),function(){var module=angular.module("tink.gis"),service=function($http,GisHelperService,$q,PopupService){var _service={};_service.ReverseGeocode=function(event){var lambert72Cords=GisHelperService.ConvertWSG84ToLambert72(event.latlng),loc=lambert72Cords.x+","+lambert72Cords.y,urlloc=encodeURIComponent(loc),url=Gis.BaseUrl+"arcgissql/rest/services/COMLOC_CRAB_NAVTEQ/GeocodeServer/reverseGeocode?location="+urlloc+"&distance=50&outSR=&f=json",prom=$http.get(url);return prom.success(function(data,status,headers,config){}).error(function(data,status,headers,config){PopupService.ErrorFromHttp(data,status,url)}),prom},_service.QueryCrab=function(straatnaam,huisnummer){var prom=$q.defer();return $http.get("https://geoint.antwerpen.be/arcgissql/rest/services/P_Stad/CRAB_adresposities/MapServer/0/query?where=GEMEENTE%3D%27Antwerpen%27%20and%20STRAATNM%20%3D%27"+straatnaam+"%27%20and%20(HUISNR%20like%20%27"+huisnummer+"%27%20or%20Huisnr%20like%20%27"+huisnummer+"%5Ba-z%5D%27or%20Huisnr%20like%20%27"+huisnummer+"%5B_%5D%25%27)%20and%20APPTNR%20%3D%20%27%27%20and%20busnr%20%3D%20%27%27&text=&objectIds=&time=&geometry=&geometryType=esriGeometryEnvelope&inSR=&spatialRel=esriSpatialRelIntersects&relationParam=&outFields=*&returnGeometry=true&maxAllowableOffset=&geometryPrecision=&outSR=&returnIdsOnly=false&returnCountOnly=false&orderByFields=&groupByFieldsForStatistics=&outStatistics=&returnZ=false&returnM=false&gdbVersion=&returnDistinctValues=false&f=pjson").success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){prom.reject(null),PopupService.ErrorFromHttp(data,status,url)}),prom.promise},_service.QuerySOLRGIS=function(search){var prom=$q.defer(),url=Solr.BaseUrl+"giszoek/solr/search?q=*"+search+"*&wt=json&indent=true&facet=true&rows=999&facet.field=parent&group=true&group.field=parent&group.limit=999&solrtype=gis";return $http.get(url).success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){prom.reject(null),PopupService.ErrorFromHttp(data,status,url)}),prom.promise},_service.QuerySOLRLocatie=function(search){var prom=$q.defer(),url=Solr.BaseUrl+"giszoek/solr/search?q=*"+search+"*&wt=json&indent=true&rows=50&solrtype=gislocaties&dismax=true&bq=exactName:DISTRICT^20000.0&bq=layer:straatnaam^20000.0";return $http.get(url).success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){prom.reject(null),PopupService.ErrorFromHttp(data,status,url)}),prom.promise};var completeUrl=function(url){return url},generateOptionsBasedOnUrl=function(url,opts){return opts||(opts={}),url.toLowerCase().includes("p_sik")&&(opts.withCredentials=!0),opts};return _service.GetThemeData=function(mapserver){var prom=$q.defer(),url=completeUrl(mapserver)+"?f=pjson";return console.log("ZZZZZ"),$http.get(url,generateOptionsBasedOnUrl(url)).success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){console.log("ZZZZZ"),url.toLocaleLowerCase().contains("p_sik")?prom.resolve(null):(prom.reject(null),PopupService.ErrorFromHttp(data,status,url))}),prom.promise},_service.GetThemeLayerData=function(cleanurl){var prom=$q.defer(),url=completeUrl(cleanurl)+"/layers?f=pjson";return $http.get(url,generateOptionsBasedOnUrl(url)).success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){prom.reject(null),PopupService.ErrorFromHttp(data,status,url)}),prom.promise},_service.GetLegendData=function(cleanurl){var prom=$q.defer(),url=completeUrl(cleanurl)+"/legend?f=pjson";return $http.get(url,generateOptionsBasedOnUrl(url)).success(function(data,status,headers,config){prom.resolve(data)}).error(function(data,status,headers,config){prom.reject(null),PopupService.ErrorFromHttp(data,status,url)}),prom.promise},_service.GetAditionalLayerInfo=function(theme){var promLegend=_service.GetLegendData(theme.cleanUrl);promLegend.then(function(data){theme.AllLayers.forEach(function(layer){var layerid=layer.id,layerInfo=data.layers.find(function(x){return x.layerId==layerid});layer.legend=[],layerInfo&&(layer.legend=layerInfo.legend,layer.legend.forEach(function(legenditem){legenditem.fullurl="data:"+legenditem.contentType+";base64,"+legenditem.imageData}))})});var promLayerData=_service.GetThemeLayerData(theme.cleanUrl);promLayerData.then(function(data){theme.AllLayers.forEach(function(layer){var layerid=layer.id,layerInfo=data.layers.find(function(x){return x.id==layerid});layer.displayField=layerInfo.displayField,layer.fields=layerInfo.fields})})},_service};module.$inject=["$http","GisHelperService","$q","PopupService"],module.factory("GISService",service)}(),function(){var module=angular.module("tink.gis"),service=function($http,MapService,MapData){var _service={};_service.Buffer=function(loc,distance,selectedlayer){var geo=getGeo(loc.geometry);delete geo.geometry.spatialReference,geo.geometries=geo.geometry,delete geo.geometry;var sergeo=serialize(geo),url=Gis.GeometryUrl;loc.mapItem&&(loc.mapItem.isBufferedItem=!0);var body="inSR=4326&outSR=4326&bufferSR=31370&distances="+100*distance+"&unit=109006&unionResults=true&geodesic=false&geometries=%7B"+sergeo+"%7D&f=json",prom=$http({method:"POST",url:url,data:body,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8;"}});prom.success(function(response){MapData.CleanSearch();var buffer=MapData.CreateBuffer(response);return MapService.Query(buffer,selectedlayer),MapData.SetStyle(loc.mapItem,Style.COREBUFFER,L.AwesomeMarkers.icon({icon:"fa-circle-o",markerColor:"lightgreen"})),prom})},_service.Doordruk=function(location){MapData.CleanSearch(),MapData.CleanMap(),console.log(location),MapService.Query(location,{id:""})};var getGeo=function(geometry){var geoconverted={};return geometry instanceof L.LatLngBounds?(geoconverted.geometry=L.esri.Util.boundsToExtent(geometry),geoconverted.geometryType="esriGeometryEnvelope",geoconverted):(geometry.getLatLng&&(geometry=geometry.getLatLng()),geometry instanceof L.LatLng&&(geometry={type:"Point",coordinates:[geometry.lng,geometry.lat]}),geometry instanceof L.GeoJSON&&(geometry=geometry.getLayers()[0].feature.geometry,geoconverted.geometry=L.esri.Util.geojsonToArcGIS(geometry),geoconverted.geometryType=L.esri.Util.geojsonTypeToArcGIS(geometry.type)),geometry.toGeoJSON&&(geometry=geometry.toGeoJSON()),"Feature"===geometry.type?geometry=geometry.geometry:(geoconverted.geometry=L.esri.Util.geojsonToArcGIS(geometry),geoconverted.geometryType=L.esri.Util.geojsonTypeToArcGIS(geometry.type)),geoconverted)},serialize=function(params){var data="";for(var key in params)if(params.hasOwnProperty(key)){var value,param=params[key],type=Object.prototype.toString.call(param);data.length&&(data+=","),value="[object Array]"===type?"[object Object]"===Object.prototype.toString.call(param[0])?JSON.stringify(param):param.join(","):"[object Object]"===type?JSON.stringify(param):"[object Date]"===type?param.valueOf():'"'+param+'"',data+="geometries"==key?encodeURIComponent('"'+key+'"')+":"+encodeURIComponent("["+value+"]"):encodeURIComponent('"'+key+'"')+":"+encodeURIComponent(value)}return data};return _service};module.$inject=["$http","MapService","MapData"],module.factory("GeometryService",service)}(),function(){var module=angular.module("tink.gis"),service=function($http,GisHelperService,$q,PopupService){var _service={};return _service.GetThemeData=function(url){var fullurl=url+"?request=GetCapabilities&service=WMS",proxiedurl=GisHelperService.CreateProxyUrl(fullurl),prom=$http({method:"GET",url:proxiedurl,timeout:1e4,transformResponse:function(data){return data&&(data=GisHelperService.UnwrapProxiedData(data),data.listOfHttpError||(data=JXON.stringToJs(data).wms_capabilities)),data}}).success(function(data,status,headers,config){}).error(function(data,status,headers,config){PopupService.ErrorFromHttp(data,status,fullurl)});return prom},_service};module.$inject=["$http","GisHelperService","$q","PopupService"],module.factory("WMSService",service)}(),function(){try{var module=angular.module("tink.gis")}catch(e){var module=angular.module("tink.gis",["tink.accordion","tink.tinkApi"])}var baseLayersService=function(map){var _baseLayersService={};
return _baseLayersService.basemap2Naam="Geen",_baseLayersService.basemap1Naam="Geen",_baseLayersService.setBaseMap=function(id,naam,url){var maxZoom=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,minZoom=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,layer=L.esri.tiledMapLayer({url:url,maxZoom:maxZoom,minZoom:minZoom,continuousWorld:!0});1==id?(_baseLayersService.basemap1&&map.removeLayer(_baseLayersService.basemap1),_baseLayersService.basemap1Naam=naam,_baseLayersService.basemap1=layer,_baseLayersService.basemap1.addTo(map)):2==id&&(_baseLayersService.basemap2&&map.removeLayer(_baseLayersService.basemap2),_baseLayersService.basemap2=layer,_baseLayersService.basemap2Naam=naam)},_baseLayersService.setBaseMap(1,"Kaart","https://geodata.antwerpen.be/arcgissql/rest/services/P_Publiek/P_basemap/MapServer"),_baseLayersService.setBaseMap(2,"Luchtfoto","https://geodata.antwerpen.be/arcgissql/rest/services/P_Publiek/Luchtfoto_2015/MapServer"),_baseLayersService};module.factory("BaseLayersService",baseLayersService)}(),L.Draw.Rectangle=L.Draw.Rectangle.extend({_getTooltipText:function(){var latLngs,area,subtext,tooltipText=L.Draw.SimpleShape.prototype._getTooltipText.call(this),shape=this._shape;return shape&&(latLngs=this._shape.getLatLngs(),area=L.GeometryUtil.geodesicArea(latLngs),subtext=L.GeometryUtil.readableArea(area,this.options.metric)),{text:tooltipText.text,subtext:""}}}),function(){try{var module=angular.module("tink.gis")}catch(e){var module=angular.module("tink.gis",["tink.accordion","tink.tinkApi"])}var service=function(MapData,map){var _service={};return _service.StartDraw=function(DrawingOptie){var options={metric:!0,showArea:!1,shapeOptions:{stroke:!0,color:"#22528b",weight:4,opacity:.6,fillColor:null,fillOpacity:.4,clickable:!1}};switch(MapData.DrawingType){case DrawingOption.LIJN:case DrawingOption.AFSTAND:null==MapData.ExtendedType?(MapData.DrawingObject=new L.Draw.Polyline(map,options),MapData.DrawingObject.enable()):(MapData.DrawingExtendedObject=new L.Draw.Polyline(map,options),MapData.DrawingExtendedObject.enable());break;case DrawingOption.POLYGON:case DrawingOption.OPPERVLAKTE:null==MapData.ExtendedType?(MapData.DrawingObject=new L.Draw.Polygon(map,options),MapData.DrawingObject.enable()):(MapData.DrawingExtendedObject=new L.Draw.Polygon(map,options),MapData.DrawingExtendedObject.enable());break;case DrawingOption.VIERKANT:null==MapData.ExtendedType?(MapData.DrawingObject=new L.Draw.Rectangle(map,options),MapData.DrawingObject.enable()):(MapData.DrawingExtendedObject=new L.Draw.Rectangle(map,options),MapData.DrawingExtendedObject.enable())}},_service};module.factory("DrawService",service)}();var esri2geo={};!function(){function toGeoJSON(data,cb){if("string"==typeof data){if(cb)return void ajax(data,function(err,d){toGeoJSON(d,cb)});throw new TypeError("callback needed for url")}for(var outPut={type:"FeatureCollection",features:[]},fl=data.geometries.length,i=0;fl>i;){var ft=data.geometries[i],outFT={type:"Feature",properties:prop(ft.attributes)};ft.x?outFT.geometry=point(ft):ft.points?outFT.geometry=points(ft):ft.paths?outFT.geometry=line(ft):ft.rings&&(outFT.geometry=poly(ft)),outPut.features.push(outFT),i++}return outPut}function point(geometry){return{type:"Point",coordinates:[geometry.x,geometry.y]}}function points(geometry){return 1===geometry.points.length?{type:"Point",coordinates:geometry.points[0]}:{type:"MultiPoint",coordinates:geometry.points}}function line(geometry){return 1===geometry.paths.length?{type:"LineString",coordinates:geometry.paths[0]}:{type:"MultiLineString",coordinates:geometry.paths}}function poly(geometry){return 1===geometry.rings.length?{type:"Polygon",coordinates:geometry.rings}:decodePolygon(geometry.rings)}function decodePolygon(a){for(var type,coords=[],len=a.length,i=0,len2=coords.length-1;len>i;)ringIsClockwise(a[i])?(coords.push([a[i]]),len2++):coords[len2].push(a[i]),i++;return type=1===coords.length?"Polygon":"MultiPolygon",{type:type,coordinates:1===coords.length?coords[0]:coords}}function ringIsClockwise(ringToTest){var pt2,total=0,i=0,rLength=ringToTest.length,pt1=ringToTest[i];for(i;i<rLength-1;i++)pt2=ringToTest[i+1],total+=(pt2[0]-pt1[0])*(pt2[1]+pt1[1]),pt1=pt2;return total>=0}function prop(a){var p={};for(var k in a)a[k]&&(p[k]=a[k]);return p}function ajax(url,cb){if("undefined"!=typeof module){var request=require("request");return void request(url,{json:!0},function(e,r,b){cb(e,b)})}var req=new XMLHttpRequest;req.onreadystatechange=function(){4===req.readyState&&200===req.status&&cb(null,JSON.parse(req.responseText))},req.open("GET",url),req.send()}"undefined"!=typeof module?module.exports=toGeoJSON:esri2geo.toGeoJSON=toGeoJSON}(),function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","tink.modal"])}var externService=function(MapData,map,GISService,ThemeCreater,WMSService,ThemeService,$q,BaseLayersService,FeatureService,ResultsData,PopupService){var _externService={};return _externService.GetAllThemes=function(){var legendItem={};return legendItem.EsriThemes=MapData.Themes.filter(function(x){return x.Type==ThemeType.ESRI}),legendItem.WmsThemes=MapData.Themes.filter(function(x){return x.Type==ThemeType.WMS}),legendItem},_externService.SetPrintPreview=function(){var cent=map.getCenter(),html=$("html");html.hasClass("print")||html.addClass("print"),html.hasClass("landscape")&&html.removeClass("landscape"),map.invalidateSize(!1),map.setView(cent)},_externService.Export=function(){var exportObject={},arr=MapData.Themes.map(function(theme){var returnitem={};return theme.Naam||(theme.Naam="no_title_found"),returnitem.Naam=theme.Naam,returnitem.cleanUrl=theme.cleanUrl||theme.Url,returnitem.opacity=theme.Opacity,returnitem.type=theme.Type,returnitem.visible=theme.Visible,returnitem.layers=theme.AllLayers.filter(function(x){return 1==x.enabled}).map(function(layer){var returnlayer={};return returnlayer.visible=layer.visible,theme.Type==ThemeType.ESRI?(returnlayer.name=layer.name,returnlayer.id=layer.id):(returnlayer.name=layer.title,returnlayer.id=layer.title),returnlayer}),returnitem});return exportObject.themes=arr,exportObject.extent=map.getBounds(),exportObject.isKaart=!0,exportObject},_externService.Import=function(project){console.log(project),_externService.setExtent(project.extent);var themesArray=[],promises=[];project.themes.forEach(function(theme){if(theme.type==ThemeType.ESRI){var prom=GISService.GetThemeData(theme.cleanUrl);promises.push(prom),prom.then(function(data){if(data)if(data.error)PopupService.ErrorWithException("Fout bij laden van mapservice","Kan mapservice met volgende url niet laden: "+theme.cleanUrl,data.error);else{var arcgistheme=ThemeCreater.createARCGISThemeFromJson(data,theme);themesArray.push(arcgistheme)}else{var callback=function(){var win=window.open("https://um.antwerpen.be/main.aspx","_blank");win.focus()},options={};options.timeOut=1e4,PopupService.Warning("U hebt geen rechten om het thema "+theme.Naam+" te raadplegen.","Klik hier om toegang aan te vragen.",callback,options)}})}else{var _prom=WMSService.GetThemeData(theme.cleanUrl);promises.push(_prom),_prom.success(function(data,status,headers,config){var wmstheme=ThemeCreater.createWMSThemeFromJSON(data,theme.cleanUrl);themesArray.push(wmstheme)}).error(function(data,status,headers,config){console.log("error!!!!!!!",data,status,headers,config)})}});var allpromises=$q.all(promises);return allpromises.then(function(){var orderedArray=[],errorMessages=[];if(project.themes.forEach(function(theme){var realTheme=themesArray.find(function(x){return x.cleanUrl==theme.cleanUrl});realTheme&&(console.log(theme," vs real theme: ",realTheme),realTheme.Visible=theme.visible,realTheme.AllLayers.length==theme.layers.length?realTheme.Added=!0:realTheme.Added=null,realTheme.AllLayers.forEach(function(layer){layer.enabled=!1}),theme.layers.forEach(function(layer){var realLayer=realTheme.AllLayers.find(function(x){return x.title==layer.name});realLayer?(realLayer.visible=layer.visible,realLayer.enabled=!0):errorMessages.push('"'+layer.name+'" not found in mapserver: '+realTheme.Naam+".")}))}),project.themes.forEach(function(theme){var realTheme=themesArray.find(function(x){return x.cleanUrl==theme.cleanUrl});realTheme&&(orderedArray.unshift(realTheme),realTheme.status=ThemeStatus.NEW)}),ThemeService.AddAndUpdateThemes(orderedArray),console.log("all loaded"),errorMessages.length>0&&PopupService.Warning("Fout bij import",errorMessages.join("\n")),FeatureService.defaultLayerName){var defaultLayer=MapData.VisibleLayers.find(function(x){return x.name==FeatureService.defaultLayerName});defaultLayer&&(MapData.SelectedLayer=defaultLayer,MapData.SelectedFindLayer=defaultLayer,MapData.DefaultLayer=defaultLayer)}}),allpromises},_externService.setExtent=function(extent){map.fitBounds([[extent._northEast.lat,extent._northEast.lng],[extent._southWest.lat,extent._southWest.lng]])},_externService.setExtendFromResults=function(){if(ResultsData.JsonFeatures&&ResultsData.JsonFeatures.length>0){var featuregrp=L.featureGroup();ResultsData.JsonFeatures.forEach(function(feature){featuregrp.addLayer(feature.mapItem)});var featureBounds=featuregrp.getBounds();map.fitBounds(featureBounds)}},_externService.CleanMapAndThemes=function(){MapData.CleanMap(),ThemeService.CleanThemes()},_externService.LoadConfig=function(config){Gis.GeometryUrl=config.Gis.GeometryUrl,Gis.BaseUrl=config.Gis.BaseUrl,Style.Default=config.Style.Default,Style.HIGHLIGHT=config.Style.HIGHLIGHT,Style.BUFFER=config.Style.BUFFER,BaseLayersService.setBaseMap(1,config.BaseKaart1.Naam,config.BaseKaart1.Url,config.BaseKaart1.MaxZoom,config.BaseKaart1.MinZoom),BaseLayersService.setBaseMap(2,config.BaseKaart2.Naam,config.BaseKaart2.Url,config.BaseKaart2.MaxZoom,config.BaseKaart2.MinZoom)},_externService};module.factory("ExternService",externService)}(),function(){var module=angular.module("tink.gis"),featureService=function(){var _featureService={};return _featureService.layerManagementButtonIsEnabled=!0,_featureService.deleteLayerButtonIsEnabled=!0,_featureService.exportToCSVButtonIsEnabled=!0,_featureService.defaultLayerName=null,_featureService.ConfigResultButton=function(isEnabled,text,callback,conditioncallback){_featureService.resultButtonText=text,_featureService.extraResultButtonIsEnabled=isEnabled,callback&&(_featureService.extraResultButtonCallBack=callback),conditioncallback&&(_featureService.extraResultButtonConditionCallBack=conditioncallback)},_featureService.extraResultButtonIsEnabled=!1,_featureService.resultButtonText="extra knop text",_featureService.extraResultButtonCallBack=function(){},_featureService.extraResultButtonConditionCallBack=function(){return _featureService.extraResultButtonIsEnabled},_featureService};module.factory("FeatureService",featureService)}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj};!function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter","tink.pagination"])}var service=function(){var _service={};proj4.defs("EPSG:31370","+proj=lcc +lat_1=51.16666723333334 +lat_2=49.83333389999999 +lat_0=90 +lon_0=4.367486666666666 +x_0=150000.013 +y_0=5400088.438 +ellps=intl +towgs84=-99.1,53.3,-112.5,0.419,-0.83,1.885,-1.0 +units=m +no_defs");var getApiURL=function(){return window.location.href.startsWith("https://stadinkaart-a.antwerpen.be/")?"https://stadinkaart-a.antwerpen.be/digipolis.stadinkaart.api/":window.location.href.startsWith("https://stadinkaart-o.antwerpen.be/")?"https://stadinkaart-o.antwerpen.be/digipolis.stadinkaart.api/":window.location.href.startsWith("https://stadinkaart.antwerpen.be/")?"https://stadinkaart.antwerpen.be/digipolis.stadinkaart.api/":"https://localhost/digipolis.stadinkaart.api/"};_service.getEnvironment=function(){return window.location.href.startsWith("https://stadinkaart.antwerpen.be/")?"P":window.location.href.startsWith("https://stadinkaart-a.antwerpen.be/")?"A":window.location.href.startsWith("https://stadinkaart-o.antwerpen.be/")?"O":window.location.href.startsWith("https://localhost/")?"D":"L"},_service.CreateProxyUrl=function(url){return getApiURL()+"Proxy/go?url="+encodeURIComponent(url)},_service.UnwrapProxiedData=function(data){return"string"==typeof data&&data.startsWith('{"listOfString":')?data=$.parseJSON(data).listOfString:"object"==("undefined"==typeof data?"undefined":_typeof(data))&&data.listOfString&&(data=data.listOfString),"string"==typeof data&&data.startsWith("{")&&(data=JSON.parse(data)),"string"==typeof data&&data.startsWith('<?xml version="1.0" encoding="UTF-8"?>')&&(data=data.slice(38).trim()),data},_service.ConvertWSG84ToLambert72=function(coordinates){var result=proj4("EPSG:31370",[coordinates.lng||coordinates.x,coordinates.lat||coordinates.y]);return{x:result[0],y:result[1]}},_service.ConvertLambert72ToWSG84=function(coordinates){var x=coordinates.lng||coordinates.x||coordinates[0],y=coordinates.lat||coordinates.y||coordinates[1],result=proj4("EPSG:31370","WGS84",[parseFloat(x),parseFloat(y)]);return{y:result[0],x:result[1]}};var isCharDigit=function(n){return" "!=n&&n>-1};return _service.getWGS84CordsFromString=function(search){var returnobject={};returnobject.hasCordinates=!1,returnobject.error=null,returnobject.x=null,returnobject.y=null;var currgetal="",samegetal=!1,aantalmetcorrectesize=0,hasaseperater=!1,getals=[];if((search.contains("51.")||search.contains("51,"))&&(search.contains("4.")||search.contains("4,"))){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=search[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var char=_step.value;isCharDigit(char)?samegetal?currgetal+=char:(currgetal=""+char,samegetal=!0):"51"!=currgetal&&"4"!=currgetal||"."!=char&&","!=char||0!=hasaseperater?(""!=currgetal&&getals.push(currgetal),currgetal="",samegetal=!1,hasaseperater=!1):(currgetal+=char,aantalmetcorrectesize++,hasaseperater=!0)}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}""!=currgetal&&getals.push(currgetal)}return 2==aantalmetcorrectesize&&2==getals.length?(returnobject.x=getals[0].replace(",","."),returnobject.y=getals[1].replace(",","."),returnobject.hasCordinates=!0,returnobject):(returnobject.error="Incorrect format: X,Y is required",returnobject)},_service.getLambartCordsFromString=function(search){var returnobject={};returnobject.hasCordinates=!1,returnobject.error=null,returnobject.x=null,returnobject.y=null;var getals=[],currgetal="",samegetal=!1,aantalmet6size=0,hasaseperater=!1,_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=search[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var char=_step2.value;if(isCharDigit(char))samegetal?currgetal+=char:(currgetal=""+char,samegetal=!0);else{if(6==currgetal.length){if(!(currgetal>125e3&&currgetal<175e3||currgetal>18e4&&currgetal<24e4))return returnobject.error="Out of bounds cordinaten voor Antwerpen.",returnobject;aantalmet6size++}","!=char&&"."!=char||0!=hasaseperater?(hasaseperater=!1,getals.push(currgetal),currgetal="",samegetal=!1):(hasaseperater=!0,currgetal+=char)}}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}""!=currgetal&&(6==currgetal.length&&aantalmet6size++,getals.push(currgetal));var getals=getals.filter(function(x){return""!=x.trim()});return 2==aantalmet6size&&2==getals.length?(returnobject.x=getals[0].replace(",","."),returnobject.y=getals[1].replace(",","."),returnobject.hasCordinates=!0,returnobject):(returnobject.error="Incorrect format: Lat,Lng is required",returnobject)},_service};module.factory("GisHelperService",service)}(),function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi",["ui.sortable"]])}var layersService=function(){var _layersService={};return _layersService};module.$inject=[],module.factory("LayersService",layersService)}(),L.Control.Typeahead=L.Control.extend({options:{position:"topleft"},initialize:function(args){console.log("init"),this.arguments=[];for(var i=0;i<args.length-1;i++)this.arguments.push(args[i]);L.Util.setOptions(this,args[args.length-1])},onAdd:function(map){console.log("onadd");var that=this,container=L.DomUtil.create("div","");return container.style.position="absolute",this.typeahead=L.DomUtil.create("input","typeahead tt-input",container),this.typeahead.type="text",this.typeahead.id="okzor",this.typeahead.placeholder=this.options.placeholder,$(this.typeahead).typeahead.apply($(this.typeahead),this.arguments),["typeahead:active","typeahead:idle","typeahead:open","typeahead:close","typeahead:change","typeahead:render","typeahead:select","keyup","typeahead:autocomplete","typeahead:cursorchange","typeahead:asyncrequest","typeahead:asynccancel","typeahead:asyncreceive"].forEach(function(method){that.options[method]&&$(that.typeahead).bind(method,that.options[method])}),L.DomEvent.disableClickPropagation(container),container},onRemove:function(map){},keyup:function(e){console.log("typeahead KEYUP!!",e),13==e.keyCode&&$(".tt-suggestion:first-child",this).trigger("click"),38===e.keyCode||40===e.keyCode},itemSelected:function(e){console.log("item selcted"),L.DomEvent.preventDefault(e)},submit:function(e){console.log("submit"),L.DomEvent.preventDefault(e)}}),L.control.typeahead=function(args){return new L.Control.Typeahead(arguments)},function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","tink.modal"])}var loadingService=function(){var _loadingService={};return _loadingService.Init=void 0,_loadingService.ShowLoading=function(){var html=$("html");html.hasClass("show-loader")||html.addClass("show-loader")},_loadingService.HideLoading=function(){var html=$("html");html.hasClass("show-loader")&&html.removeClass("show-loader")},_loadingService};module.factory("LoadingService",loadingService)}(),function(){var module=angular.module("tink.gis"),mapData=function(map,$rootScope,GisHelperService,ResultsData,$compile,FeatureService,SearchService,$timeout){var _data={};_data.VisibleLayers=[],_data.SelectableLayers=[],_data.VisibleFeatures=[],_data.TempExtendFeatures=[],_data.IsDrawing=!1,_data.Themes=[],_data.defaultlayer={id:"",name:"Alle lagen"},_data.VisibleLayers.unshift(_data.defaultlayer),_data.SelectedLayer=_data.defaultlayer,_data.DrawLayer=null,_data.DefaultLayer=null,_data.SelectedFindLayer=_data.defaultlayer,_data.ResetVisibleLayers=function(){console.log("RestVisLayers");var curSelectedLayer=_data.SelectedLayer||_data.defaultlayer;_data.VisibleLayers.length=0,_data.Themes.filter(function(x){return x.Type===ThemeType.ESRI}).forEach(function(x){_data.VisibleLayers=_data.VisibleLayers.concat(x.VisibleLayers)}),_data.VisibleLayers=_data.VisibleLayers.sort(function(x){return x.title}),_data.VisibleLayers.unshift(_data.defaultlayer);var reselectLayer=_data.VisibleLayers.find(function(x){return x.name==curSelectedLayer.name});reselectLayer?_data.SelectedLayer=reselectLayer:_data.SelectedLayer=_data.defaultlayer},_data.ActiveInteractieKnop=ActiveInteractieButton.NIETS,_data.DrawingType=DrawingOption.NIETS,_data.ShowDrawControls=!1,_data.ShowMetenControls=!1,_data.LastBufferedLayer=null,_data.LastBufferedDistance=50,_data.ExtendedType=null,_data.DrawingObject=null,_data.DrawingExtendedObject=null,_data.LastIdentifyBounds=null,_data.CleanDrawingExtendedObject=function(){_data.DrawingExtendedObject&&(_data.DrawingExtendedObject.layer&&(_data.DrawingExtendedObject.layer._popup=null),_data.DrawingExtendedObject.disable&&_data.DrawingExtendedObject.disable(),map.extendFeatureGroup.clearLayers(),_data.DrawingExtendedObject=null)},map.on("draw:created",function(event){var layer=event.layer;null==_data.ExtendedType?map.featureGroup.addLayer(layer):map.extendFeatureGroup.addLayer(layer)}),_data.CleanDrawings=function(){_data.CleanDrawingExtendedObject(),_data.DrawingObject&&(_data.DrawingObject.layer&&(_data.DrawingObject.layer._popup=null),_data.DrawingObject.disable&&_data.DrawingObject.disable(),_data.DrawingObject=null,_data.DrawLayer=null,map.clearDrawings())},_data.SetDrawPoint=function(latlng){var pinIcon=L.AwesomeMarkers.icon({icon:"fa-map-pin",markerColor:"orange"});_data.SetDrawLayer(L.marker(latlng,{icon:pinIcon}).addTo(map))},_data.SetDrawLayer=function(layer){_data.DrawLayer=layer,_data.DrawingObject=layer,map.addToDrawings(layer)},_data.SetStyle=function(mapItem,polyStyle,pointStyle){if(mapItem){var tmplayer=mapItem._layers[Object.keys(mapItem._layers)[0]];tmplayer._latlngs?tmplayer.setStyle(polyStyle):tmplayer.setIcon(pointStyle)}};var WatIsHierMarker=null,WatIsHierOriginalMarker=null;_data.CleanMap=function(){_data.CleanDrawings(),_data.CleanWatIsHier(),_data.CleanBuffer(),_data.CleanTempFeatures()},_data.bufferLaag=null,_data.CreateBuffer=function(gisBufferData){var esrigj=esri2geo.toGeoJSON(gisBufferData),gj=new L.GeoJSON(esrigj,{style:Style.BUFFER});return _data.bufferLaag=gj.addTo(map),map.fitBounds(_data.bufferLaag.getBounds()),_data.bufferLaag},_data.CleanBuffer=function(){for(var bufferitem={},x=0;x<_data.VisibleFeatures.length;x++)_data.VisibleFeatures[x].isBufferedItem&&(bufferitem=_data.VisibleFeatures[x],map.removeLayer(bufferitem));var index=_data.VisibleFeatures.indexOf(bufferitem);index>-1&&_data.VisibleFeatures.splice(index,1),_data.bufferLaag&&(map.removeLayer(_data.bufferLaag),_data.bufferLaag=null)},_data.CleanTempFeatures=function(){tempFeatures.forEach(function(tempfeature){map.removeLayer(tempfeature)}),tempFeatures.length=0},_data.GetZoomLevel=function(){return map.getZoom()},_data.GetScale=function(){return Scales[_data.GetZoomLevel()]},_data.CleanWatIsHier=function(){WatIsHierOriginalMarker&&(WatIsHierOriginalMarker.clearAllEventListeners(),WatIsHierOriginalMarker.closePopup(),map.removeLayer(WatIsHierOriginalMarker),WatIsHierOriginalMarker=null),WatIsHierMarker&&(map.removeLayer(WatIsHierMarker),WatIsHierMarker=null)},_data.UpdateDisplayed=function(Themes){var currentScale=_data.GetScale();_data.Themes.forEach(function(theme){theme.Type==ThemeType.ESRI&&theme.UpdateDisplayed(currentScale)})},_data.Apply=function(){console.log("apply"),$rootScope.$applyAsync()},_data.CreateOrigineleMarker=function(latlng,addressFound,straatNaam){if(addressFound){var foundMarker=L.AwesomeMarkers.icon({icon:"fa-map-marker",markerColor:"orange"});WatIsHierOriginalMarker=L.marker([latlng.lat,latlng.lng],{icon:foundMarker,opacity:.5}).addTo(map)}else{var notFoundMarker=L.AwesomeMarkers.icon({icon:"fa-question",markerColor:"red",spin:!0});WatIsHierOriginalMarker=L.marker([latlng.lat,latlng.lng],{icon:notFoundMarker}).addTo(map)}var convertedxy=GisHelperService.ConvertWSG84ToLambert72(latlng),html="",minwidth=0;straatNaam?(html='<div class="container container-low-padding"><div class="row row-no-padding"><div class="col-sm-4" ><a href="http://maps.google.com/maps?q=&layer=c&cbll='+latlng.lat+","+latlng.lng+'" + target="_blank" ><img tink-tooltip="Ga naar streetview" tink-tooltip-align="bottom" src="https://maps.googleapis.com/maps/api/streetview?size=100x50&location='+latlng.lat+","+latlng.lng+'&pitch=-0.76" /></a></div><div class="col-sm-8 mouse-over"><div class="col-sm-12"><b>'+straatNaam+'</b></div><div class="col-sm-3">WGS84:</div><div id="wgs" class="col-sm-8" style="text-align: left;">{{WGS84LatLng}}</div><div class="col-sm-1"><i class="fa fa-files-o mouse-over-toshow" ng-click="CopyWGS()"  tink-tooltip="Coördinaten kopieren naar het klembord" tink-tooltip-align="bottom"  ></i></div><div class="col-sm-3">Lambert:</div><div id="lambert" class="col-sm-8" style="text-align: left;">{{LambertLatLng}}</div><div class="col-sm-1"><i class="fa fa-files-o mouse-over-toshow"  ng-click="CopyLambert()" tink-tooltip="Coördinaten kopieren naar het klembord" tink-tooltip-align="bottom"></i></div></div></div></div>',minwidth=300):(html='<div class="container container-low-padding"><div class="row row-no-padding mouse-over"><div class="col-sm-3">WGS84:</div><div id="wgs" class="col-sm-8 " style="text-align: left;">{{WGS84LatLng}}</div><div class="col-sm-1"><i class="fa fa-files-o mouse-over-toshow" ng-click="CopyWGS()" tink-tooltip="Coördinaten kopieren naar het klembord" tink-tooltip-align="bottom"></i></div><div class="col-sm-3">Lambert:</div><div id="lambert" class="col-sm-8" style="text-align: left;">{{LambertLatLng}}</div><div class="col-sm-1"><i class="fa fa-files-o mouse-over-toshow" ng-click="CopyLambert()" tink-tooltip="Coördinaten kopieren naar het klembord" tink-tooltip-align="bottom"></i></div></div></div>',minwidth=200);var linkFunction=$compile(html),newScope=$rootScope.$new();newScope.LambertLatLng=convertedxy.x.toFixed(1)+", "+convertedxy.y.toFixed(1),newScope.CopyLambert=function(){copyToClipboard("#lambert")},newScope.CopyWGS=function(){copyToClipboard("#wgs")},newScope.WGS84LatLng=latlng.lat.toFixed(6)+", "+latlng.lng.toFixed(6);var domele=linkFunction(newScope)[0],popup=WatIsHierOriginalMarker.bindPopup(domele,{minWidth:minwidth,closeButton:!0}).openPopup();popup.on("popupclose",function(){_data.CleanWatIsHier()})};var copyToClipboard=function(element){var $temp=$("<input>");$("body").append($temp),$temp.val($(element).text()).select(),document.execCommand("copy"),$temp.remove()};_data.CreateDot=function(loc){_data.CleanWatIsHier();var dotIcon=L.icon({iconUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABKVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABUJ5OrAAAAYnRSTlMAAQIEBQYICgsNDg8QERITFxgaGyAhJSYoKS8wMTU2ODk7QkRPVFVXXV5fYWJkZ2lrbHF3eHyAg4aMjpSXmJ6jpqirra+wsrS3ucDByszP0dPc3uDi5Obo6evt7/P19/n7/fGWhfoAAAERSURBVBgZXcGHIoJhGIbh5+uXZO+sZK/slZ0tMwkhwn3+B+HtrxTXpapgKOj0n4slC8DX+binWrEcFe8T+uV2qXXhqcSdYvYGmurD/Ylv4M6TLwGk21QSugROVBQBjgKqcFvAmMwNPHiqclfwEpC6gB4VRdeWumQagai0CLcy7hwzK7MPe9IFzMjE8XVKisGr9AyDMhl8C5LagYA+ISLzhm9VUjPgKQvDMtv4hiR1Ak5JWJFpyGPOZMYhI03Bo4oadvKZuJNJwabUDIyqVjfQK+kICmFV1T1BWqYVuA+rIpgCIiqaBD5GVNKXAzZUso7JLkcjQ3NpzIFT2RS11lTVdkzFdbf+aJk+zH4+n813qOwHxGRbFJ0DoNgAAAAASUVORK5CYII=",iconSize:[24,24]});WatIsHierMarker=L.marker([loc.x,loc.y],{icon:dotIcon}).addTo(map)},_data.CleanSearch=function(){ResultsData.CleanSearch();for(var bufferitem=null,x=0;x<_data.VisibleFeatures.length;x++)_data.VisibleFeatures[x].isBufferedItem?bufferitem=_data.VisibleFeatures[x]:map.removeLayer(_data.VisibleFeatures[x]);_data.VisibleFeatures.length=0,bufferitem&&_data.VisibleFeatures.push(bufferitem)},_data.PanToPoint=function(loc){map.setView(L.latLng(loc.x,loc.y),12)},_data.PanToFeature=function(feature){console.log("PANNING TO FEATURE");var featureBounds=feature.getBounds();map.fitBounds(featureBounds)},_data.PanToItem=function(item){var geojsonitem=item.toGeoJSON();geojsonitem.features&&(geojsonitem=geojsonitem.features[0]),"Point"==geojsonitem.geometry.type?_data.PanToPoint({x:geojsonitem.geometry.coordinates[1],y:geojsonitem.geometry.coordinates[0]}):_data.PanToFeature(item)},_data.GoToLastClickBounds=function(){map.fitBounds(_data.LastIdentifyBounds,{paddingTopLeft:L.point(0,0),paddingBottomRight:L.point(0,0)})},_data.SetZIndexes=function(){var counter=_data.Themes.length+3;_data.Themes.forEach(function(theme){theme.MapData.ZIndex=counter,theme.Type==ThemeType.ESRI?theme.MapData._currentImage&&(theme.MapData._currentImage._image.style.zIndex=counter):(theme.MapData.bringToFront(),theme.MapData.setZIndex(counter)),counter--})};var tempFeatures=[];return _data.AddTempFeatures=function(featureCollection){featureCollection.features.forEach(function(feature){var mapItem=L.geoJson(feature,{style:Style.DEFAULT}).addTo(map);_data.PanToFeature(mapItem),tempFeatures.push(mapItem)})},_data.processedFeatureArray=[],_data.AddFeatures=function(features,theme,layerId){if(features&&0!=features.features.length){ResultsData.EmptyResult=!1;var featureArray=_data.GetResultsData(features,theme,layerId);null==_data.ExtendedType?featureArray.forEach(function(featureItem){ResultsData.JsonFeatures.push(featureItem)}):_data.processedFeatureArray=featureArray.concat(_data.processedFeatureArray)}else ResultsData.EmptyResult=!0;$rootScope.$applyAsync()},_data.ConfirmExtendDialog=function(){var featureArray=_data.processedFeatureArray;if(0==featureArray.length)_data.TempExtendFeature=[],_data.ExtendedType=null,_data.CleanDrawingExtendedObject(),swal({title:"Oeps!",text:"Geen resultaten met de nieuwe selectie",type:"warning",showCancelButton:!1,confirmButtonColor:"#DD6B55",confirmButtonText:"Ok",closeOnConfirm:!0});else{var dialogtext="Selectie verwijderen?";"add"==_data.ExtendedType&&(dialogtext="Selectie toevoegen?"),swal({title:dialogtext,cancelButtonText:"Ja",confirmButtonText:"Nee",showCancelButton:!0,confirmButtonColor:"#b9b9b9",customClass:"leftsidemodal",closeOnConfirm:!0},function(isConfirm){isConfirm?_data.TempExtendFeatures.forEach(function(x){map.removeLayer(x)}):"add"==_data.ExtendedType?(_data.TempExtendFeatures.forEach(function(x){var item=x.setStyle(Style.DEFAULT);_data.VisibleFeatures.push(item)}),featureArray.forEach(function(featureItem){ResultsData.JsonFeatures.push(featureItem)})):"remove"==_data.ExtendedType&&(featureArray.forEach(function(featureItem){SearchService.DeleteFeature(featureItem);var itemIndex=_data.VisibleFeatures.findIndex(function(x){return x.toGeoJSON().features[0].id==featureItem.id&&x.toGeoJSON().features[0].layerName==featureItem.layerName});itemIndex>-1&&_data.VisibleFeatures.splice(itemIndex,1)}),_data.TempExtendFeatures.forEach(function(x){map.removeLayer(x)})),_data.TempExtendFeatures=[],_data.ExtendedType=null,_data.processedFeatureArray=[],_data.CleanDrawingExtendedObject()})}},_data.SetDisplayValue=function(featureItem,layer){if(featureItem.displayValue=featureItem.properties[layer.displayField],!featureItem.displayValue){var displayFieldProperties=layer.fields.find(function(x){return x.name==layer.displayField});displayFieldProperties&&featureItem.properties[displayFieldProperties.alias]?featureItem.displayValue=featureItem.properties[displayFieldProperties.alias]:featureItem.displayValue="LEEG"}""==featureItem.displayValue.toString().trim()&&(featureItem.displayValue="LEEG")},_data.SetFieldsData=function(featureItem,layer){layer.fields.forEach(function(field){if(null==featureItem.properties[field.name]&&(featureItem.properties[field.name]=""),"esriFieldTypeDate"==field.type&&"number"==typeof featureItem.properties[field.name]){var date=new Date(featureItem.properties[field.name]),date_string=date.getDate()+"/"+(date.getMonth()+1)+"/"+date.getFullYear();featureItem.properties[field.name]=date_string}}),_data.SetDisplayValue(featureItem,layer)},_data.GetResultsData=function(features,theme,layerId){for(var buffereditem=_data.VisibleFeatures.find(function(x){return x.isBufferedItem}),resultArray=[],x=0;x<features.features.length;x++){var featureItem=features.features[x],layer={};if(null!=featureItem.layerId?layer=theme.AllLayers.find(function(x){return x.id===featureItem.layerId}):null!=layerId?layer=theme.AllLayers.find(function(x){return x.id===layerId}):console.log("NO LAYER ID WAS GIVEN EITHER FROM FEATURE ITEM OR FROM PARAMETER"),
featureItem.theme=theme,featureItem.layerName=layer.name,theme.Type===ThemeType.ESRI){var checkforitem=function checkforitem(){layer.fields?_data.SetFieldsData(featureItem,layer):$timeout(checkforitem,100)};checkforitem();var thestyle=Style.DEFAULT;if("add"==_data.ExtendedType){thestyle=Style.ADD;var alreadyexists=_data.VisibleFeatures.some(function(x){return x.toGeoJSON().features[0].id==featureItem.id&&x.toGeoJSON().features[0].layerName==featureItem.layerName});if(!alreadyexists){var mapItem=L.geoJson(featureItem,{style:thestyle}).addTo(map);_data.TempExtendFeatures.push(mapItem),featureItem.mapItem=mapItem,resultArray.push(featureItem)}}else if("remove"==_data.ExtendedType){thestyle=Style.REMOVE;var alreadyexists=_data.VisibleFeatures.some(function(x){return x.toGeoJSON().features[0].id==featureItem.id&&x.toGeoJSON().features[0].layerName==featureItem.layerName});if(alreadyexists){var mapItem=L.geoJson(featureItem,{style:thestyle}).addTo(map);_data.TempExtendFeatures.push(mapItem),featureItem.mapItem=mapItem,resultArray.push(featureItem)}}else{if(buffereditem){var bufferid=buffereditem.toGeoJSON().features[0].id,bufferlayer=buffereditem.toGeoJSON().features[0].layer;if(bufferid&&bufferid==featureItem.id&&bufferlayer==featureItem.layer)featureItem.mapItem=buffereditem;else{var mapItem=L.geoJson(featureItem,{style:Style.DEFAULT}).addTo(map);featureItem.mapItem=mapItem,_data.VisibleFeatures.push(mapItem)}}else{var mapItem=L.geoJson(featureItem,{style:thestyle}).addTo(map);_data.VisibleFeatures.push(mapItem),featureItem.mapItem=mapItem}resultArray.push(featureItem)}}else resultArray.push(featureItem),featureItem.displayValue=featureItem.properties[Object.keys(featureItem.properties)[0]]}return resultArray},_data};module.$inject=["ResultsData","FeatureService","SearchService"],module.factory("MapData",mapData)}(),function(){var module=angular.module("tink.gis"),mapEvents=function(map,MapService,MapData,UIService,$rootScope){var _mapEvents={};map.on("draw:drawstart",function(event){console.log("draw started"),MapData.IsDrawing=!0}),map.on("draw:drawstop",function(event){console.log("draw stopped"),MapData.IsDrawing=!1,$rootScope.$applyAsync(function(){MapData.DrawingType=DrawingOption.GEEN})});var berekendAfstand=function(arrayOfPoints){for(var totalDistance=0,x=0;x!=arrayOfPoints.length-1;x++){var currpoint=arrayOfPoints[x],nextpoint=arrayOfPoints[x+1];totalDistance+=currpoint.distanceTo(nextpoint)}return totalDistance.toFixed(2)},berkenOmtrek=function(arrayOfPoints){for(var totalDistance=0,x=0;x!=arrayOfPoints.length;x++){var currpoint=arrayOfPoints[x];if(x==arrayOfPoints.length-1)var nextpoint=arrayOfPoints[0];else var nextpoint=arrayOfPoints[x+1];totalDistance+=currpoint.distanceTo(nextpoint)}return totalDistance.toFixed(2)};map.on("zoom",function(event){console.log("Zoomend!!!"),MapData.UpdateDisplayed(),MapData.Apply()}),_mapEvents.removeCursorAuto=function(){$(".leaflet-container").hasClass("cursor-auto")&&$(".leaflet-container").removeClass("cursor-auto")},map.on("click",function(event){if(event.originalEvent instanceof MouseEvent)if(console.log("click op map! Is drawing: "+MapData.IsDrawing),MapData.IsDrawing)switch(console.log("DrawingObject: "),console.log(MapData.DrawingObject),MapData.DrawingType){case DrawingOption.AFSTAND:break;case DrawingOption.OPPERVLAKTE:break;default:console.log("Aant drawen zonder een gekent type!!!!!!")}else switch(MapData.ActiveInteractieKnop){case ActiveInteractieButton.IDENTIFY:MapData.CleanMap(),MapData.LastIdentifyBounds=map.getBounds(),MapService.Identify(event,3),UIService.OpenLeftSide(),$rootScope.$applyAsync(function(){MapData.ActiveInteractieKnop=ActiveInteractieButton.GEEN}),_mapEvents.removeCursorAuto();break;case ActiveInteractieButton.SELECT:MapData.DrawingType!=DrawingOption.GEEN&&null==MapData.ExtendedType&&(MapData.CleanMap(),MapData.CleanSearch()),MapData.DrawingType===DrawingOption.NIETS&&(MapService.Select(event),null===MapData.ExtendedType&&MapData.SetDrawPoint(event.latlng),UIService.OpenLeftSide(),_mapEvents.removeCursorAuto(),$rootScope.$applyAsync(function(){MapData.DrawingType=DrawingOption.GEEN,MapData.ShowDrawControls=!1,MapData.ActiveInteractieKnop=ActiveInteractieButton.GEEN}));break;case ActiveInteractieButton.WATISHIER:MapData.CleanWatIsHier(),MapService.WatIsHier(event),$rootScope.$applyAsync(function(){MapData.ActiveInteractieKnop=ActiveInteractieButton.GEEN,_mapEvents.removeCursorAuto()});break;case ActiveInteractieButton.METEN:break;case ActiveInteractieButton.GEEN:break;default:console.log("MAG NIET!!!!!!!!")}}),map.on("draw:created",function(e){switch(console.log("draw created"),MapData.ActiveInteractieKnop){case ActiveInteractieButton.SELECT:null==MapData.ExtendedType&&(MapData.DrawLayer=e.layer),MapService.Query(e.layer),UIService.OpenLeftSide();break;case ActiveInteractieButton.METEN:switch(MapData.DrawingType){case DrawingOption.AFSTAND:var afstand=berekendAfstand(e.layer._latlngs),popup=e.layer.bindPopup("Afstand (m): "+afstand+" ");popup.on("popupclose",function(event){map.removeLayer(e.layer)}),e.layer.openPopup();break;case DrawingOption.OPPERVLAKTE:var omtrek=berkenOmtrek(e.layer._latlngs[0]),popuptekst="<p>Opp  (m<sup>2</sup>): "+LGeo.area(e.layer).toFixed(2)+"</p><p>Omtrek (m): "+omtrek+" </p>",popup=e.layer.bindPopup(popuptekst);popup.on("popupclose",function(event){map.removeLayer(e.layer)}),e.layer.openPopup()}break;default:console.log("MAG NIET!!!!!!!!")}$rootScope.$applyAsync(function(){MapData.DrawingType=DrawingOption.GEEN,MapData.ShowDrawControls=!1,MapData.ShowMetenControls=!1,MapData.ActiveInteractieKnop=ActiveInteractieButton.GEEN}),MapData.IsDrawing=!1});var gpsmarker=null;return _mapEvents.ClearGPS=function(){gpsmarker&&gpsmarker.removeFrom(map)},map.on("locationerror",function(e){console.log("LOCATIONERROR",e)}),_mapEvents};module.$inject=["map","MapService","MapData","UIService","$rootScope"],module.factory("MapEvents",mapEvents)}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj};!function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","tink.modal"])}var mapService=function($rootScope,MapData,map,ThemeCreater,$q,GISService,ResultsData,GisHelperService,PopupService){var _mapService={};return _mapService.MaxFeatures=1e3,_mapService.getJsonFromXML=function(data){var json=null;"string"!=typeof data&&(data=JXON.xmlToString(data));var returnjson=JXON.stringToJs(data);return returnjson.featureinforesponse&&(json=returnjson.featureinforesponse.fields),json},_mapService.getJsonFromPlain=function(data){var json=null,splittedtext=data.trim().split("--------------------------------------------"),contenttext=null;if(splittedtext.length>=2){contenttext=splittedtext[1];var splittedcontent=contenttext.trim().split(/\n|\r/g);splittedcontent.length>0&&(json={}),splittedcontent.forEach(function(line){var splittedline=line.split("=");json[splittedline[0].trim()]=splittedline[1].trim()})}return json},_mapService.Identify=function(event,tolerance){MapData.CleanSearch(),"undefined"==typeof tolerance&&(tolerance=3),_.each(MapData.Themes,function(theme){var identifOnThisTheme=!0;if((0===theme.VisibleLayerIds.length||1===theme.VisibleLayerIds.length&&theme.VisibleLayerIds[0]===-1)&&(identifOnThisTheme=!1),identifOnThisTheme)switch(theme.Type){case ThemeType.ESRI:var visanddisplayedlayers=theme.VisibleAndDisplayedLayerIds,layersVoorIdentify="all:"+visanddisplayedlayers;0==visanddisplayedlayers.length&&(layersVoorIdentify="visible:-1"),ResultsData.RequestStarted++,theme.MapData.identify().on(map).at(event.latlng).layers(layersVoorIdentify).tolerance(tolerance).run(function(error,featureCollection){ResultsData.RequestCompleted++,MapData.AddFeatures(featureCollection,theme)});break;case ThemeType.WMS:var layersVoorIdentify=theme.VisibleLayerIds;theme.VisibleLayers.forEach(function(lay){console.log(lay),1==lay.queryable&&(ResultsData.RequestStarted++,theme.MapData.getFeatureInfo(event.latlng,lay.name,theme.GetFeatureInfoType).success(function(data,status,xhr){data&&(data=GisHelperService.UnwrapProxiedData(data)),ResultsData.RequestCompleted++;var processedjson=null;switch(theme.GetFeatureInfoType){case"text/xml":processedjson=_mapService.getJsonFromXML(data);break;case"text/plain":processedjson=_mapService.getJsonFromPlain(data)}var returnitem={type:"FeatureCollection",features:[]};if(processedjson){var featureArr=[];"object"===("undefined"==typeof processedjson?"undefined":_typeof(processedjson))?featureArr.push(processedjson):featureArr=processedjson,featureArr.forEach(function(feat){var tmpitem={layerName:lay.name,name:lay.name,layerId:lay.name,properties:feat,type:"Feature"};returnitem.features.push(tmpitem)}),console.log(lay.name+" item info: "),console.log(returnitem),MapData.AddFeatures(returnitem,theme)}else $rootScope.$applyAsync()}).error(function(exception){ResultsData.RequestCompleted++}))});break;default:console.log("UNKNOW TYPE!!!!:"),console.log(Theme.Type)}})},_mapService.IdentifyProm=function(theme,latlng,layerids){var promise=new Promise(function(resolve,reject){ResultsData.RequestStarted++,theme.MapData.identify().on(map).layers("visible: "+layerids).at(latlng).run(function(error,featureCollection,response){ResultsData.RequestCompleted++,resolve({error:error,featureCollection:featureCollection,response:response})})});return promise},_mapService.Select=function(event){if(console.log(event),""===MapData.SelectedLayer.id){var allproms=[];MapData.Themes.filter(function(x){return x.Type==ThemeType.ESRI}).forEach(function(theme){if(0!==theme.VisibleLayerIds.length&&theme.VisibleLayerIds[0]!==-1){var prom=_mapService.IdentifyProm(theme,event.latlng,theme.VisibleLayerIds);allproms.push(prom),-prom.then(function(arg){MapData.AddFeatures(arg.featureCollection,theme)})}}),null!=MapData.ExtendedType&&Promise.all(allproms).then(function(results){MapData.ConfirmExtendDialog(MapData.processedFeatureArray),MapData.processedFeatureArray=[]})}else ResultsData.RequestStarted++,MapData.SelectedLayer.theme.MapData.identify().on(map).at(event.latlng).layers("visible: "+MapData.SelectedLayer.id).run(function(error,featureCollection){ResultsData.RequestCompleted++,MapData.AddFeatures(featureCollection,MapData.SelectedLayer.theme),null!=MapData.ExtendedType&&(MapData.ConfirmExtendDialog(MapData.processedFeatureArray),MapData.processedFeatureArray=[])})},_mapService.LayerQuery=function(theme,layerid,geometry){var promise=new Promise(function(resolve,reject){ResultsData.RequestStarted++,theme.MapDataWithCors.query().layer(layerid).intersects(geometry).run(function(error,featureCollection,response){ResultsData.RequestCompleted++,resolve({error:error,featureCollection:featureCollection,response:response})})});return promise},_mapService.LayerQueryCount=function(theme,layerid,geometry){var promise=new Promise(function(resolve,reject){ResultsData.RequestStarted++,theme.MapDataWithCors.query().layer(layerid).intersects(geometry).count(function(error,count,response){ResultsData.RequestCompleted++,resolve({error:error,count:count,response:response})})});return promise},_mapService.Query=function(box,layer){if(layer||(layer=MapData.SelectedLayer),layer&&""!==layer.id){var prom=_mapService.LayerQueryCount(layer.theme,layer.id,box);prom.then(function(arg){if(arg.count<=_mapService.MaxFeatures){var prom=_mapService.LayerQuery(layer.theme,layer.id,box);prom.then(function(arg){MapData.AddFeatures(arg.featureCollection,layer.theme,layer.id),null!=MapData.ExtendedType&&(MapData.ConfirmExtendDialog(MapData.processedFeatureArray),MapData.processedFeatureArray=[])})}else PopupService.Warning("U selecteerde "+arg.count+" resultaten.","Om een vlotte werking te garanderen is het maximum is ingesteld op "+_mapService.MaxFeatures)})}else{var featureCount=0,allcountproms=[];MapData.Themes.forEach(function(theme){theme.Type===ThemeType.ESRI&&theme.VisibleLayers.forEach(function(lay){var layerCountProm=_mapService.LayerQueryCount(theme,lay.id,box);layerCountProm.then(function(arg){featureCount+=arg.count}),allcountproms.push(layerCountProm)})}),Promise.all(allcountproms).then(function(results){if(console.log(results,featureCount),featureCount<=_mapService.MaxFeatures){var allproms=[];MapData.Themes.forEach(function(theme){theme.Type===ThemeType.ESRI&&theme.VisibleLayers.forEach(function(lay){var prom=_mapService.LayerQuery(theme,lay.id,box);allproms.push(prom),prom.then(function(arg){MapData.AddFeatures(arg.featureCollection,theme,lay.id)})})}),null!=MapData.ExtendedType&&Promise.all(allproms).then(function(results){MapData.ConfirmExtendDialog(MapData.processedFeatureArray),MapData.processedFeatureArray=[]})}else PopupService.Warning("U selecteerde "+featureCount+" resultaten.","Om een vlotte werking te garanderen is het maximum is ingesteld op "+_mapService.MaxFeatures)})}},_mapService.WatIsHier=function(event){var prom=GISService.ReverseGeocode(event);prom.success(function(data,status,headers,config){if(MapData.CleanWatIsHier(),data.error)MapData.CreateOrigineleMarker(event.latlng,!1);else{var converted=GisHelperService.ConvertLambert72ToWSG84(data.location);MapData.CreateDot(converted),MapData.CreateOrigineleMarker(event.latlng,!0,data.address.Street+" ("+data.address.Postal+")")}}).error(function(data,status,headers,config){console.log(data,status,headers,config)})},_mapService.FindAdvanced=function(themeName,layerName,field,parameter){var prom=$q.defer(),theme=MapData.Themes.find(function(x){return x.Naam==themeName});if(!theme)throw"No loaded theme found with the name: "+themeName;var layer=theme.AllLayers.find(function(x){return x.name==layerName});if(!layer)throw"No layer found with the name: "+layerName+" on the theme with name: "+themeName;return ResultsData.RequestStarted++,theme.MapData.find().fields(field).layers(layer.id).text(parameter).run(function(error,featureCollection,response){error?prom.reject(error):(prom.resolve(featureCollection,response),ResultsData.RequestCompleted++,MapData.AddFeatures(featureCollection,theme,layer.id))}),prom.promise},_mapService.Find=function(query){MapData.CleanSearch(),MapData.SelectedFindLayer&&""===MapData.SelectedFindLayer.id?MapData.Themes.forEach(function(theme){theme.Type===ThemeType.ESRI&&theme.VisibleLayers.forEach(function(lay){ResultsData.RequestStarted++,theme.MapData.find().fields(lay.displayField).layers(lay.id).text(query).run(function(error,featureCollection,response){ResultsData.RequestCompleted++,MapData.AddFeatures(featureCollection,theme,lay.id)})})}):(ResultsData.RequestStarted++,MapData.SelectedFindLayer.theme.MapData.find().fields(MapData.SelectedFindLayer.displayField).layers(MapData.SelectedFindLayer.id).text(query).run(function(error,featureCollection,response){ResultsData.RequestCompleted++,MapData.AddFeatures(featureCollection,MapData.SelectedFindLayer.theme,MapData.SelectedFindLayer.id)}))},_mapService};module.$inject=["$rootScope","MapData","map","ThemeCreater","$q","GISService","ResultsData","GisHelperService","PopupService"],module.factory("MapService",mapService)}(),function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","tink.modal"])}var popupService=function(){var _popupService={};return _popupService.Init=function(){toastr.options.timeOut=0,toastr.options.extendedTimeOut=0,toastr.options.closeButton=!0}(),_popupService.popupGenerator=function(type,title,message,callback,options){var messagetype=type.toLowerCase().trim();if("error"!=messagetype&&"warning"!=messagetype&&"info"!=messagetype&&"success"!=messagetype)throw"Invalid toastr type(info, error, warning,  success): "+messagetype;options||(options={}),options.timeOut||(options.timeOut=3e3),options.extendedTimeOut||(options.extendedTimeOut=0),callback&&(options.onclick=callback),toastr[messagetype](message,title,options)},_popupService.ExceptionFunc=function(exception){console.log(exception)},_popupService.ErrorWithException=function(title,message,exception,options){var callback=function(){_popupService.ExceptionFunc(exception)};_popupService.Error(title,message,callback,options)},_popupService.ErrorFromHttp=function(data,status,url){_popupService.ErrorFromHTTP(data,status,url)},_popupService.ErrorFromHTTP=function(data,status,url){status||(status=data.code);var title="HTTP error ("+status+")",baseurl=url.split("/").slice(0,3).join("/"),message="Fout met het navigeren naar url: "+baseurl,exception={url:url,status:status,data:data},callback=function(){_popupService.ExceptionFunc(exception)};_popupService.Error(title,message,callback)},_popupService.Error=function(title,message,callback,options){_popupService.popupGenerator("Error",title,message+"\nKlik hier om te melden.",callback,options)},_popupService.Warning=function(title,message,callback,options){_popupService.popupGenerator("Warning",title,message,callback,options)},_popupService.Info=function(title,message,callback,options){_popupService.popupGenerator("Info",title,message,callback,options)},_popupService.Success=function(title,message,callback,options){options||(options={}),options.closeButton||(options.closeButton=!1),_popupService.popupGenerator("Success",title,message,callback,options)},_popupService};module.factory("PopupService",popupService)}(),function(){var module=angular.module("tink.gis"),service=function(map,ThemeCreater,MapData,GISService){var _service={};return _service.AddAndUpdateThemes=function(themesBatch){console.log("Themes batch for add and updates..."),console.log(themesBatch),themesBatch.forEach(function(theme){var existingTheme=MapData.Themes.find(function(x){return x.cleanUrl==theme.cleanUrl});switch(console.log("addorupdate or del theme, ",theme,theme.status),theme.status){case ThemeStatus.NEW:theme.Type==ThemeType.ESRI&&(GISService.GetAditionalLayerInfo(theme),theme.UpdateDisplayed(MapData.GetScale())),_service.AddNewTheme(theme);break;case ThemeStatus.DELETED:_service.DeleteTheme(existingTheme);break;case ThemeStatus.UNMODIFIED:break;case ThemeStatus.UPDATED:_service.UpdateTheme(theme,existingTheme),_service.UpdateThemeVisibleLayers(existingTheme);break;default:console.log("Er is iets fout, status niet bekend!!!: "+theme.status)}theme.status=ThemeStatus.UNMODIFIED}),console.log("refresh of sortableThemes"),$("#sortableThemes").sortable("refresh"),MapData.SetZIndexes()},_service.UpdateThemeVisibleLayers=function(theme){MapData.ResetVisibleLayers(),theme.UpdateMap(map)},_service.UpdateTheme=function(updatedTheme,existingTheme){for(var x=0;x<updatedTheme.AllLayers.length;x++){var updatedLayer=updatedTheme.AllLayers[x],existingLayer=existingTheme.AllLayers[x];updatedLayer.enabled&&updatedLayer.visible?(existingTheme.Type==ThemeType.ESRI&&MapData.VisibleLayers.indexOf(existingLayer)==-1&&MapData.VisibleLayers.push(existingLayer),existingTheme.VisibleLayers.indexOf(existingLayer)==-1&&existingTheme.VisibleLayers.push(existingLayer)):(existingTheme.Type==ThemeType.ESRI&&MapData.VisibleLayers.indexOf(existingLayer)!=-1&&MapData.VisibleLayers.splice(MapData.VisibleLayers.indexOf(existingLayer),1),existingTheme.VisibleLayers.indexOf(existingLayer)!=-1&&existingTheme.VisibleLayers.splice(existingTheme.VisibleLayers.indexOf(existingLayer),1)),existingLayer.enabled=updatedLayer.enabled,existingLayer.visible=updatedLayer.visible}},_service.AddNewTheme=function(theme){switch(MapData.Themes.unshift(theme),theme.Type==ThemeType.ESRI&&(MapData.VisibleLayers=MapData.VisibleLayers.concat(theme.VisibleLayers)),theme.Type){case ThemeType.ESRI:var visLayerIds=theme.VisibleLayerIds;0==visLayerIds.length&&visLayerIds.push(-1),null!==theme.Opacity&&void 0!==theme.Opacity||(theme.Opacity=1),theme.MapData=L.esri.dynamicMapLayer({maxZoom:20,minZoom:0,url:theme.cleanUrl,opacity:theme.Opacity,layers:visLayerIds,continuousWorld:!0,useCors:!1,f:"image"}).addTo(map),theme.MapDataWithCors=L.esri.dynamicMapLayer({maxZoom:20,minZoom:0,url:theme.cleanUrl,opacity:1,layers:visLayerIds,continuousWorld:!0,useCors:!0,f:"image"}),theme.MapData.on("authenticationrequired",function(e){serverAuth(function(error,response){e.authenticate(response.token)})}),theme.MapData.on("load",function(e){theme.MapData._currentImage&&(theme.MapData._currentImage._image.style.zIndex=theme.MapData.ZIndex,console.log("Zindex on "+theme.Naam+" set to "+theme.MapData.ZIndex))});break;case ThemeType.WMS:theme.MapData=L.tileLayer.betterWms(theme.cleanUrl,{maxZoom:20,minZoom:0,format:"image/png",layers:theme.VisibleLayerIds.join(","),transparent:!0,continuousWorld:!0,useCors:!0}).addTo(map),theme.MapData.on("load",function(e){console.log("LOAD VAN "+theme.Naam),console.log(theme.MapData),theme.MapData._container.childNodes&&([].slice.call(theme.MapData._container.childNodes).forEach(function(imgNode){imgNode.style.zIndex=theme.MapData.ZIndex}),console.log("Zindex on "+theme.Naam+" set to "+theme.MapData.ZIndex))});break;default:console.log("UNKNOW TYPE")}},_service.CleanThemes=function(){for(;0!=MapData.Themes.length;)console.log("DELETING THIS THEME",MapData.Themes[0]),_service.DeleteTheme(MapData.Themes[0])},_service.DeleteTheme=function(theme){map.removeLayer(theme.MapData);var themeIndex=MapData.Themes.indexOf(theme);themeIndex>-1&&MapData.Themes.splice(themeIndex,1),theme.VisibleLayers.forEach(function(visLayer){var visLayerIndex=MapData.VisibleLayers.indexOf(visLayer);visLayerIndex>-1&&MapData.VisibleLayers.splice(visLayerIndex,1)}),MapData.CleanSearch()},_service};module.$inject=["map","ThemeCreater","MapData","GISService"],module.factory("ThemeService",service)}(),function(){var module=angular.module("tink.gis"),typeAheadService=function(map,GISService,MapData,GisHelperService){var _typeAheadService={};_typeAheadService.init=function(){L.control.typeahead({minLength:3,highlight:!0,classNames:{open:"is-open",empty:"is-empty"}},{async:!0,limit:99,display:"name",displayKey:"name",source:function(query,syncResults,asyncResults){if(query.replace(/[^0-9]/g,"").length<6){var splitquery=query.split(" "),numbers=splitquery.filter(function(x){return isCharDigit(x[0])}),notnumbers=splitquery.filter(function(x){return!isCharDigit(x[0])});if(1==numbers.length&&notnumbers.length>=1){var huisnummer=numbers[0],straatnaam=notnumbers.join(" ");console.log(straatnaam,huisnummer),GISService.QueryCrab(straatnaam,huisnummer).then(function(data){console.log(data);var features=data.features.map(function(feature){var obj={};return obj.straatnaam=feature.attributes.STRAATNM,obj.huisnummer=feature.attributes.HUISNR,obj.id=feature.attributes.OBJECTID,obj.x=feature.geometry.x,obj.y=feature.geometry.y,obj.name=(obj.straatnaam+" "+obj.huisnummer).trim(),obj}).slice(0,10);console.log(features),asyncResults(features)})}else GISService.QuerySOLRLocatie(query.trim()).then(function(data){var arr=data.response.docs;asyncResults(arr)})}else syncResults([]),zoekXY(query)},templates:{suggestion:suggestionfunc,notFound:['<div class="empty-message"><b>Geen resultaten gevonden</b></div>'],empty:['<div class="empty-message"><b>Zoek naar straten, POI en districten</b></div>']}},{placeholder:"Geef een X,Y / locatie of POI in.","typeahead:select":function(ev,suggestion){if(MapData.CleanWatIsHier(),MapData.CleanTempFeatures(),suggestion.x&&suggestion.y){var cors={x:suggestion.x,y:suggestion.y},xyWGS84=GisHelperService.ConvertLambert72ToWSG84(cors);setViewAndPutDot(xyWGS84)}else{var idsplitted=suggestion.id.split("/"),layerid=idsplitted[3];QueryForTempFeatures(layerid,"ObjectID="+suggestion.key)}}}).addTo(map),$(".typeahead").on("keyup",function(e){if(13==e.which&&1==$(".tt-suggestion").length){var firstsug=$(".tt-suggestion:first-child");firstsug.trigger("click")}})};var zoekXY=function(search){search=search.trim();var WGS84Check=GisHelperService.getWGS84CordsFromString(search);if(WGS84Check.hasCordinates)setViewAndPutDot(WGS84Check);else{var lambertCheck=GisHelperService.getLambartCordsFromString(search);if(lambertCheck.hasCordinates){var xyWGS84=GisHelperService.ConvertLambert72ToWSG84({x:lambertCheck.x,y:lambertCheck.y});setViewAndPutDot(xyWGS84)}else console.log("NIET GEVONDEN")}},QueryForTempFeatures=function(layerid,where){locatieMapData.query().layer(layerid).where(where).run(function(error,featureCollection,response){error?console.log("ERRRORRRRRRRRRRR",error):(console.log(error,featureCollection,response),MapData.AddTempFeatures(featureCollection))})},locatieMapData=L.esri.dynamicMapLayer({maxZoom:20,minZoom:0,url:Gis.LocatieUrl,opacity:1,layers:0,continuousWorld:!0,useCors:!1}),isCharDigit=function(n){return" "!=n&&n>-1},suggestionfunc=function(item){var output="<div>"+item.name;return item.attribute1value&&(output+="<p>"+item.attribute1name+": "+item.attribute1value+"</p>"),item.attribute2value&&(output+="<p>"+item.attribute2name+": "+item.attribute2value+"</p>"),item.layer&&(output+="<p>Laag: "+item.layer+"</p>"),output+="</div>"},setViewAndPutDot=function(loc){MapData.PanToPoint(loc),MapData.CreateDot(loc)};return _typeAheadService};module.factory("TypeAheadService",typeAheadService)}(),function(){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter","tink.pagination"])}var service=function(){var _service={};return _service.OpenLeftSide=function(){var html=$("html");html.hasClass("nav-left-open")||html.addClass("nav-left-open")},_service.CloseLeftSide=function(){var html=$("html");html.hasClass("nav-left-open")&&html.removeClass("nav-left-open")},_service.OpenRightSide=function(){var html=$("html");html.hasClass("nav-right-open")||html.addClass("nav-right-open")},_service.CloseRightSide=function(){var html=$("html");html.hasClass("nav-right-open")&&html.removeClass("nav-right-open")},_service};module.factory("UIService",service)}(),function(module){var module;try{module=angular.module("tink.gis")}catch(e){module=angular.module("tink.gis",["tink.accordion","tink.tinkApi","ui.sortable","tink.modal","angular.filter"])}module.controller("BufferController",["$scope","$modalInstance","MapData",function($scope,$modalInstance,MapData){$scope.buffer=MapData.LastBufferedDistance,$scope.SelectableLayers=angular.copy(MapData.VisibleLayers),$scope.SelectableLayers.shift();var bufferDefault=MapData.LastBufferedLayer||MapData.DefaultLayer;if(bufferDefault){var selectedLayer=$scope.SelectableLayers.find(function(x){return x.name==bufferDefault.name});selectedLayer?$scope.selectedLayer=selectedLayer:$scope.selectedLayer=$scope.SelectableLayers[0]}else $scope.selectedLayer=$scope.SelectableLayers[0];$scope.ok=function(){MapData.LastBufferedDistance=$scope.buffer,MapData.LastBufferedLayer=$scope.selectedLayer,$modalInstance.$close({buffer:$scope.buffer,layer:$scope.selectedLayer})},$scope.cancel=function(){$modalInstance.$dismiss("cancel is pressed")}}])}(),function(module){module=angular.module("tink.gis");var theController=module.controller("searchController",function($scope,ResultsData,map,$interval){var vm=this;vm.features=ResultsData.JsonFeatures,vm.EmptyResult=ResultsData.EmptyResult,vm.LoadingCompleted=!0,vm.loadingPercentage=100;$interval(function(){vm.loadingPercentage=ResultsData.GetRequestPercentage(),vm.LoadingCompleted=vm.loadingPercentage>=100},333);vm.asidetoggle=function(){if(L.Browser.mobile){var html=$("html");html.hasClass("nav-right-open")&&html.removeClass("nav-right-open")}}});theController.$inject=["$scope","ResultsData","map","$interval"]}(),function(module){module=angular.module("tink.gis");var theController=module.controller("searchResultsController",function($scope,ResultsData,map,SearchService,MapData,FeatureService,$modal,GeometryService){var vm=this;vm.features=ResultsData.JsonFeatures,vm.featureLayers=null,vm.selectedResult=null,vm.layerGroupFilter="geenfilter",vm.collapsestatepergroup={},vm.drawLayer=null,$scope.$watchCollection(function(){return ResultsData.JsonFeatures},function(newValue,oldValue){vm.featureLayers=_.uniq(_.map(vm.features,"layerName")),vm.featureLayers.forEach(function(lay){void 0!==vm.collapsestatepergroup[lay]&&null!==vm.collapsestatepergroup[lay]||(vm.collapsestatepergroup[lay]=!1)}),vm.layerGroupFilter="geenfilter"}),$scope.$watch(function(){return ResultsData.SelectedFeature},function(newVal,oldVal){vm.selectedResult=newVal}),$scope.$watch(function(){return MapData.DrawLayer},function(newdrawobject,oldVal){newdrawobject?vm.drawLayer=newdrawobject:vm.drawLayer=null}),vm.mobile=L.Browser.mobile,vm.zoom2Drawing=function(){MapData.PanToItem(vm.drawLayer)},vm.deleteDrawing=function(){MapData.CleanDrawings()},vm.bufferFromDrawing=function(){MapData.ExtendedType=null,MapData.CleanBuffer();var bufferInstance=$modal.open({templateUrl:"templates/search/bufferTemplate.html",controller:"BufferController",resolve:{backdrop:!1,keyboard:!0}});bufferInstance.result.then(function(returnobj){vm.drawLayer.toGeoJSON().features?vm.drawLayer.toGeoJSON().features.forEach(function(feature){GeometryService.Buffer(feature,returnobj.buffer,returnobj.layer)}):GeometryService.Buffer(vm.drawLayer.toGeoJSON(),returnobj.buffer,returnobj.layer)},function(obj){console.log("Modal dismissed at: "+new Date)})},vm.extendedType=null,$scope.$watch(function(){return MapData.ExtendedType},function(newValue,oldValue){vm.extendedType=newValue}),vm.addSelection=function(){"add"!=vm.extendedType?(MapData.ActiveInteractieKnop=ActiveInteractieButton.SELECT,MapData.DrawingType=DrawingOption.NIETS,MapData.ShowDrawControls=!0,MapData.ShowMetenControls=!1,vm.extendedType="add",MapData.ExtendedType="add"):(vm.extendedType=null,MapData.ExtendedType=null)},vm.removeSelection=function(){"remove"!=vm.extendedType?(MapData.ActiveInteractieKnop=ActiveInteractieButton.SELECT,MapData.DrawingType=DrawingOption.NIETS,MapData.ShowDrawControls=!0,MapData.ShowMetenControls=!1,vm.extendedType="remove",MapData.ExtendedType="remove"):(vm.extendedType=null,MapData.ExtendedType=null)},vm.deleteFeature=function(feature){SearchService.DeleteFeature(feature)},vm.aantalFeaturesMetType=function(type){return vm.features.filter(function(x){return x.layerName==type}).length},vm.isOpenGroup=function(type){return vm.features.filter(function(x){return x.layerName==type})},vm.deleteFeatureGroup=function(featureGroupName){vm.collapsestatepergroup[featureGroupName]=void 0,SearchService.DeleteFeatureGroup(featureGroupName)},vm.showDetails=function(feature){ResultsData.SelectedFeature=feature},vm.exportToCSV=function(){SearchService.ExportToCSV()},vm.exportToCSVButtonIsEnabled=FeatureService.exportToCSVButtonIsEnabled,$scope.$watch(function(){return FeatureService.exportToCSVButtonIsEnabled},function(newValue,oldValue){vm.exportToCSVButtonIsEnabled=newValue}),$scope.$watch(function(){return FeatureService.extraResultButtonIsEnabled},function(newValue,oldValue){vm.extraResultButtonIsEnabled=FeatureService.extraResultButtonIsEnabled,vm.extraResultButton=FeatureService.extraResultButtonCallBack,vm.resultButtonText=FeatureService.resultButtonText}),$scope.$watch(function(){return FeatureService.extraResultButtonConditionCallBack()},function(newValue,oldValue){vm.extraResultButtonIsEnabled=newValue}),vm.extraResultButtonIsEnabled=FeatureService.extraResultButtonIsEnabled,vm.extraResultButton=FeatureService.extraResultButtonCallBack,vm.resultButtonText=FeatureService.resultButtonText});theController.$inject=["$scope","ResultsData","map","SearchService","MapData","FeatureService","$modal","GeometryService"]}(),function(module){module=angular.module("tink.gis");var theController=module.controller("searchSelectedController",function($scope,ResultsData,MapData,SearchService,GeometryService,$modal,FeatureService,map){var vm=this;vm.selectedResult=null,vm.prevResult=null,vm.nextResult=null,vm.props=[],vm.mobile=L.Browser.mobile,$scope.$watch(function(){return ResultsData.SelectedFeature},function(newVal,oldVal){if(oldVal&&oldVal!=newVal&&oldVal.mapItem)if(oldVal.mapItem.isBufferedItem)MapData.SetStyle(oldVal.mapItem,Style.COREBUFFER,L.AwesomeMarkers.icon({
icon:"fa-circle-o",markerColor:"lightgreen"}));else{var myicon=L.icon({iconUrl:"bower_components/leaflet/dist/images/marker-icon.png",iconRetinaUrl:"bower_components/leaflet/dist/images/marker-icon-2x.png",shadowUrl:"bower_components/leaflet/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]});MapData.SetStyle(oldVal.mapItem,Style.DEFAULT,myicon)}if(newVal){if(newVal.mapItem){var myicon=L.AwesomeMarkers.icon({icon:"fa-dot-circle-o",markerColor:"red"});MapData.SetStyle(newVal.mapItem,Style.HIGHLIGHT,myicon)}vm.selectedResult=newVal;var item=Object.getOwnPropertyNames(newVal.properties).map(function(k){return{key:k,value:newVal.properties[k]}});vm.props=item,vm.prevResult=SearchService.GetPrevResult(),vm.nextResult=SearchService.GetNextResult()}else vm.selectedResult=null,vm.prevResult=null,vm.nextResult=null}),vm.toonFeatureOpKaart=function(){"esri"===vm.selectedResult.theme.Type?MapData.PanToFeature(vm.selectedResult.mapItem):MapData.GoToLastClickBounds()},vm.volgende=function(){console.log(ResultsData.SelectedFeature),ResultsData.SelectedFeature=vm.nextResult},vm.vorige=function(){ResultsData.SelectedFeature=vm.prevResult},vm.buffer=1,vm.doordruk=function(){MapData.ExtendedType=null,console.log(ResultsData.SelectedFeature),ResultsData.SelectedFeature.mapItem.toGeoJSON().features.forEach(function(feature){GeometryService.Doordruk(feature)})},vm.buffer=function(){MapData.ExtendedType=null,MapData.CleanDrawings(),MapData.CleanBuffer(),MapData.SetDrawLayer(ResultsData.SelectedFeature.mapItem);var bufferInstance=$modal.open({templateUrl:"templates/search/bufferTemplate.html",controller:"BufferController",resolve:{backdrop:!1,keyboard:!0}});bufferInstance.result.then(function(returnobj){ResultsData.SelectedFeature.mapItem.toGeoJSON().features.forEach(function(feature){GeometryService.Buffer(feature,returnobj.buffer,returnobj.layer)})},function(obj){console.log("Modal dismissed at: "+new Date)})},vm.exportToCSV=function(){SearchService.ExportOneToCSV(vm.selectedResult)},vm.delete=function(){var prev=SearchService.GetPrevResult(),next=SearchService.GetNextResult();SearchService.DeleteFeature(vm.selectedResult),next?ResultsData.SelectedFeature=next:prev?ResultsData.SelectedFeature=prev:ResultsData.SelectedFeature=null},vm.close=function(feature){vm.selectedResult=null,vm.prevResult=null,vm.nextResult=null,ResultsData.SelectedFeature=null},vm.exportToCSVButtonIsEnabled=FeatureService.exportToCSVButtonIsEnabled,$scope.$watch(function(){return FeatureService.exportToCSVButtonIsEnabled},function(newValue,oldValue){vm.exportToCSVButtonIsEnabled=newValue})});theController.$inject=["$scope","ResultsData","GeometryService","$modal","FeatureService","map"]}(),function(module){module=angular.module("tink.gis"),module.directive("tinkSearch",function(){return{replace:!0,templateUrl:"templates/search/searchTemplate.html",controller:"searchController",controllerAs:"srchctrl"}})}(),function(module){module=angular.module("tink.gis"),module.directive("tinkSearchResults",function(){return{replace:!0,templateUrl:"templates/search/searchResultsTemplate.html",controller:"searchResultsController",controllerAs:"srchrsltsctrl"}})}(),function(module){module=angular.module("tink.gis"),module.directive("tinkSearchSelected",function(){return{replace:!0,templateUrl:"templates/search/searchSelectedTemplate.html",controller:"searchSelectedController",controllerAs:"srchslctdctrl"}})}(),function(){var module=angular.module("tink.gis"),data=function(){var _data={};return _data.SelectedFeature=null,_data.JsonFeatures=[],_data.RequestCompleted=0,_data.RequestStarted=0,_data.GetRequestPercentage=function(){var percentage=Math.round(_data.RequestCompleted/_data.RequestStarted*100);return isNaN(percentage)&&(percentage=100),percentage},_data.EmptyResult=!1,_data.CleanSearch=function(){_data.SelectedFeature=null,_data.JsonFeatures.length=0,_data.RequestStarted=_data.RequestStarted-_data.RequestCompleted,_data.RequestCompleted=0},_data};module.factory("ResultsData",data)}(),function(){var module=angular.module("tink.gis"),service=function(ResultsData,map){var _service={};return _service.DeleteFeature=function(feature){var featureOfArray=ResultsData.JsonFeatures.find(function(x){return x.layerName==feature.layerName&&x.id==feature.id}),featureIndex=ResultsData.JsonFeatures.indexOf(featureOfArray);featureIndex>-1&&(featureOfArray.mapItem&&map.removeLayer(featureOfArray.mapItem),ResultsData.JsonFeatures.splice(featureIndex,1))},_service.DeleteFeatureGroup=function(featureGroupName){var toDelFeatures=[];ResultsData.JsonFeatures.forEach(function(feature){feature.layerName===featureGroupName&&toDelFeatures.push(feature)}),toDelFeatures.forEach(function(feat){_service.DeleteFeature(feat)})},_service.ExportToCSV=function(){var csvContent="",dataString="",layName="";csvContent+="sep=;\n",csvContent+="Laag;\n",_.sortBy(ResultsData.JsonFeatures,function(x){return x.layerName}).forEach(function(feature,index){if(layName!==feature.layerName){layName=feature.layerName.replace(";",",");var tmparr=[];for(var name in feature.properties)tmparr.push(name.replace(";",","));var layfirstline=tmparr.join(";");csvContent+=layName+";"+layfirstline+"\n"}var infoArray=_.values(feature.properties);infoArray.unshift(layName),dataString=infoArray.join(";"),console.log(dataString),csvContent+=index<ResultsData.JsonFeatures.length?dataString+"\n":dataString});var a=document.createElement("a");a.href="data:attachment/csv,"+escape(csvContent),a.target="_blank",a.download="exportsik.csv",document.body.appendChild(a),a.click()},_service.ExportOneToCSV=function(result){var props=Object.getOwnPropertyNames(result.properties).map(function(k){return{key:k,value:result.properties[k]}}),csvContent="";csvContent+="sep=;\n",csvContent+="Laag;"+result.layerName+"\n",props.forEach(function(prop){prop.key&&(prop.key=prop.key.toString().replace(";",",")),prop.value&&(prop.value=prop.value.toString().replace(";",",")),csvContent+=prop.key+";"+prop.value+"\n"});var a=document.createElement("a");a.href="data:attachment/csv,"+escape(csvContent),a.target="_blank",a.download="exportsik.csv",document.body.appendChild(a),a.click()},_service.GetNextResult=function(){var index=ResultsData.JsonFeatures.indexOf(ResultsData.SelectedFeature),layerName=ResultsData.SelectedFeature.layerName;if(index<ResultsData.JsonFeatures.length-1){var nextItem=ResultsData.JsonFeatures[index+1];if(nextItem.layerName===layerName)return nextItem}return null},_service.GetPrevResult=function(){var index=ResultsData.JsonFeatures.indexOf(ResultsData.SelectedFeature),layerName=ResultsData.SelectedFeature.layerName;if(index>0){var prevItem=ResultsData.JsonFeatures[index-1];if(prevItem.layerName===layerName)return prevItem}return null},_service};module.factory("SearchService",service)}(),L.TileLayer.BetterWMS=L.TileLayer.WMS.extend({getFeatureInfo:function(latlng,layers,requestype){var GisHelperService=angular.element(document.body).injector().get("GisHelperService"),url=this.getFeatureInfoUrl(latlng,layers,requestype);url=GisHelperService.CreateProxyUrl(url);var prom=$.ajax({url:url,transformResponse:function(data){return data},success:function(data,status,xhr){},error:function(xhr,status,_error){}});return prom},getFeatureInfoUrl:function(latlng,layers,requestype){var point=this._map.latLngToContainerPoint(latlng,this._map.getZoom()),size=this._map.getSize(),params={request:"GetFeatureInfo",service:"WMS",srs:"EPSG:4326",styles:this.wmsParams.styles,transparent:this.wmsParams.transparent,version:this.wmsParams.version,format:this.wmsParams.format,bbox:this._map.getBounds().toBBoxString(),height:size.y,width:size.x,layers:layers,query_layers:layers,buffer:100,info_format:requestype};return params["1.3.0"===params.version?"i":"x"]=point.x,params["1.3.0"===params.version?"j":"y"]=point.y,this._url+L.Util.getParamString(params,this._url,!0)}}),L.tileLayer.betterWms=function(url,options){return new L.TileLayer.BetterWMS(url,options)},L.drawVersion="0.3.0-dev",L.drawLocal={draw:{toolbar:{actions:{title:"Tekenen annuleren",text:"Annuleren"},finish:{title:"Tekenen beëindigen",text:"Tekenen beëindigen"},undo:{title:"Verwijder laatst getekende punt",text:"Verwijder laatste punt"},buttons:{polyline:"Teken een lijn",polygon:"Teken een veelhoek",rectangle:"Teken een rechthoek",circle:"Teken een cirkel",marker:"Teken een markering"}},handlers:{circle:{tooltip:{start:"Klik en sleep om een cirkel te tekenen."},radius:"Straal"},marker:{tooltip:{start:"Klik om een markering te plaatsen."}},polygon:{tooltip:{start:"Klik om een veelhoek  te tekenen.",cont:"Klik om de veelhoek verder te tekenen.",end:"Klik op het eerste punt om de veelhoek te sluiten."}},polyline:{error:"<strong>Error:</strong> figuur randen mogen niet kruisen!",tooltip:{start:"Klik om een lijn te tekenen.",cont:"Klik om de lijn verder te tekenen.",end:"Klik op het laatste punt om de lijn af te sluiten."}},rectangle:{tooltip:{start:"Klik en sleep om een rechthoek te tekenen."}},simpleshape:{tooltip:{end:"Laat de muis los om het tekenen te beëindigen."}}}},edit:{toolbar:{actions:{save:{title:"Aanpassingen bewaren.",text:"Bewaren"},cancel:{title:"Tekenen annuleren, aanpassingen verwijderen.",text:"Annuleren"}},buttons:{edit:"Lagen bewerken.",editDisabled:"Geen lagen om te bewerken.",remove:"Lagen verwijderen.",removeDisabled:"Geen lagen om te verwijderen."}},handlers:{edit:{tooltip:{text:"Versleep ankerpunt of markering om het object aan te passen.",subtext:"Klink Annuleer om de aanpassingen ongedaan te maken."}},remove:{tooltip:{text:"Klik op object om te verwijderen"}}}}},function(module){module=angular.module("tink.gis"),module.factory("RecursionHelper",["$compile",function($compile){return{compile:function(element,link){angular.isFunction(link)&&(link={post:link});var compiledContents,contents=element.contents().remove();return{pre:link&&link.pre?link.pre:null,post:function(scope,element){compiledContents||(compiledContents=$compile(contents)),compiledContents(scope,function(clone){element.append(clone)}),link&&link.post&&link.post.apply(null,arguments)}}}}}])}(),angular.module("tink.gis").run(["$templateCache",function($templateCache){$templateCache.put("templates/external/streetView.html","<html>\n<head>\n<meta charset=utf-8>\n<title>Street View side-by-side</title>\n<style>\nhtml, body {\r\n        height: 100%;\r\n        margin: 0;\r\n        padding: 0;\r\n      }\r\n      #map,  {\r\n        float: left;\r\n        height: 0%;\r\n        width: 0%;\r\n      }\r\n       #pano {\r\n        float: left;\r\n        height: 100%;\r\n        width: 100%;\r\n      }\n</style>\n</head>\n<body>\n<div id=map></div>\n<div id=pano></div>\n<script>\nfunction initialize() {\r\n        \r\n        var urlLat = parseFloat((location.search.split('lat=')[1]||'').split('&')[0]);\r\n        var urlLng = parseFloat((location.search.split('lng=')[1]||'').split('&')[0]);\r\n        var fenway = {lat:urlLat, lng: urlLng};\r\n        var map = new google.maps.Map(document.getElementById('map'), {\r\n          center: fenway,\r\n          zoom: 14\r\n        });\r\n        var panorama = new google.maps.StreetViewPanorama(\r\n            document.getElementById('pano'), {\r\n              position: fenway,\r\n              pov: {\r\n                heading: 34,\r\n                pitch: 10\r\n              }\r\n            });\r\n        map.setStreetView(panorama);\r\n      }\n</script>\n<script async defer src=\"https://maps.googleapis.com/maps/api/js?callback=initialize\">\n</script>\n</body>\n</html>"),$templateCache.put("templates/layermanagement/geoPuntTemplate.html",'<div class="gepoPuntTemplate row relative-container flex-grow-1">\n<div class="col-xs-4 flex-column flex-grow-1 margin-top margin-bottom border-right">\n<div ng-show="loading == false" class="overflow-wrapper flex-grow-1 list-selectable margin-top margin-bottom">\n<div ng-if=!searchIsUrl ng-repeat="theme in availableThemes">\n<dl ng-class="{active: isActive(theme)}" ng-class="{\'not-allowed\': theme.Type != \'wms\' &&  theme.Type != \'esri\'}">\n<a href=# class=theme-layer ng-click=geopuntThemeChanged(theme)>\n<dt>{{theme.Naam}}</dt>\n</a>\n<i ng-if="theme.Added == true" class="fa fa-check-circle"></i>\n<i ng-if="theme.Added == null" class="fa fa-check-circle-o"></i>\n</dl>\n</div>\n</div>\n<div ng-show="loading == false">\n<tink-pagination ng-hide="numberofrecordsmatched <= 5" tink-current-page=currentPage tink-change=pageChanged(page,perPage,next) tink-total-items=numberofrecordsmatched tink-items-per-page=recordsAPage></tink-pagination>\n</div>\n<div ng-if="loading == true" class=loader>\n</div>\n</div>\n<div class="col-xs-8 flex-column flex-grow-1 margin-top margin-bottom">\n<preview-layer ng-show="themeloading == false" class=margin-top ng-if=copySelectedTheme addorupdatefunc=AddOrUpdateTheme() theme=copySelectedTheme>\n</preview-layer>\n<div ng-if=error>\n{{error}}\n</div>\n<div class=loader ng-show="themeloading == true"></div>\n</div>\n</div>'),$templateCache.put("templates/layermanagement/layerManagerTemplate.html",'<div class="layermanagerTemplate modal-header">\n<div class="row margin-bottom">\n<div class=col-xs-10>\n<h4>Zoeken in geodata</h4>\n</div>\n<div class=col-xs-2>\n<button class="close pull-right" type=button data-ng-click=cancel()></button>\n</div>\n</div>\n</div>\n<div class="modal-body height-lg width-lg flex-column flex-grow-1">\n<div class="row margin-top margin-bottom">\n<div class="col-xs-12 col-sm-6">\n<form>\n<input auto-focus type=search ng-keydown="$event.keyCode === 13 && enterPressed()" ng-model=searchTerm ng-change=searchChanged() ng-model-options="{debounce: 350}" placeholder="Geef een trefwoord in (minimum 3 tekens)">\n</form>\n</div>\n</div>\n<div class=row>\n<div class=col-xs-12>\n<ul class=nav-tabs>\n<li role=presentation ng-class="{\'active\': active==\'solr\'}"><a href="" ng-click="active=\'solr\'">Stad <span ng-if="solrLoading==true" class=loader></span><span ng-if="solrLoading==false && solrCount != null">({{solrCount}})</span></a></li>\n<li ng-show=!mobile role=presentation ng-class="{\'active\': active==\'geopunt\'}"><a href="" ng-click="active=\'geopunt\'">GeoPunt <span ng-if="geopuntLoading==true" class=loader></span><span ng-if="geopuntLoading==false && geopuntCount != null">({{geopuntCount}})</span></a></li>\n<li role=presentation class=pull-right ng-class="{\'active\': active==\'beheer\'}"><a href="" ng-click="active=\'beheer\'">Lagenbeheer</a></li>\n<li ng-show=!mobile role=presentation class=pull-right ng-class="{\'active\': active==\'wmsurl\'}"><a href="" ng-click="active=\'wmsurl\'">URL ingeven</a></li>\n</ul>\n</div>\n</div>\n<solr-gis ng-show="active==\'solr\'"></solr-gis>\n<geo-punt ng-show="active==\'geopunt\'"></geo-punt>\n<wms-url ng-show="active==\'wmsurl\'"></wms-url>\n<layers-management ng-if="active==\'beheer\'"></layers-management></div>'),$templateCache.put("templates/layermanagement/layersManagementTemplate.html",'<div class="layersManagementTemplate row relative-container flex-grow-1">\n<div class="col-xs-4 flex-column flex-grow-1 margin-top margin-bottom">\n<div class="overflow-wrapper flex-grow-1 list-selectable margin-top margin-bottom border-right">\n<div ng-repeat="theme in availableThemes | filter:{name: searchTerm}">\n<dl ng-class="{active: isActive(theme)}">\n<a href=# class=theme-layer ng-click=ThemeChanged(theme)>\n<dt>{{theme.name}}<button class="trash pull-right" prevent-default ng-click=delTheme(theme)></button>\n</dt>\n</a>\n</dl>\n</div>\n</div>\n</div>\n<div class="col-xs-8 flex-column flex-grow-1 margin-top margin-bottom">\n<preview-layer ng-if=copySelectedTheme theme=copySelectedTheme addorupdatefunc=AddOrUpdateTheme()>\n</preview-layer>\n</div>\n</div>\n'),$templateCache.put("templates/layermanagement/managementLayerTemplate.html",'<div ng-if=lyrctrl.layer.hasLayers>\n<div class="layercontroller-checkbox managementLayerTemplate">\n<div class=can-open ng-class="{\'open\': showLayer}">\n<input indeterminate-checkbox child-list=lyrctrl.layer.AllLayers property=enabled type=checkbox ng-model=lyrctrl.layer.enabled id={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}>\n<label for={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}> {{lyrctrl.layer.title | limitTo: 99}}</label>\n<span class=show-layer ng-click="showLayer = !showLayer"></span>\n</div>\n<div ng-show=showLayer ng-repeat="lay in lyrctrl.layer.Layers">\n<tink-managementlayer layer=lay>\n</tink-managementlayer>\n</div>\n</div>\n</div>\n<div ng-if=!lyrctrl.layer.hasLayers>\n<div class="layercontroller-checkbox managementLayerTemplate">\n<input type=checkbox ng-model="lyrctrl.layer.enabled " id={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}>\n<label for="{{lyrctrl.layer.name}}{{lyrctrl.layer.id}} "> {{lyrctrl.layer.title | limitTo: 99}}</label>\n</div>\n</div>\n'),$templateCache.put("templates/layermanagement/previewLayerTemplate.html",'<div class="previewLayerTemplate flex-column flex-grow-1">\n<div class=margin-top>\n<p>{{theme.Description}}</p>\n<p><small><a ng-href={{theme.cleanUrl}} target=_blank>Details</a></small></p>\n</div>\n<div class="layercontroller-checkbox overflow-wrapper margin-bottom flex-grow-1">\n<input indeterminate-checkbox child-list=theme.AllLayers property=enabled type=checkbox ng-model=theme.enabled id={{theme.name}}>\n<label for={{theme.name}}>{{theme.name}}</label>\n<div ng-repeat="mainlayer in theme.Layers">\n<tink-managementlayer layer=mainlayer></tink-managementlayer>\n</div>\n</div>\n<div class=text-align-right ng-show="theme !== null">\n<button class="btn-sm btn-primary" ng-if="theme.Added == false" ng-disabled=!theme.enabled ng-click=addorupdatefunc()>Toevoegen</button>\n<button class=btn-sm ng-if="theme.Added != false" ng-click=addorupdatefunc()>Bijwerken</button>\n<button class=btn-sm ng-if="theme.Added != false" ng-click=delTheme()>Verwijderen</button>\n</div>\n</div>\n'),$templateCache.put("templates/layermanagement/solrGISTemplate.html",'<div class="solrGISTemplate row relative-container flex-grow-1">\n<div class="col-xs-5 flex-column flex-grow-1">\n<div class="overflow-wrapper flex-grow-1 list-selectable margin-top margin-bottom border-right">\n<div ng-show="loading == false" ng-repeat="theme in availableThemes">\n<dl ng-class="{active: isActive(theme)}">\n<dt>\n<a href=# class=theme-layer ng-click=solrThemeChanged(theme)>\n{{theme.name}} <i ng-if="theme.cleanUrl.toLowerCase().includes(\'p_sik\')" class="fa fa-key" aria-hidden=true tink-tooltip="Secured mapservice" tink-tooltip-align=right></i>\n</a>\n</dt>\n<dd ng-repeat="layer in theme.layers">\n<a href=# class=theme-layer ng-click="solrThemeChanged(theme, layer.naam)">\n<span>{{layer.naam}}\n<span ng-show="layer.featuresCount > 0"> ({{layer.featuresCount}})</span>\n</span>\n<div class=featureinsolr>\n{{layer.features.join(\', \')}}\n</div>\n</a>\n</dd>\n</dl>\n</div>\n</div>\n<div ng-show="loading == false">\n<tink-pagination ng-hide="numberofrecordsmatched <= 5" tink-current-page=currentPage tink-change=pageChanged(page,perPage,next) tink-total-items=numberofrecordsmatched tink-items-per-page=recordsAPage></tink-pagination>\n</div>\n<div ng-if="loading == true" class=loader>\n</div>\n</div>\n<div class="col-xs-7 flex-column flex-grow-1">\n<preview-layer ng-if=copySelectedTheme theme=copySelectedTheme addorupdatefunc=AddOrUpdateTheme()>\n</preview-layer>\n<div ng-if=error>\n{{error}}\n</div>\n<div class=loader ng-show="themeloading == true"></div>\n</div>\n</div>'),$templateCache.put("templates/layermanagement/wmsUrlTemplate.html",'<div class="wmsUrlTemplate row relative-container">\n<div class="col-xs-4 flex-column flex-grow-1 margin-top margin-bottom">\n<div>\n<input class=searchbox ng-model=url ng-change=urlChanged() placeholder="Geef een wms url in">\n</div>\n</div>\n<div class="col-xs-8 flex-column flex-grow-1 margin-top margin-bottom">\n<div>\n<button ng-disabled=!urlIsValid ng-click=laadUrl()>Laad url</button>\n</div>\n<preview-layer ng-show="themeloading == false" class=margin-top ng-if=copySelectedTheme addorupdatefunc=AddOrUpdateTheme() theme=copySelectedTheme>\n</preview-layer>\n<div ng-if=error>\n{{error}}\n</div>\n<div class=loader ng-show="themeloading == true"></div>\n</div>\n</div>\n'),$templateCache.put("templates/other/layerTemplate.html",'<div ng-class="{\'hidden-print\': lyrctrl.layer.IsEnabledAndVisible == false}">\n<div ng-if=lyrctrl.layer.hasLayers>\n<li class="li-item toc-item-without-icon can-open" ng-class="{\'open\': showLayer}">\n<div>\n<input class="visible-box hidden-print" type=checkbox id={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}{{lyrctrl.layer.theme.Naam}} ng-model=lyrctrl.layer.visible ng-change=layercheckboxchange(lyrctrl.layer.theme)>\n<label title={{lyrctrl.layer.name}} for={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}{{lyrctrl.layer.theme.Naam}}>{{lyrctrl.layer.name}}</label>\n</div>\n<div>\n<span class=show-layer ng-click="showLayer = !showLayer"></span>\n</div>\n</li>\n<ul ng-show=showLayer ng-repeat="layer in lyrctrl.layer.Layers | filter :  { enabled: true }">\n<tink-layer layer=layer layercheckboxchange=layercheckboxchange(layer.theme)>\n</tink-layer>\n</ul>\n</div>\n<li class="li-item toc-item-with-icon" ng-if=!lyrctrl.layer.hasLayers>\n<img class=layer-icon ng-if="lyrctrl.layer.theme.Type==\'esri\' && lyrctrl.layer.legend.length===1" class=layer-icon ng-src="{{lyrctrl.layer.legend[0].fullurl}} ">\n<div class=can-open ng-class="{\'open\': showLayer2 || showMultiLegend}">\n<input class="visible-box hidden-print" type=checkbox ng-model=lyrctrl.layer.visible ng-change=layercheckboxchange(lyrctrl.layer.theme) id={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}{{lyrctrl.layer.theme.Naam}}>\n<label ng-class="{ \'greytext\': lyrctrl.layer.displayed==false} " for={{lyrctrl.layer.name}}{{lyrctrl.layer.id}}{{lyrctrl.layer.theme.Naam}} title={{lyrctrl.layer.title}}>{{lyrctrl.layer.title}}\n<span class="hidden-print greytext" ng-show="lyrctrl.layer.theme.Type==\'wms\' && lyrctrl.layer.queryable"> <i class="fa fa-info"></i></span>\n</label>\n<span style=color:#76b9f4 class=show-layer ng-show="lyrctrl.layer.theme.Type==\'wms\'" ng-click="showLayer2 = !showLayer2"></span>\n<span style=color:#76b9f4 class=show-layer ng-show="lyrctrl.layer.theme.Type==\'esri\' && lyrctrl.layer.legend.length>1" ng-click="showMultiLegend = !showMultiLegend"></span>\n<ul ng-show="showMultiLegend && lyrctrl.layer.legend.length>1" ng-repeat="legend in lyrctrl.layer.legend" ng-class="{\'open\': showMultiLegend}">\n<img class=layer-icon ng-src="{{legend.fullurl}} "><span>{{legend.label}}</span>\n</ul>\n<img class=normal-size ng-src={{lyrctrl.layer.legendUrl}} onerror="this.style.display=\'none\'" ng-show=showLayer2>\n</div>\n</li>\n<ul class=li-item ng-if="lyrctrl.layer.theme.Type==\'esri\' && lyrctrl.layer.legend.length>1" ng-show=showLayer>\n<li ng-repeat="legend in lyrctrl.layer.legend">\n<img style="width:20px; height:20px" ng-src="{{legend.fullurl}} "><span title={{legend.label}}>{{legend.label}}</span>\n</li>\n</ul>\n</div>'),$templateCache.put("templates/other/layersTemplate.html",'<div data-tink-nav-aside="" id=rightaside data-auto-select=true data-toggle-id=asideNavRight class="nav-aside nav-right">\n<aside class="flex-column flex-grow-1">\n<div class=nav-aside-section>\n<p class=nav-aside-title>Lagenoverzicht</p>\n</div>\n<button ng-click=lyrsctrl.asidetoggle class=nav-right-toggle data-tink-sidenav-collapse=asideNavRight>\n<a href=# title="Open menu"><span class=sr-only>Open right menu</span></a>\n</button>\n<div class="flex-column flex-grow-1">\n<div class=layer-management ng-if=lyrsctrl.layerManagementButtonIsEnabled>\n<div class="col-xs-12 margin-top margin-bottom">\n<button class="btn btn-primary btn-layermanagement center-block" ng-click=lyrsctrl.Lagenbeheer()>Lagenbeheer</button>\n</div>\n</div>\n<div class="overflow-wrapper flex-grow-1 extra-padding">\n<ul class=ul-level id=sortableThemes ui-sortable=lyrsctrl.sortableOptions ng-model=lyrsctrl.themes>\n<li class=li-item ng-repeat="theme in lyrsctrl.themes">\n<tink-theme theme=theme layercheckboxchange=lyrsctrl.updatethemevisibility(theme) hidedelete=!lyrsctrl.deleteLayerButtonIsEnabled>\n</tink-theme>\n</li>\n</ul>\n</div>\n</div>\n</aside>\n</div>\n'),$templateCache.put("templates/other/mapTemplate.html",'<div class=tink-map>\n<div class="margin-print-content hidden-print">\n</div>\n<div class=print-content>\n<div class=print-content-header>\n<div class=col-xs-12>\n<h4>Stad in kaart</h4>\n</div>\n</div>\n<div class=print-map>\n<tink-search class=tink-search></tink-search>\n<div id=map class=leafletmap>\n<div class=map-buttons-left>\n<div class="ll drawingbtns" ng-show=mapctrl.showDrawControls>\n<div class=btn-group>\n<button ng-click=mapctrl.selectpunt() ng-class="{active: mapctrl.drawingType==\'\'}" type=button class=btn prevent-default-map tink-tooltip="Selecteer met een punt" tink-tooltip-align=bottom><i class="fa fa-circle" style="font-size: 0.75em"></i></button>\n<button ng-click="mapctrl.drawingButtonChanged(\'lijn\')" ng-class="{active: mapctrl.drawingType==\'lijn\'}" type=button class=btn prevent-default-map tink-tooltip="Selecteer met een lijn" tink-tooltip-align=bottom><i class="fa fa-minus"></i></button>\n<button ng-hide=mapctrl.mobile ng-click="mapctrl.drawingButtonChanged(\'vierkant\')" ng-class="{active: mapctrl.drawingType==\'vierkant\'}" type=button class=btn prevent-default-map tink-tooltip="Selecteer met een rechthoek" tink-tooltip-align=bottom><i class="fa fa-square-o"></i></button>\n<button ng-click="mapctrl.drawingButtonChanged(\'polygon\')" ng-class="{active: mapctrl.drawingType==\'polygon\'}" type=button class=btn prevent-default-map tink-tooltip="Selecteer met een veelhoek" tink-tooltip-align=bottom><i class="fa fa-star-o"></i></button>\n</div>\n<div class=select>\n<select ng-options="layer as layer.name for layer in mapctrl.SelectableLayers()" ng-model=mapctrl.selectedLayer ng-show="mapctrl.SelectableLayers().length > 1 && !mapctrl.mobile" ng-change=mapctrl.layerChange() prevent-default-map></select>\n</div>\n</div>\n<div class="btn-group btn-group-vertical ll interactiebtns">\n<button type=button class=btn ng-click="mapctrl.interactieButtonChanged(\'identify\')" ng-class="{active: mapctrl.activeInteractieKnop==\'identify\'}" tink-tooltip=Identificeren tink-tooltip-align=bottom prevent-default-map><i class="fa fa-info"></i></button>\n<button type=button class=btn ng-click="mapctrl.interactieButtonChanged(\'select\')" ng-class="{active: mapctrl.activeInteractieKnop==\'select\'}" tink-tooltip=Selecteren tink-tooltip-align=bottom prevent-default-map><i class="fa fa-mouse-pointer"></i></button>\n<button type=button class=btn ng-click="mapctrl.interactieButtonChanged(\'meten\')" ng-class="{active: mapctrl.activeInteractieKnop==\'meten\'}" tink-tooltip=Meten tink-tooltip-align=bottom prevent-default-map>\n<svg class="icon icon-sik-ruler"><use xlink:href=#icon-sik-ruler></use></svg>\n</button>\n<button type=button class=btn ng-click="mapctrl.interactieButtonChanged(\'watishier\')" ng-class="{active: mapctrl.activeInteractieKnop==\'watishier\'}" tink-tooltip="Wat is hier" tink-tooltip-align=bottom prevent-default-map>\n<i class="fa fa-thumb-tack"></i>\n</button>\n</div>\n<div class="btn-group ll kaarttypes">\n<button class=btn ng-class="{active: mapctrl.IsBaseMap1==true}" ng-click=mapctrl.toonBaseMap1() prevent-default-map>{{mapctrl.baseMap1Naam()}}</button>\n<button class=btn ng-class="{active: mapctrl.IsBaseMap1==false}" ng-click=mapctrl.toonBaseMap2() prevent-default-map>{{mapctrl.baseMap2Naam()}}</button>\n</div>\n<div class="btn-group ll metenbtns" ng-show=mapctrl.showMetenControls>\n<button ng-click="mapctrl.drawingButtonChanged(\'afstand\')" ng-class="{active: mapctrl.drawingType==\'afstand\'}" type=button tink-tooltip="Meten afstand" tink-tooltip-align=bottom class=btn prevent-default-map>\n<svg class="icon icon-sik-measure-line"><use xlink:href=#icon-sik-measure-line></use></svg>\n</button>\n<button ng-click="mapctrl.drawingButtonChanged(\'oppervlakte\')" ng-class="{active: mapctrl.drawingType==\'oppervlakte\'}" type=button tink-tooltip="Meten oppervlakte en omtrek" tink-tooltip-align=bottom class=btn prevent-default-map>\n<svg class="icon icon-sik-measure-shape"><use xlink:href=#icon-sik-measure-shape></use></svg>\n</button>\n</div>\n<div class="btn-group ll searchbtns">\n<button type=button class="btn tooltip-margin-left" ng-class="{active: mapctrl.ZoekenOpLocatie==true}" ng-click=mapctrl.fnZoekenOpLocatie() tink-tooltip="Zoeken naar locatie" tink-tooltip-align=bottom prevent-default-map>\n<svg class="icon icon-sik-location-search"><use xlink:href=#icon-sik-location-search></use></svg>\n</button>\n<button type=button class=btn ng-class="{active: mapctrl.ZoekenOpLocatie==false}" ng-click=mapctrl.ZoekenInLagen() tink-tooltip="Zoeken binnen lagen" tink-tooltip-align=bottom prevent-default-map>\n<svg class="icon icon-sik-layers-search"><use xlink:href=#icon-sik-layers-search></use></svg>\n</button>\n</div>\n<form id=zoekbalken class="form-force-inline ll zoekbalken">\n<select ng-options="layer as layer.name for layer in mapctrl.SelectableLayers()" ng-model=mapctrl.selectedFindLayer ng-show="mapctrl.SelectableLayers().length > 1 && mapctrl.SelectableLayers()" ng-change=mapctrl.findLayerChange() prevent-default-map></select>\n<input type=search ng-show="mapctrl.ZoekenOpLocatie == false" placeholder="Geef een zoekterm" prevent-default-map ng-keyup="$event.keyCode == 13 && mapctrl.zoekLaag(mapctrl.laagquery)" ng-model=mapctrl.laagquery>\n</form>\n</div>\n<div class=map-buttons-right>\n<div class="btn-group btn-group-vertical ll viewbtns">\n<button type=button class=btn ng-click=mapctrl.zoomIn() tink-tooltip="Zoom in" tink-tooltip-align=left prevent-default-map>\n<i class="fa fa-plus"></i>\n</button>\n<button type=button class=btn ng-click=mapctrl.zoomOut() tink-tooltip="Zoom uit" tink-tooltip-align=left prevent-default-map>\n<i class="fa fa-minus"></i>\n</button>\n<button type=button class=btn ng-click=mapctrl.zoomToGps() ng-class="{active: mapctrl.gpstracking==true}" tink-tooltip="Huidige locatie" tink-tooltip-align=left prevent-default-map>\n<i class="fa fa-crosshairs"></i>\n</button>\n</div>\n<div class="ll loading" ng-show="mapctrl.Loading > 0">\n<div class=loader></div> {{mapctrl.MaxLoading - mapctrl.Loading}}/ {{mapctrl.MaxLoading}}\n</div>\n</div>\n</div>\n<tink-layers class=tink-layers></tink-layers>\n</div>\n<div class=print-content-footer>\n<div class=col-xs-2>\n<img class=print-corner-image src=https://www.antwerpen.be/assets/aOS/gfx/gui/a-logo.svg alt="Antwerpen logo">\n</div>\n<div class=col-xs-8>\nVoorbehoud: De kaart is een reproductie zonder juridische waarde. Zij bevat kaartmateriaal en info afkomstig van het stadsbestuur Antwerpen, IV, AAPD, Provinciebesturen en mogelijk nog andere organisaties.\n</div>\n<div class=col-xs-2>\n<img class="print-corner-image pull-right" src=http://images.vectorhq.com/images/previews/111/north-arrow-orienteering-137692.png alt="Noord pijl oriëntatielopen">\n</div>\n</div>\n</div>\n<div class="margin-print-content hidden-print">\n</div>\n<svg style="position: absolute; width: 0; height: 0; overflow: hidden" version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink>\n<defs>\n<symbol id=icon-sik-file-csv viewBox="0 0 32 32">\n<title>sik-file-csv</title>\n<path d="M4 0c-0.476 0-0.881 0.167-1.214 0.5s-0.5 0.738-0.5 1.214v28.571c0 0.476 0.167 0.881 0.5 1.214s0.738 0.5 1.214 0.5h24c0.476 0 0.881-0.167 1.214-0.5s0.5-0.738 0.5-1.214v-20.571c0-0.476-0.119-1-0.357-1.571s-0.524-1.024-0.857-1.357l-5.571-5.571c-0.333-0.333-0.786-0.619-1.357-0.857s-1.095-0.357-1.571-0.357h-16zM4.571 2.286h13.714v7.429c0 0.476 0.167 0.881 0.5 1.214s0.738 0.5 1.214 0.5h7.429v18.286h-22.857v-27.429zM20.571 2.429c0.345 0.119 0.589 0.25 0.732 0.393l5.589 5.589c0.143 0.143 0.274 0.387 0.393 0.732h-6.714v-6.714zM9.363 18.845c-0.995 0-1.798 0.328-2.409 0.984-0.611 0.653-0.916 1.57-0.916 2.753 0 1.118 0.304 2 0.911 2.646 0.607 0.643 1.383 0.964 2.326 0.964 0.762 0 1.391-0.187 1.885-0.562 0.498-0.378 0.853-0.955 1.066-1.73l-1.391-0.441c-0.12 0.52-0.317 0.901-0.591 1.144s-0.603 0.363-0.984 0.363c-0.517 0-0.937-0.191-1.26-0.572s-0.485-1.021-0.485-1.919c0-0.846 0.163-1.459 0.489-1.837 0.33-0.378 0.758-0.567 1.284-0.567 0.381 0 0.704 0.107 0.969 0.32 0.268 0.213 0.444 0.504 0.528 0.872l1.42-0.339c-0.162-0.569-0.404-1.005-0.727-1.309-0.543-0.514-1.249-0.771-2.118-0.771zM15.93 18.845c-0.546 0-1.013 0.082-1.401 0.247-0.384 0.165-0.68 0.405-0.887 0.722-0.204 0.313-0.305 0.651-0.305 1.013 0 0.562 0.218 1.039 0.654 1.43 0.31 0.278 0.85 0.512 1.619 0.703 0.598 0.149 0.981 0.252 1.149 0.31 0.246 0.087 0.417 0.191 0.514 0.31 0.1 0.116 0.15 0.258 0.15 0.426 0 0.262-0.118 0.491-0.354 0.688-0.233 0.194-0.58 0.291-1.042 0.291-0.436 0-0.783-0.11-1.042-0.33-0.255-0.22-0.425-0.564-0.509-1.032l-1.396 0.136c0.094 0.795 0.381 1.401 0.863 1.817 0.481 0.414 1.171 0.62 2.069 0.62 0.617 0 1.132-0.086 1.546-0.257 0.414-0.174 0.733-0.439 0.96-0.795s0.339-0.737 0.339-1.144c0-0.449-0.095-0.825-0.286-1.129-0.187-0.307-0.449-0.548-0.785-0.722-0.333-0.178-0.848-0.349-1.546-0.514s-1.137-0.323-1.318-0.475c-0.142-0.12-0.213-0.263-0.213-0.431 0-0.184 0.076-0.331 0.228-0.441 0.236-0.171 0.562-0.257 0.979-0.257 0.404 0 0.706 0.081 0.906 0.242 0.204 0.158 0.336 0.42 0.397 0.785l1.435-0.063c-0.023-0.653-0.26-1.174-0.712-1.565-0.449-0.391-1.12-0.586-2.011-0.586zM19.346 18.967l2.54 7.105h1.531l2.544-7.105h-1.522l-1.74 5.258-1.798-5.258h-1.556z"></path>\n</symbol>\n<symbol id=icon-sik-measure-shape viewBox="0 0 32 32">\n<title>sik-measure-shape</title>\n<path d="M18.533 0.018c-0.526 0-0.975 0.187-1.348 0.56s-0.56 0.823-0.56 1.348v2.955l-5.695 2.445c-0.080-0.33-0.249-0.623-0.506-0.881-0.373-0.373-0.823-0.56-1.348-0.56h-5.513c-0.526 0-0.975 0.187-1.348 0.56s-0.56 0.823-0.56 1.348v5.513c0 0.526 0.187 0.975 0.56 1.348s0.823 0.56 1.348 0.56h0.658l-0.99 7.437h-0.626c-0.526 0-0.975 0.187-1.348 0.56s-0.56 0.823-0.56 1.348v5.513c0 0.526 0.187 0.975 0.56 1.348s0.823 0.56 1.348 0.56h5.513c0.526 0 0.975-0.187 1.348-0.56s0.56-0.823 0.56-1.348v-1.134l12.198-4.496c0.090 0.277 0.246 0.528 0.469 0.751 0.373 0.373 0.823 0.56 1.348 0.56h5.513c0.526 0 0.975-0.187 1.348-0.56s0.56-0.823 0.56-1.348v-5.513c0-0.526-0.187-0.975-0.56-1.348s-0.823-0.56-1.348-0.56h-2.342l-2.353-7.254c0.193-0.092 0.371-0.22 0.535-0.383 0.373-0.373 0.56-0.823 0.56-1.348v-5.513c0-0.526-0.187-0.975-0.56-1.348s-0.823-0.56-1.348-0.56h-5.513zM19.63 1.874h3.319c0.317 0 0.587 0.112 0.812 0.337s0.337 0.495 0.337 0.812v3.319c0 0.316-0.112 0.587-0.337 0.812s-0.495 0.337-0.812 0.337h-3.319c-0.317 0-0.587-0.112-0.812-0.337s-0.337-0.495-0.337-0.812v-3.319c0-0.317 0.112-0.587 0.337-0.812s0.495-0.337 0.812-0.337zM16.625 7.471c0.008 0.512 0.194 0.95 0.56 1.316 0.373 0.373 0.823 0.56 1.348 0.56h3.808l2.296 7.078h-0.595c-0.526 0-0.975 0.187-1.348 0.56s-0.56 0.823-0.56 1.348v3.562l-12.108 4.463v-1.797c0-0.526-0.187-0.975-0.56-1.348s-0.823-0.56-1.348-0.56h-2.373l0.99-7.437h2.341c0.526 0 0.975-0.187 1.348-0.56s0.56-0.823 0.56-1.348v-3.414l5.641-2.422zM4.66 7.742h3.319c0.316 0 0.587 0.112 0.812 0.337s0.337 0.495 0.337 0.812v3.319c0 0.316-0.112 0.587-0.337 0.812s-0.495 0.337-0.812 0.337h-3.319c-0.316 0-0.587-0.112-0.812-0.337s-0.337-0.495-0.337-0.812v-3.319c0-0.316 0.112-0.587 0.337-0.812s0.495-0.337 0.812-0.337zM25.139 18.281h3.319c0.317 0 0.587 0.112 0.812 0.337s0.337 0.495 0.337 0.812v3.319c0 0.317-0.112 0.587-0.337 0.812s-0.495 0.337-0.812 0.337h-3.319c-0.316 0-0.587-0.112-0.812-0.337s-0.337-0.495-0.337-0.812v-3.319c0-0.316 0.112-0.587 0.337-0.812s0.495-0.337 0.812-0.337zM3.702 24.509h3.319c0.316 0 0.587 0.112 0.812 0.337s0.337 0.495 0.337 0.812v3.319c0 0.317-0.112 0.587-0.337 0.812s-0.495 0.337-0.812 0.337h-3.319c-0.317 0-0.587-0.112-0.812-0.337s-0.337-0.495-0.337-0.812v-3.319c0-0.317 0.112-0.587 0.337-0.812s0.495-0.337 0.812-0.337z"></path>\n</symbol>\n<symbol id=icon-sik-measure-line viewBox="0 0 32 32">\n<title>sik-measure-line</title>\n<path d="M24.752 0.172c-0.512 0-0.95 0.182-1.314 0.546s-0.546 0.802-0.546 1.314v5.371c0 0.055 0.002 0.109 0.006 0.162l-15.22 15.22c-0.137-0.031-0.28-0.047-0.43-0.047h-5.371c-0.512 0-0.95 0.182-1.314 0.546s-0.546 0.802-0.546 1.314v5.371c0 0.512 0.182 0.95 0.546 1.314s0.802 0.546 1.314 0.546h5.371c0.512 0 0.95-0.182 1.314-0.546s0.546-0.802 0.546-1.314v-5.371c0-0.005-0-0.009-0-0.013l15.345-15.345c0.097 0.015 0.197 0.022 0.3 0.022h5.371c0.512 0 0.95-0.182 1.314-0.546s0.546-0.802 0.546-1.314v-5.371c0-0.512-0.182-0.95-0.546-1.314s-0.802-0.546-1.314-0.546h-5.371zM25.82 1.98h3.234c0.308 0 0.572 0.11 0.791 0.328s0.328 0.483 0.328 0.791v3.234c0 0.308-0.109 0.572-0.328 0.791s-0.483 0.328-0.791 0.328h-3.234c-0.308 0-0.572-0.109-0.791-0.328s-0.328-0.483-0.328-0.791v-3.234c0-0.308 0.11-0.572 0.328-0.791s0.483-0.328 0.791-0.328zM2.946 24.547h3.234c0.308 0 0.572 0.11 0.791 0.328s0.328 0.483 0.328 0.791v3.234c0 0.308-0.109 0.572-0.328 0.791s-0.483 0.328-0.791 0.328h-3.234c-0.308 0-0.572-0.109-0.791-0.328s-0.328-0.483-0.328-0.791v-3.234c0-0.308 0.109-0.572 0.328-0.791s0.483-0.328 0.791-0.328z"></path>\n</symbol>\n<symbol id=icon-sik-ruler viewBox="0 0 32 32">\n<title>sik-ruler</title>\n<path d="M25.28 0.018c-0.698 0-1.295 0.249-1.794 0.747l-22.721 22.721c-0.498 0.498-0.747 1.096-0.747 1.794s0.249 1.295 0.747 1.794l3.588 3.588c0.001 0.001 0.001 0.001 0.002 0.002l0.572 0.572c0.498 0.498 1.096 0.747 1.794 0.747s1.296-0.249 1.794-0.747l22.721-22.721c0.498-0.498 0.747-1.096 0.747-1.794s-0.249-1.295-0.747-1.794l-4.161-4.161c-0.498-0.498-1.096-0.747-1.794-0.747zM25.243 2.374c0.48-0.001 0.882 0.161 1.206 0.485l2.67 2.67c0.371 0.371 0.529 0.843 0.475 1.417s-0.306 1.085-0.755 1.533l-20.458 20.458c-0.449 0.449-0.96 0.7-1.534 0.755s-1.046-0.104-1.417-0.475l-2.67-2.67c-0.371-0.371-0.529-0.843-0.475-1.417s0.306-1.085 0.755-1.534l0.289-0.289 2.215 2.215c0.055 0.055 0.122 0.081 0.202 0.077s0.149-0.034 0.208-0.093l0.426-0.426c0.059-0.059 0.090-0.128 0.093-0.208s-0.023-0.147-0.077-0.202l-2.215-2.215 2.212-2.212 2.215 2.215c0.055 0.055 0.122 0.081 0.202 0.077s0.149-0.034 0.208-0.093l0.426-0.426c0.059-0.059 0.090-0.129 0.093-0.208s-0.023-0.147-0.077-0.202l-2.215-2.215 2.212-2.212 3.436 3.436c0.080 0.080 0.168 0.126 0.265 0.141s0.175-0.008 0.234-0.067l0.426-0.426c0.059-0.059 0.082-0.137 0.067-0.234s-0.061-0.185-0.141-0.265l-3.436-3.436 2.212-2.212 2.215 2.215c0.055 0.055 0.122 0.081 0.202 0.077s0.149-0.034 0.208-0.093l0.426-0.426c0.059-0.059 0.090-0.129 0.093-0.208s-0.023-0.147-0.077-0.202l-2.215-2.215 2.212-2.212 2.215 2.215c0.055 0.055 0.122 0.081 0.202 0.077s0.149-0.034 0.208-0.093l0.426-0.426c0.059-0.059 0.090-0.129 0.093-0.208s-0.023-0.147-0.077-0.202l-2.215-2.215 2.212-2.212 3.436 3.436c0.080 0.080 0.168 0.126 0.265 0.141s0.175-0.008 0.234-0.067l0.426-0.426c0.059-0.059 0.082-0.137 0.067-0.234s-0.061-0.185-0.141-0.265l-3.436-3.436 2.212-2.212 2.215 2.215c0.055 0.055 0.122 0.081 0.202 0.077s0.149-0.034 0.208-0.093l0.426-0.426c0.059-0.059 0.090-0.129 0.093-0.208s-0.023-0.147-0.077-0.202l-2.215-2.215 0.938-0.938c0.449-0.449 0.96-0.7 1.534-0.755 0.072-0.007 0.142-0.010 0.21-0.010z"></path>\n</symbol>\n<symbol id=icon-sik-layers-search viewBox="0 0 32 32">\n<title>sik-layers-search</title>\n<path d="M16.105 1.196c-0.725 0-1.341 0.152-1.85 0.456l-12.581 7.525c-0.509 0.304-0.763 0.673-0.763 1.107s0.254 0.802 0.763 1.107l12.581 7.525c0.509 0.304 1.126 0.704 1.85 0.704s1.341-0.4 1.85-0.704l12.581-7.525c0.509-0.304 0.763-0.673 0.763-1.107s-0.254-0.802-0.763-1.107l-12.581-7.525c-0.509-0.304-1.126-0.456-1.85-0.456zM16.105 2.448c0.146 0 0.27 0.030 0.37 0.090l12.581 7.525c0.1 0.060 0.15 0.134 0.15 0.221s-0.050 0.162-0.15 0.221l-12.499 7.443c-0.1 0.060-0.306 0.172-0.453 0.172s-0.352-0.113-0.453-0.172l-12.499-7.443c-0.1-0.060-0.15-0.134-0.15-0.221s0.050-0.161 0.15-0.221l12.581-7.525c0.1-0.060 0.224-0.090 0.37-0.090zM3.524 13.383l-1.85 1.107c-0.509 0.304-0.763 0.673-0.763 1.107s0.254 0.802 0.763 1.107l12.581 7.525c0.509 0.304 1.126 0.622 1.85 0.622 0.093 0 0.184-0.005 0.273-0.015-0.032-0.238-0.052-0.515-0.056-0.797 0-0.246 0.013-0.486 0.037-0.722-0.087 0.056-0.179 0.076-0.255 0.076-0.146 0-0.352-0.071-0.453-0.131l-12.499-7.443c-0.1-0.060-0.15-0.134-0.15-0.221s0.050-0.161 0.15-0.221l1.85-1.107-1.48-0.885zM28.687 13.383l-1.48 0.885 1.85 1.107c0.1 0.060 0.15 0.134 0.15 0.221s-0.050 0.162-0.15 0.221l-3.214 1.914c0.572 0.248 1.064 0.544 1.512 0.895l3.181-1.923c0.509-0.304 0.763-0.673 0.763-1.107s-0.254-0.802-0.763-1.107l-1.85-1.107zM23.284 18.403c-0.756 0-1.479 0.147-2.169 0.44s-1.285 0.69-1.784 1.189c-0.5 0.5-0.896 1.094-1.19 1.784s-0.44 1.413-0.44 2.169c0 0.756 0.147 1.479 0.44 2.169s0.69 1.285 1.19 1.784c0.5 0.5 1.094 0.896 1.784 1.189s1.413 0.44 2.169 0.44c1.163 0 2.218-0.328 3.164-0.983l2.72 2.712c0.19 0.201 0.428 0.301 0.714 0.301 0.275 0 0.513-0.1 0.714-0.301s0.301-0.439 0.301-0.714c0-0.28-0.098-0.518-0.293-0.714l-2.72-2.72c0.656-0.946 0.983-2.001 0.983-3.164 0-0.756-0.147-1.479-0.44-2.169s-0.69-1.285-1.19-1.784c-0.5-0.5-1.094-0.896-1.784-1.189s-1.413-0.44-2.169-0.44zM3.535 18.677l-1.85 1.107c-0.509 0.304-0.763 0.673-0.763 1.107s0.254 0.802 0.763 1.107l12.581 7.525c0.509 0.304 1.126 0.622 1.85 0.622s1.341-0.317 1.85-0.622l0.647-0.387c-0.389-0.349-0.733-0.734-1.030-1.155l-1.015 0.574c-0.1 0.060-0.306 0.131-0.453 0.131s-0.352-0.072-0.453-0.131l-12.499-7.443c-0.1-0.060-0.15-0.134-0.15-0.221s0.050-0.161 0.15-0.221l1.85-1.107-1.48-0.885zM28.698 18.677l-0.759 0.454c0.486 0.472 0.9 1.014 1.228 1.61 0.021 0.040 0.024 0.045 0.027 0.051 0.259 0.472 0.474 1.019 0.616 1.594l0.738-0.389c0.509-0.304 0.763-0.673 0.763-1.107s-0.254-0.802-0.763-1.107l-1.85-1.107zM23.284 20.433c0.978 0 1.815 0.348 2.51 1.043s1.043 1.532 1.043 2.51c0 0.978-0.348 1.814-1.043 2.51s-1.532 1.043-2.51 1.043c-0.978 0-1.815-0.348-2.51-1.043s-1.043-1.532-1.043-2.51c0-0.978 0.348-1.814 1.043-2.51s1.532-1.043 2.51-1.043z"></path>\n</symbol>\n<symbol id=icon-sik-location-search viewBox="0 0 32 32">\n<title>sik-location-search</title>\n<path d="M15.299 0.018c-2.941 0-5.452 1.040-7.533 3.122s-3.122 4.592-3.122 7.533c0 1.512 0.229 2.754 0.687 3.725l7.596 16.107c0.208 0.458 0.531 0.819 0.968 1.082s0.905 0.395 1.405 0.395c0.499 0 0.968-0.132 1.405-0.395s0.767-0.624 0.988-1.082l0.555-1.18c-1.416-1.328-2.3-3.21-2.303-5.298 0-0.001 0-0.001 0-0.001 0-4.018 3.258-7.276 7.276-7.276 0 0 0 0 0 0 0.324 0.003 0.639 0.026 0.949 0.069l1.098-2.42c0.458-0.971 0.687-2.213 0.687-3.725 0-2.941-1.041-5.452-3.122-7.533s-4.592-3.122-7.533-3.122zM15.299 5.345c1.471 0 2.726 0.52 3.767 1.561s1.561 2.296 1.561 3.767c0 1.471-0.52 2.726-1.561 3.767s-2.296 1.561-3.767 1.561c-1.471 0-2.726-0.52-3.767-1.561s-1.561-2.296-1.561-3.767c0-1.471 0.52-2.726 1.561-3.767s2.296-1.561 3.767-1.561zM23.276 18.352c-0.762 0-1.49 0.148-2.186 0.444s-1.295 0.695-1.798 1.199c-0.503 0.503-0.903 1.103-1.199 1.798s-0.444 1.424-0.444 2.186c0 0.762 0.148 1.49 0.444 2.186s0.695 1.295 1.199 1.798c0.503 0.503 1.103 0.903 1.798 1.199s1.424 0.444 2.186 0.444c1.172 0 2.235-0.33 3.189-0.991l2.741 2.733c0.192 0.202 0.431 0.304 0.719 0.304 0.277 0 0.517-0.101 0.719-0.304s0.304-0.442 0.304-0.719c0-0.282-0.099-0.522-0.296-0.719l-2.741-2.741c0.661-0.954 0.991-2.016 0.991-3.189 0-0.762-0.148-1.49-0.444-2.186s-0.695-1.295-1.199-1.798c-0.503-0.503-1.103-0.903-1.798-1.199s-1.424-0.444-2.186-0.444zM23.276 20.397c0.986 0 1.829 0.35 2.529 1.051s1.051 1.544 1.051 2.529c0 0.986-0.35 1.829-1.051 2.529s-1.544 1.051-2.529 1.051c-0.986 0-1.829-0.35-2.529-1.051s-1.051-1.544-1.051-2.529c0-0.986 0.35-1.829 1.051-2.529s1.544-1.051 2.529-1.051z"></path>\n</symbol>\n<symbol id=icon-sik-buffer viewBox="0 0 32 32">\n<title>sik-buffer</title>\n<path d="M6.538 0.018c-1.801 0-3.341 0.639-4.62 1.918s-1.918 2.819-1.918 4.62v18.888c0 1.801 0.639 3.341 1.918 4.62s2.819 1.918 4.62 1.918h18.888c1.801 0 3.341-0.639 4.62-1.918s1.918-2.819 1.918-4.62v-18.888c0-1.801-0.639-3.341-1.918-4.62s-2.819-1.918-4.62-1.918h-18.888zM6.538 2.924h18.888c0.999 0 1.854 0.356 2.565 1.067s1.067 1.566 1.067 2.565v18.888c0 0.999-0.356 1.854-1.067 2.565s-1.566 1.067-2.565 1.067h-18.888c-0.999 0-1.854-0.356-2.565-1.067s-1.067-1.566-1.067-2.565v-18.888c0-0.999 0.356-1.854 1.067-2.565s1.566-1.067 2.565-1.067zM9.696 5.091c-1.199 0-2.224 0.426-3.075 1.277s-1.277 1.876-1.277 3.075v12.573c0 1.199 0.426 2.224 1.277 3.075s1.876 1.277 3.075 1.277h12.573c1.199 0 2.224-0.426 3.075-1.277s1.277-1.876 1.277-3.075v-12.573c0-1.199-0.426-2.224-1.277-3.075s-1.876-1.277-3.075-1.277h-12.573zM9.696 7.025h12.573c0.665 0 1.234 0.237 1.708 0.71s0.71 1.043 0.71 1.708v12.573c0 0.665-0.237 1.234-0.71 1.708s-1.043 0.71-1.708 0.71h-12.573c-0.665 0-1.234-0.237-1.708-0.71s-0.71-1.043-0.71-1.708v-12.573c0-0.665 0.237-1.234 0.71-1.708s1.043-0.71 1.708-0.71z"></path>\n</symbol>\n<symbol id=icon-sik-press-through viewBox="0 0 32 32">\n<title>sik-press-through</title>\n<path d="M6.556 0.018c-1.801 0-3.341 0.639-4.62 1.918s-1.918 2.819-1.918 4.62v18.888c0 1.801 0.639 3.341 1.918 4.62s2.819 1.918 4.62 1.918h18.888c1.801 0 3.341-0.639 4.62-1.918s1.918-2.819 1.918-4.62v-18.888c0-1.801-0.639-3.341-1.918-4.62s-2.819-1.918-4.62-1.918h-18.888zM6.556 2.924h18.888c0.999 0 1.854 0.356 2.565 1.067s1.067 1.566 1.067 2.565v18.888c0 0.999-0.356 1.854-1.067 2.565s-1.566 1.067-2.565 1.067h-18.888c-0.999 0-1.854-0.356-2.565-1.067s-1.067-1.566-1.067-2.565v-18.888c0-0.999 0.356-1.854 1.067-2.565s1.566-1.067 2.565-1.067zM9.714 5.091c-1.199 0-2.224 0.426-3.075 1.277s-1.277 1.876-1.277 3.075v12.573c0 1.199 0.426 2.224 1.277 3.075s1.876 1.277 3.075 1.277h12.573c1.199 0 2.224-0.426 3.075-1.277s1.277-1.876 1.277-3.075v-12.573c0-1.199-0.426-2.224-1.277-3.075s-1.876-1.277-3.075-1.277h-12.573zM9.714 7.025h4.953l-7.371 7.371v-4.953c0-0.665 0.237-1.234 0.71-1.708s1.043-0.71 1.708-0.71zM18.777 7.025h3.51c0.168 0 0.33 0.015 0.486 0.046l-15.423 15.473c-0.036-0.169-0.054-0.345-0.054-0.529v-3.51l11.481-11.481zM24.7 9.288c0.003 0.051 0.005 0.103 0.005 0.155v3.96l-11.031 11.030h-3.96c-0.089 0-0.176-0.004-0.262-0.013l15.248-15.133zM24.704 17.512v4.503c0 0.665-0.237 1.234-0.71 1.708s-1.043 0.71-1.708 0.71h-4.503l6.921-6.921z"></path>\n</symbol>\n</defs>\n</svg>\n</div>\n'),
$templateCache.put("templates/other/themeTemplate.html",'<div>\n<div style=display:flex>\n<input class="visible-box hidden-print" type=checkbox id=chk{{thmctrl.theme.Naam}} ng-model=thmctrl.theme.Visible ng-change=layercheckboxchange(thmctrl.theme)>\n<label for=chk{{thmctrl.theme.Naam}} title={{thmctrl.theme.Naam}}> {{thmctrl.theme.Naam}}\n<span class="label-info hidden-print" ng-show="thmctrl.theme.Type==\'esri\'">ArcGIS</span>\n<span class="label-info hidden-print" ng-hide="thmctrl.theme.Type==\'esri\'">{{thmctrl.theme.Type}}</span>\n</label>\n<button ng-hide="hidedelete == true" style="flex-grow: 2" class="trash hidden-print pull-right" ng-click=thmctrl.deleteTheme()></button>\n</div>\n<div style=display:flex ng-show="thmctrl.theme.Type==\'esri\'">\n<rzslider rz-slider-model=thmctrl.transpSlider.value rz-slider-options=thmctrl.transpSlider.options></rzslider>\n</div>\n<ul class="ul-level no-theme-layercontroller-checkbox" ng-repeat="layer in thmctrl.theme.Layers | filter: { enabled: true }">\n<tink-layer layer=layer layercheckboxchange=layercheckboxchange(layer.theme)>\n</tink-layer>\n</ul>\n</div>'),$templateCache.put("templates/search/bufferTemplate.html",'<div class=modal-header>\n<div class="row margin-bottom">\n<div class=col-xs-10>\n<h4>Buffer instellen</h4>\n</div>\n<div class=col-xs-2>\n<button class="close pull-right" type=button data-ng-click=cancel()></button>\n</div>\n</div>\n</div>\n<div class="modal-body width-sm flex-column flex-grow-1">\n<div class="row margin-top">\n<div class=col-xs-12>\n<div class=form-group>\n<label for=select>Selecteer de laag:</label>\n<div class=select>\n<select ng-options="layer as layer.name for layer in SelectableLayers" ng-keydown="$event.keyCode === 13 && ok()" ng-model=selectedLayer prevent-default></select>\n</div>\n</div>\n</div>\n</div>\n<div class=row>\n<div class=col-xs-12>\n<div class=form-group>\n<label for=input-number>Geef de bufferafstand (m):</label>\n<input type=number ng-keydown="$event.keyCode === 13 && ok()" class=hide-spin-button ng-model=buffer auto-focus>\n</div>\n</div>\n</div>\n<div class=row>\n<div class=col-xs-12>\n<div class=text-right>\n<button type=submit data-ng-click=ok()>Klaar</button>\n</div>\n</div>\n</div>\n</div>\n'),$templateCache.put("templates/search/searchResultsTemplate.html",'<div class="SEARCHRESULT flex-column">\n<div class=flex-column ng-if="!srchrsltsctrl.selectedResult && srchrsltsctrl.featureLayers.length == 0">\n<div class="col-xs-12 flex-grow-1 margin-top">\nGeen resultaten.\n</div>\n</div>\n<div class="flex-column flex-grow-1 margin-top" ng-if="!srchrsltsctrl.selectedResult && srchrsltsctrl.featureLayers.length > 0">\n<div class="row extra-padding">\n<div class="col-xs-12 margin-bottom text-right">\n<button class=btn tink-tooltip="Exporteer naar CSV" tink-tooltip-align=top ng-if=srchrsltsctrl.exportToCSVButtonIsEnabled ng-click=srchrsltsctrl.exportToCSV()>\n<svg class="icon icon-sik-file-csv"><use xmlns:xlink=http://www.w3.org/1999/xlink xlink:href=#icon-sik-file-csv></use></svg>\n</button>\n<button class=btn ng-class="{active: srchrsltsctrl.extendedType ==\'add\'}" tink-tooltip="Selectie toevoegen" tink-tooltip-align=top ng-click=srchrsltsctrl.addSelection()>\n<i class="fa fa-plus" aria-hidden=true></i>\n</button>\n<button class=btn ng-class="{active: srchrsltsctrl.extendedType==\'remove\'}" tink-tooltip="Selectie verwijderen" tink-tooltip-align=top ng-click=srchrsltsctrl.removeSelection()>\n<i class="fa fa-minus" aria-hidden=true></i>\n</button>\n<button class=btn-sm ng-if=srchrsltsctrl.extraResultButtonIsEnabled ng-click=srchrsltsctrl.extraResultButton()>{{srchrsltsctrl.resultButtonText}}</button>\n</div>\n<div class=col-xs-12>\n<select ng-model=srchrsltsctrl.layerGroupFilter>\n<option value=geenfilter selected>Geen filter ({{srchrsltsctrl.features.length}})</option>\n<option ng-repeat="feat in srchrsltsctrl.featureLayers" value={{feat}}>{{feat}} ({{srchrsltsctrl.aantalFeaturesMetType(feat)}})</option>\n</select>\n</div>\n</div>\n<div class="overflow-wrapper margin-top">\n<ul ng-repeat="layerGroupName in srchrsltsctrl.featureLayers">\n<tink-accordion ng-if="srchrsltsctrl.layerGroupFilter==\'geenfilter\' || srchrsltsctrl.layerGroupFilter==layerGroupName " data-one-at-a-time=false>\n<tink-accordion-panel data-is-collapsed=srchrsltsctrl.collapsestatepergroup[layerGroupName]>\n<data-header>\n<p class=nav-aside-title>{{layerGroupName}} ({{srchrsltsctrl.aantalFeaturesMetType(layerGroupName)}})\n<button prevent-default ng-click=srchrsltsctrl.deleteFeatureGroup(layerGroupName) class="trash pull-right"></button>\n</p>\n</data-header>\n<data-content>\n<li ng-repeat="feature in srchrsltsctrl.features | filter: { layerName:layerGroupName } :true" ng-mouseover=srchrsltsctrl.HoverOver(feature)>\n<div class=mouse-over>\n<a tink-tooltip={{feature.displayValue}} tink-tooltip-align=top ng-click=srchrsltsctrl.showDetails(feature)>{{ feature.displayValue| limitTo : 23 }}\n</a>\n<button class="trash pull-right mouse-over-toshow" prevent-default ng-click=srchrsltsctrl.deleteFeature(feature)></button>\n</div>\n</li>\n</data-content>\n</tink-accordion-panel>\n</tink-accordion>\n</ul>\n</div>\n</div>\n</div>'),$templateCache.put("templates/search/searchSelectedTemplate.html",'<div class="SEARCHSELECTED flex-column flex-grow-1 extra-padding" ng-if=srchslctdctrl.selectedResult>\n<div class="margin-top margin-bottom">\n<div class="col-xs-12 text-right">\n<button class=btn tink-tooltip=Doordruk tink-tooltip-align=top ng-click=srchslctdctrl.doordruk() ng-hide="srchslctdctrl.selectedResult.theme.Type != \'esri\' || srchslctdctrl.mobile">\n<svg class="icon icon-sik-press-through"><use xlink:href=#icon-sik-press-through></use></svg>\n</button>\n<button class=btn tink-tooltip=Buffer tink-tooltip-align=top ng-click=srchslctdctrl.buffer() ng-hide="srchslctdctrl.selectedResult.theme.Type != \'esri\' || srchslctdctrl.mobile">\n<svg class="icon icon-sik-buffer"><use xlink:href=#icon-sik-buffer></use></svg>\n</button>\n<button class=btn tink-tooltip="Exporteer naar CSV" tink-tooltip-align=top ng-if=srchslctdctrl.exportToCSVButtonIsEnabled ng-click=srchslctdctrl.exportToCSV()>\n<svg class="icon icon-sik-file-csv"><use xlink:href=#icon-sik-file-csv></use></svg>\n</button>\n<button class=btn tink-tooltip=Verwijderen tink-tooltip-align=top ng-click=srchslctdctrl.delete()>\n<i class="fa fa-trash-o"></i>\n</button>\n</div>\n</div>\n<div class="col-xs-12 overflow-wrapper flex-grow-1">\n<dl ng-repeat="prop in srchslctdctrl.props">\n<dt>{{ prop.key}}</dt>\n<div ng-if="prop.value.toLowerCase() != \'null\'">\n<a ng-if="prop.value.indexOf(\'https://\')==0 || prop.value.indexOf( \'http://\')==0 " ng-href={{prop.value}} target=_blank>% Link</a>\n<dd ng-if="prop.value.indexOf(\'https://\') !=0 && prop.value.indexOf( \'http://\') !=0 "><pre>{{ prop.value }}</pre></dd>\n</div>\n</dl>\n</div>\n<div class=margin-top>\n<div class=col-xs-12>\n<div class=btn-group>\n<button type=button class=btn ng-disabled=!srchslctdctrl.prevResult ng-click=srchslctdctrl.vorige()>\n<i class="fa fa-chevron-left"></i>\n</button>\n<button type=button class=btn ng-disabled=!srchslctdctrl.nextResult ng-click=srchslctdctrl.volgende()>\n<i class="fa fa-chevron-right"></i>\n</button>\n</div>\n<button class="btn-primary pull-right" ng-hide="srchslctdctrl.selectedResult.theme.Type != \'esri\'" ng-click=srchslctdctrl.toonFeatureOpKaart()>Tonen</button>\n</div>\n<div class="col-xs-12 margin-top margin-bottom">\n<a class=pull-right ng-click=srchslctdctrl.close(srchslctdctrl.selectedResult)>Terug naar resultaten</a>\n</div>\n</div>\n</div>\n'),$templateCache.put("templates/search/searchTemplate.html",'<div data-tink-nav-aside="" id=leftaside data-auto-select=true data-toggle-id=asideNavLeft class="nav-aside nav-left">\n<aside class="flex-column flex-grow-1">\n<div class=buffer-panel ng-show="srchrsltsctrl.drawLayer && !srchrsltsctrl.selectedResult">\n<div class=nav-aside-section>\n<p class=nav-aside-title>\nSelectievorm\n</p>\n</div>\n<div class="row extra-padding margin-top">\n<div class="col-xs-12 text-right">\n<button ng-click=srchrsltsctrl.deleteDrawing() tink-tooltip="Verwijder de selectievorm" tink-tooltip-align=right class=btn><i class="fa fa-trash" aria-hidden=true></i></button>\n<button ng-hide=srchrsltsctrl.mobile class=btn ng-click=srchrsltsctrl.bufferFromDrawing() tink-tooltip="Buffer rond selectievorm" tink-tooltip-align=right>\n<svg class="icon icon-sik-buffer"><use xlink:href=#icon-sik-buffer></use></svg>\n</button>\n<button class="btn btn-primary" ng-click=srchrsltsctrl.zoom2Drawing()>Tonen</button>\n</div>\n</div>\n</div>\n<div class=nav-aside-section>\n<p class=nav-aside-title>Resultaten</p>\n</div>\n<button ng-click=srchctrl.asidetoggle class=nav-left-toggle data-tink-sidenav-collapse=asideNavLeft>\n<a href=# title="Open menu"><span class=sr-only>Open left menu</span></a>\n</button>\n<div class="flex-column flex-grow-1" ng-show=srchctrl.LoadingCompleted>\n<tink-search-results></tink-search-results>\n<tink-search-selected></tink-search-selected>\n</div>\n<div class="loader-advanced center-block margin-top margin-bottom" ng-show="srchctrl.LoadingCompleted == false">\n<span class=loader></span>\n<span class=loader-percentage>{{srchctrl.loadingPercentage}}%</span>\n</div>\n</aside>\n</div>\n')}]);var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),TinkGis;!function(TinkGis){var LayerJSON=function LayerJSON(){_classCallCheck(this,LayerJSON)};TinkGis.LayerJSON=LayerJSON;var Layer=function(_LayerJSON){function Layer(){var _ref;_classCallCheck(this,Layer);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _this=_possibleConstructorReturn(this,(_ref=Layer.__proto__||Object.getPrototypeOf(Layer)).call.apply(_ref,[this].concat(args)));return _this.parent=null,_this.Layers=[],_this.UpdateDisplayed=function(currentScale){(_this.maxScale>0||_this.minScale>0)&&(currentScale>=_this.maxScale&&currentScale<=_this.minScale?_this.displayed=!0:_this.displayed=!1)},_this.toString=function(){return"Lay: (id: "+_this.name+")"},_this}return _inherits(Layer,_LayerJSON),_createClass(Layer,[{key:"hasLayers",get:function(){return!!this.Layers&&this.Layers.length>0}},{key:"ShouldBeVisible",get:function(){return!(!this.IsEnabledAndVisible||this.hasLayers||this.parent&&!this.parent.IsEnabledAndVisible)}},{key:"IsEnabledAndVisible",get:function(){return!!(this.theme.enabled&&this.enabled&&this.visible)&&(!this.parent||this.parent.IsEnabledAndVisible)}},{key:"AllLayers",get:function(){var allLay=this.Layers;return this.Layers.forEach(function(lay){allLay=allLay.concat(lay.AllLayers)}),allLay}}]),Layer}(LayerJSON);TinkGis.Layer=Layer;var wmslayer=function(_Layer){function wmslayer(layerData,parenttheme){_classCallCheck(this,wmslayer);var _this2=_possibleConstructorReturn(this,(wmslayer.__proto__||Object.getPrototypeOf(wmslayer)).call(this));return Object.assign(_this2,layerData),_this2.visible=!0,_this2.enabled=!1,_this2.displayed=!0,_this2.theme=parenttheme,_this2.queryable=layerData.queryable,_this2.id=_this2.name,_this2}return _inherits(wmslayer,_Layer),_createClass(wmslayer,[{key:"legendUrl",get:function(){return this.theme.cleanUrl+"?Service=WMS&REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&LAYER="+this.id}}]),wmslayer}(Layer);TinkGis.wmslayer=wmslayer;var argislegend=function argislegend(label,url){_classCallCheck(this,argislegend),this.label=label,this.url=url};TinkGis.argislegend=argislegend;var arcgislayer=function(_Layer2){function arcgislayer(layerData,parenttheme){_classCallCheck(this,arcgislayer);var _this3=_possibleConstructorReturn(this,(arcgislayer.__proto__||Object.getPrototypeOf(arcgislayer)).call(this));return Object.assign(_this3,layerData),_this3.visible=layerData.defaultVisibility,_this3.enabled=!1,_this3.title=layerData.name,_this3.theme=parenttheme,_this3.displayed=!0,_this3.queryable=!1,_this3}return _inherits(arcgislayer,_Layer2),_createClass(arcgislayer,[{key:"legends",get:function(){return this.legend.map(function(x){return new argislegend(x.label,x.fullurl)})}}]),arcgislayer}(Layer);TinkGis.arcgislayer=arcgislayer}(TinkGis||(TinkGis={}));var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),TinkGis;!function(TinkGis){var Theme=function(){function Theme(){var _this=this;_classCallCheck(this,Theme),this.Layers=[],this.UpdateDisplayed=function(currentScale){_this.EnabledLayers.forEach(function(layer){console.log("updating displayed status for layer: ",layer),layer.UpdateDisplayed(currentScale)})}}return _createClass(Theme,[{key:"VisibleLayers",get:function(){if(this.Visible){var allLay=this.AllLayers.filter(function(x){return x.ShouldBeVisible});return allLay}return[]}},{key:"VisibleAndDisplayedLayerIds",get:function(){if(this.Visible){var allLay=this.AllLayers.filter(function(x){return x.ShouldBeVisible&&x.displayed}).map(function(x){return x.id});return allLay}return[]}},{key:"EnabledLayers",get:function(){if(this.Visible){var allLay=this.AllLayers.filter(function(x){return x.enabled});return allLay}return[]}},{key:"VisibleLayerIds",get:function(){return this.VisibleLayers.map(function(x){return x.id})}},{key:"AllLayers",get:function(){var allLay=this.Layers;return this.Layers.forEach(function(lay){allLay=allLay.concat(lay.AllLayers)}),allLay}}]),Theme}();TinkGis.Theme=Theme;var ArcGIStheme=function(_Theme){function ArcGIStheme(rawdata,themeData){_classCallCheck(this,ArcGIStheme);var _this2=_possibleConstructorReturn(this,(ArcGIStheme.__proto__||Object.getPrototypeOf(ArcGIStheme)).call(this)),rawlayers=rawdata.layers;_this2.name=_this2.Naam=rawdata.documentInfo.Title,_this2.Description=rawdata.documentInfo.Subject,_this2.cleanUrl=themeData.cleanUrl,_this2.Opacity=themeData.opacity,_this2.Url=themeData.cleanUrl,_this2.Visible=!0,_this2.Added=!1,_this2.enabled=!0,_this2.Type=ThemeType.ESRI,_this2.status=ThemeStatus.UNMODIFIED,_this2.MapData={};var convertedLayers=rawlayers.map(function(x){return new TinkGis.arcgislayer(x,_this2)});return convertedLayers.forEach(function(argislay){if(argislay.parentLayerId===-1)_this2.Layers.push(argislay);else{var parentlayer=convertedLayers.find(function(x){return x.id===argislay.parentLayerId});argislay.parent=parentlayer,parentlayer.Layers.push(argislay)}}),_this2}return _inherits(ArcGIStheme,_Theme),_createClass(ArcGIStheme,[{key:"UpdateMap",value:function(){0!==this.VisibleLayerIds.length?this.MapData.setLayers(this.VisibleLayerIds):this.MapData.setLayers([-1])}},{key:"SetOpacity",value:function(opacity){this.Opacity=opacity,this.MapData.setOpacity(opacity)}}]),ArcGIStheme}(Theme);TinkGis.ArcGIStheme=ArcGIStheme;var wmstheme=function(_Theme2){function wmstheme(data,url){_classCallCheck(this,wmstheme);var _this3=_possibleConstructorReturn(this,(wmstheme.__proto__||Object.getPrototypeOf(wmstheme)).call(this));_this3.Version=data.version,_this3.name=_this3.Naam=data.service.title,_this3.enabled=!0,_this3.Visible=!0,_this3.cleanUrl=url,_this3.Added=!1,_this3.status=ThemeStatus.NEW,_this3.Description=data.service.abstract,_this3.Type=ThemeType.WMS;var layers=data.capability.layer;layers.layer&&(layers=layers.layer),layers.layer&&(layers=layers.layer);var lays=[];return layers?void 0===layers.length?lays.push(layers):lays=layers:lays.push(data.capability.layer),lays.forEach(function(layer){layer.queryable===!0&&(data.capability.request.getfeatureinfo.format.some(function(x){return"text/xml"===x})?_this3.GetFeatureInfoType="text/xml":data.capability.request.getfeatureinfo.format.some(function(x){return"text/plain"===x})&&(_this3.GetFeatureInfoType="text/plain"),_this3.GetFeatureInfoType||(layer.queryable=!1));var lay=new TinkGis.wmslayer(layer,_this3);_this3.Layers.push(lay)}),_this3}return _inherits(wmstheme,_Theme2),_createClass(wmstheme,[{key:"UpdateMap",value:function(map){0!==this.VisibleLayerIds.length?(map.hasLayer(this.MapData)||map.addLayer(this.MapData),this.MapData.options.layers=this.MapData.wmsParams.layers=this.VisibleLayerIds.join(","),this.MapData.redraw()):map.hasLayer(this.MapData)&&map.removeLayer(this.MapData)}}]),wmstheme}(Theme);TinkGis.wmstheme=wmstheme}(TinkGis||(TinkGis={}));var TinkGis;!function(TinkGis){!function(){var module=angular.module("tink.gis"),service=function(){var ThemeCreater={};return ThemeCreater.createARCGISThemeFromJson=function(rawdata,themeData){var theme=new TinkGis.ArcGIStheme(rawdata,themeData);return theme},ThemeCreater.createWMSThemeFromJSON=function(data,url){var wms=new TinkGis.wmstheme(data,url);return wms},ThemeCreater};module.factory("ThemeCreater",service)}()}(TinkGis||(TinkGis={}));
//# sourceMappingURL=tink-gis-angular.min.js.map